var app=angular.module("App",["ngCookies","ngSanitize","angular-loading-bar","ngAnimate","ui.router","ncy-angular-breadcrumb","storage.service","utilizador.service","menu.service","slugifier","ngTextTruncate","angularMoment","ui.tinymce","ngScrollbars","videosharing-embed","rmDatepicker","angular-google-analytics","ui.rCalendar","ngCropper","angular-owl-carousel-2","vcRecaptcha","fancyboxplus","ngImageCompress","ui.mask","dynamic-states","link.service","pascalprecht.translate","dndLists","localytics.directives","ngFileSaver","upload.service","ab-base64"]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$breadcrumbProvider","ScrollBarsProvider","AnalyticsProvider","vcRecaptchaServiceProvider","uiMask.ConfigProvider","$translateProvider","$qProvider","$httpProvider","$compileProvider","chosenProvider",function(o,e,a,t,n,i,r,l,s,c,u,d,g){d.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|javascript):/),g.setOption({no_results_text:"Nenhum resultado encontrado",placeholder_text_multiple:"Seleccione"}),s.useStaticFilesLoader({prefix:"app/main/idiomas/",suffix:".json"}).registerAvailableLanguageKeys(["PT","EN"]).preferredLanguage("PT").fallbackLanguage("PT").useSanitizeValueStrategy("escapeParameters").useLocalStorage(),c.errorOnUnhandledRejections(!1),u.defaults.headers.get||(u.defaults.headers.get={}),u.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT",u.defaults.headers.get["Cache-Control"]="no-cache",u.defaults.headers.get.Pragma="no-cache",l.maskDefinitions({A:/[a-z]/,"*":/[a-zA-Z0-9]/}),l.addDefaultPlaceholder(!1),r.setDefaults({key:"6LfDAy4UAAAAAMjT7SItakjmnJFfeLUfzT8hMto8",theme:"light",size:"normal",lang:"pt-PT"}),i.setAccount([{tracker:"UA-72253057-2",name:"PMINFIN"}]).logAllCalls(!0).setPageEvent("$locationChangeSuccess"),n.defaults={theme:"light",scrollInertia:0,axis:"y",scrollButtons:{scrollAmount:"auto",enable:!1},advanced:{updateOnContentResize:!0}},t.setOptions({prefixStateName:"home",includeAbstract:!0}),a.html5Mode(!1).hashPrefix("!"),o.state("home",{url:"/",ncyBreadcrumb:{label:"Home"},views:{"@":{controllerProvider:["$translateLocalStorage",function(o){var e=o.get("NG_TRANSLATE_LANG_KEY");return"PT"===e||null===e?"homeController":"homeIdiomasController"}],templateProvider:["$translateLocalStorage","$templateRequest",function(o,e){var a=o.get("NG_TRANSLATE_LANG_KEY");return e("PT"===a||null===a?"app/pages/home.html":"app/pages/home-idiomas.html")}]}}}).state("sobre-o-minfin.quem-e-quem",{url:"/quem-e-quem",ncyBreadcrumb:{label:"Quem é Quem"},views:{"@":{templateUrl:"app/pages/quem-e-quem.html",controller:"quemEquemController"}}}).state("sobre-o-minfin.quem-e-quem.cdQuemEQuem",{url:"/:cdQuemEQuem/:regimeCarreira/:noQuemEQuem",ncyBreadcrumb:{label:"Quem é Quem"},views:{"@":{templateUrl:"app/pages/quem-e-quem-detalhes.html",controller:"quemEquemController"}}}).state("economia-nacional",{url:"/economia-nacional",abstract:!0,ncyBreadcrumb:{label:"Economia Nacional"}}).state("economia-nacional.petroleo",{url:"/petroleo",ncyBreadcrumb:{label:"Petróleo"},views:{"@":{templateUrl:"app/pages/petroleo.html",controller:"petroleoController"}}}).state("economia-nacional.diamante",{url:"/diamante",ncyBreadcrumb:{label:"Diamante"},views:{"@":{templateUrl:"app/pages/diamante.html",controller:"diamanteController"}}}).state("economia-nacional.inflacao",{url:"/inflacao",ncyBreadcrumb:{label:"Inflação"},views:{"@":{templateUrl:"app/pages/inflacao.html",controller:"inflacaoController"}}}).state("mapa-do-site",{url:"/mapa-do-site",ncyBreadcrumb:{label:"Mapa do Site"},views:{"@":{templateUrl:"app/pages/mapa-do-site.html",controller:"mapaDoSiteController"}}}).state("sala-de-imprensa.noticias",{url:"/noticias",publicacao:{label:{singular:"Notícia",plural:"Notícias"},template:{sigla:"NOT",dominio:"TP_PUBLICACAO"}},ncyBreadcrumb:{label:"Notícias"},views:{"@":{templateUrl:"app/pages/publicacoes.html",controller:"publicacoesController"}}}).state("sala-de-imprensa.noticias.cdPublicacao",{url:"/:cdPublicacao/:slug",publicacao:{label:{singular:"Notícia",plural:"Notícias"},template:{sigla:"NOT",dominio:"TP_PUBLICACAO"}},ncyBreadcrumb:{label:"Notícia"},views:{"@":{templateUrl:"app/pages/publicacao.html",controller:"publicacoesController"}}}).state("sala-de-imprensa.artigos",{url:"/artigos",publicacao:{label:{singular:"Artigos",plural:"Artigos"},template:{sigla:"ART",dominio:"TB_ARTIGO"}},ncyBreadcrumb:{label:"Artigos"},views:{"@":{templateUrl:"app/pages/publicacoes.html",controller:"publicacoesController"}}}).state("sala-de-imprensa.artigos.cdPublicacao",{url:"/:cdPublicacao/:slug",publicacao:{label:{singular:"Artigo",plural:"Artigo"},template:{sigla:"ART",dominio:"TB_ARTIGO"}},ncyBreadcrumb:{label:"Artigo"},views:{"@":{templateUrl:"app/pages/publicacao.html",controller:"publicacoesController"}}}).state("sala-de-imprensa.galerias",{url:"/galerias",ncyBreadcrumb:{label:"Galeria"},views:{"@":{templateUrl:"app/pages/fotos.html",controller:"fotosController"}}}).state("sala-de-imprensa.videos",{url:"/videos",ncyBreadcrumb:{label:"Vídeos"},views:{"@":{templateUrl:"app/pages/videos.html",controller:"videosController"}}}).state("sala-de-imprensa.videos.cdPublicacao",{url:"/:cdPublicacao/:slug",ncyBreadcrumb:{label:"Vídeo"},views:{"@":{templateUrl:"app/pages/video.html",controller:"videosController"}}}).state("sala-de-imprensa.eventos",{url:"/eventos",ncyBreadcrumb:{label:"Eventos"},views:{"@":{templateUrl:"app/pages/eventos.html",controller:"eventosController"}}}).state("sala-de-imprensa.eventos.evento",{url:"/:cdPublicacao/:slug",ncyBreadcrumb:{label:"Evento"},views:{"@":{templateUrl:"app/pages/evento.html",controller:"eventosController"}}}).state("sala-de-imprensa.informativos",{url:"/informativos",ncyBreadcrumb:{label:"Eventos"},views:{"@":{templateUrl:"app/pages/informativo.html",controller:"informativosController"}}}).state("sala-de-imprensa.informativos.informativo",{url:"/:cdInformativos/:slug",ncyBreadcrumb:{label:"Evento"},views:{"@":{templateUrl:"app/pages/informativo.html",controller:"informativosController"}}}).state("veja-tambem.glossario",{url:"/glossario",anexos:!0,ncyBreadcrumb:{label:"Glossário"},views:{"@":{templateUrl:"app/pages/glossario.html",controller:"glossarioController"}}}).state("veja-tambem.perguntas-frequentes",{url:"/perguntas-frequentes",sigla:"ANY",anexos:!0,ncyBreadcrumb:{label:"Perguntas Frequentes"},views:{"@":{templateUrl:"app/pages/perguntas-frequentes.html",controller:"perguntasFrequentesController"}}}).state("materias-de-realce.grafico-do-oge",{url:"/grafico-do-oge",ncyBreadcrumb:{label:"Gráfico do Orçamento Geral do Estado"},views:{"@":{templateUrl:"app/pages/grafico-oge.html"}}}).state("graficos",{url:"/graficos",ncyBreadcrumb:{label:"Gráficos"},views:{"@":{templateUrl:"app/pages/graficos.html",controller:"graficosController"}}}).state("graficos.id",{url:"/:id",ncyBreadcrumb:{label:"Gráfico"},views:{"@":{templateUrl:"app/pages/graficos.html",controller:"graficosController"}}}).state("contacto",{url:"/contacto",ncyBreadcrumb:{label:"Contacto"},views:{"@":{templateUrl:"app/pages/contacto.html",controller:"contactoController"}}}).state("financas-publicas.programa-de-investimento-publico",{url:"/programa-de-investimento-publico",ncyBreadcrumb:{label:"Programa de Investimento Público"},views:{"@":{templateUrl:"app/pages/detalhar-pip.html",controller:"detalharPipCtrl"}},resolve:{states:function(){return{exibeFormulario:!1,statePrincipal:"programa-de-investimento-publico.",stateAreaAzul:"programa-de-investimento-publico"}}}}).state("financas-publicas.divida",{url:"/divida",ncyBreadcrumb:{label:"Dívida Pública"},views:{"@":{templateUrl:"app/pages/detalhar-pip.html",controller:"detalharPipCtrl"}},resolve:{states:function(){return{exibeFormulario:!1,statePrincipal:"divida-publica",stateAreaAzul:"divida-publica"}}}}).state("financas-publicas.servico-nacional-da-contratacao-publica",{url:"/servico-nacional-da-contratacao-publica",ncyBreadcrumb:{label:"Serviço Nacional da Contratação Pública"},views:{"@":{templateUrl:"app/pages/detalhar-pip.html",controller:"detalharPipCtrl"}},resolve:{states:function(){return{exibeFormulario:!1,statePrincipal:"servico-nacional-da-contratacao-publica",stateAreaAzul:"servico-nacional-da-contratacao-publica"}}}}).state("financas-publicas.impostos",{url:"/impostos",ncyBreadcrumb:{label:"Impostos"},views:{"@":{templateUrl:"app/pages/detalhar-pip.html",controller:"detalharPipCtrl"}},resolve:{states:function(){return{exibeFormulario:!1,statePrincipal:"impostos",stateAreaAzul:"impostos"}}}}).state("financas-publicas.privatizacoes",{url:"/privatizacoes",ncyBreadcrumb:{label:"Privatizações"},views:{"@":{templateUrl:"app/pages/detalhar-pip.html",controller:"detalharPipCtrl"}},resolve:{states:function(){return{exibeFormulario:!1,statePrincipal:"privatizacoes",stateAreaAzul:"privatizacoes"}}}}).state("estatisticas",{url:"/estatisticas",ncyBreadcrumb:{label:"Estatísticas"},views:{"@":{templateUrl:"app/pages/estatisticas.html",controller:"estatisticasController"}}}),e.otherwise("/")}]).run(["$rootScope","$timeout","$window","$http","$state","RequestService","Analytics","AlertaService","dynamicStates","UtilizadorService","MenuService","LinkService",function(i,e,r,o,a,t,n,l,s,c,u,d){i.const=null,o.get("app/services/offline/pt-BR.json").then(function(o){i.const=o.data.dictionary}),i.tituloPagina="Início",i.getLinkState=function(o){return o.subPaginas?a.href(u.obterSubLink(o)):d.target(o.url)?o.url:a.href(o.state)},i.getState=function(o){return a.get(o)},t.request("GET","/menu/listar/"+t.portalConfig.portalAPI,null,null,function(o){o?200==o.retorno.codigo&&(i.menu=o.data.menuItemList,i.contactos=o.data.contactos,s.fetchRoutes(o.data.menuItemList)):l.erroRede()}),i.$on("$locationChangeSuccess",function(o,e,a,t,n){r.scrollTo(0,0),i.atualizarTituloPagina()}),i.atualizarTituloPagina=function(){e(function(){try{i.tituloPagina=a.current.ncyBreadcrumb.label}catch(o){i.atualizarTituloPagina()}},400)},i.checarPermissao=function(o){return c.checarPermissao(o).$$state.value},$(document).on("shown.bs.modal","body",function(o){e(function(){$("body").addClass("modal-open").css("padding-right",!1)},100)}),i.appVersion={},o.get("version.json").then(function(o){i.appVersion.frontend=o.data})}]),comboGoogleTradutor=null;function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:"pt",includedLanguages:"en,es,fr,pt,zh-CN"},"google_translate_element"),(comboGoogleTradutor=document.getElementById("google_translate_element").querySelector(".goog-te-combo")).classList.add("background-color:#000")}function changeEvent(o){if(o.fireEvent)o.fireEvent("onchange");else{var e=document.createEvent("HTMLEvents");e.initEvent("change",!1,!0),o.dispatchEvent(e)}document.querySelector(".body").classList.add("movercima")}function trocarIdioma(o){"pt"==o&&(document.getElementById("myImage").src="app/main/img/angola_flag.png",document.getElementById("texto-img").innerHTML="AO"),"en"==o&&(document.getElementById("myImage").src="app/main/img/en.svg",document.getElementById("texto-img").innerHTML="EN"),comboGoogleTradutor&&(comboGoogleTradutor.value=o,changeEvent(comboGoogleTradutor))}app.component("minfinDefaultHeader",{templateUrl:"app/partials/minfin-default-header.html",controller:["$translate","$translateLocalStorage","$scope","$rootScope","$timeout","$window","$state",function(e,o,a,t,n,i,r){this.traducao=function(o){e.use(o),n(function(){i.location.reload()},300)},a.init=function(){a.language=a.getLanguage()},a.switchLanguage=function(o){e.use(o),a.language=o,r.go("home"),n(function(){i.location.reload(!0),$ionicLoading.hide()},1e3)},a.getLanguage=function(){return o.get("NG_TRANSLATE_LANG_KEY")}}]}),app.component("minfinDefaultHeader1",{templateUrl:"app/partials/minfin-default-header1.html",controller:["$translate","$translateLocalStorage","$scope","$rootScope","$timeout","$window","$state",function(e,o,a,t,n,i,r){this.traducao=function(o){e.use(o),n(function(){i.location.reload()},300)},a.init=function(){a.language=a.getLanguage()},a.switchLanguage=function(o){e.use(o),a.language=o,r.go("home"),n(function(){i.location.reload(!0),$ionicLoading.hide()},1e3)},a.getLanguage=function(){return o.get("NG_TRANSLATE_LANG_KEY")}}]}),app.component("navigationBar",{templateUrl:"app/partials/navigation-bar.html",bindings:{menuarray:"="},controller:["$rootScope","$state","$scope","StorageService","LinkService","$translateLocalStorage",function(o,t,a,n,i,e){a.utilizador=n.get("utilizadorLogado"),a.idioma=e.get("NG_TRANSLATE_LANG_KEY"),o.$on("broadcastUtilizadorReceiver",function(o,e){a.utilizador=n.get("utilizadorLogado")}),a.retornaLogo=function(){return"app/main/img/logo-minfin-"+a.idioma+".png"},this.linkarSubMenus=function(o){var e=t.href(o.state),a=i.target(o.url);return a?a[0]:e}}]}),app.component("carouselVertical",{templateUrl:"app/partials/carousel-vertical.html",bindings:{itens:"<"},controller:["$rootScope","$scope","StorageService",function(o,a,t){a.utilizador=t.get("utilizadorLogado"),o.$on("broadcastUtilizadorReceiver",function(o,e){a.utilizador=t.get("utilizadorLogado")})}]}),app.component("videoList",{templateUrl:"app/partials/video-list.html",bindings:{itens:"="},controller:["$scope",function(e){e.modalVideo={},e.openModal=function(o){e.modalVideo=o}}]}),app.component("swalAnimation",{bindings:{tipo:"@"},template:'<div class="f-modal-alert">\t<div class="f-modal-icon f-modal-error animate" ng-if="$ctrl.tipo == \'error\'">\t\t<span class="f-modal-x-mark">\t\t\t<span class="f-modal-line f-modal-left animateXLeft"></span>\t\t\t<span class="f-modal-line f-modal-right animateXRight"></span>\t\t</span>\t\t<div class="f-modal-placeholder"></div>\t\t<div class="f-modal-fix"></div>\t</div>\t<div class="f-modal-icon f-modal-warning scaleWarning" ng-if="$ctrl.tipo == \'warning\'">\t\t<span class="f-modal-body pulseWarningIns"></span>\t\t<span class="f-modal-dot pulseWarningIns"></span>\t</div>\t<div class="f-modal-icon f-modal-success animate" ng-if="$ctrl.tipo == \'success\'">\t\t<span class="f-modal-line f-modal-tip animateSuccessTip"></span>\t\t<span class="f-modal-line f-modal-long animateSuccessLong"></span>\t\t<div class="f-modal-placeholder"></div>\t\t<div class="f-modal-fix"></div>\t</div></div>'}),app.component("owlCarousel",{templateUrl:"app/partials/owl-carousel.html",bindings:{data:"<",descricao:"<",qtdItens:"<",bullet:"<",arrow:"<",singleItem:"<",numbered:"<",nome:"@"},controller:function(){this.$onChanges=function(o){this.data&&$("."+this.nome).owlCarousel({items:this.qtdItens,lazyLoad:!0,loop:!0,margin:10,dots:this.bullet,nav:this.arrow,navText:["<i class='glyphicon glyphicon-chevron-left'></i>","<i class='glyphicon glyphicon-chevron-right'></i>"],responsiveClass:!0,responsive:{0:{items:this.singleItem?"1":1},300:{items:this.singleItem?"1":2},600:{items:this.singleItem?"1":3},1000:{items:this.qtdItens}}})}}}),app.component("linksUteis",{templateUrl:"app/partials/links-uteis-carousel.html",bindings:{data:"<",qtdItens:"<",loop:"=",bullet:"<",arrow:"<",numbered:"<",tipo:"@",titulo:"@"},controller:["$location","RequestService",function(e,o){var a=this;a.ready=function(o){o},this.$onInit=function(o){a.properties={items:a.qtdItens,lazyLoad:!0,loop:a.loop,margin:10,dots:a.bullet,nav:a.arrow,autoplay:a.bullet,autoplayTimeout:3e3,autoplayHoverPause:!0,navText:["<i class='glyphicon glyphicon-chevron-left'></i>","<i class='glyphicon glyphicon-chevron-right'></i>"],responsiveClass:!0,responsive:{0:{items:a.singleItem?"1":1},300:{items:a.singleItem?"1":1},600:{items:a.singleItem?"1":1},1000:{items:a.qtdItens}}}},this.target=function(o){return-1<o.indexOf(e.$$host)?"_SELF":"_BLANK"}}]}),app.component("linksInformativos",{templateUrl:"app/partials/links-informativos-carousel.html",bindings:{data:"<",qtdItens:"<",loop:"=",bullet:"<",arrow:"<",numbered:"<",tipo:"@",titulo:"@"},controller:["$location","RequestService",function(e,o){var a=this;a.ready=function(o){o},this.$onInit=function(o){a.properties={items:a.qtdItens,lazyLoad:!0,loop:a.loop,margin:10,dots:a.bullet,nav:a.arrow,autoplay:a.bullet,autoplayTimeout:3e3,autoplayHoverPause:!0,navText:["<i class='glyphicon glyphicon-chevron-left'></i>","<i class='glyphicon glyphicon-chevron-right'></i>"],responsiveClass:!0,responsive:{0:{items:a.singleItem?"1":1},300:{items:a.singleItem?"1":1},600:{items:a.singleItem?"1":1},1000:{items:a.qtdItens}}}},this.target=function(o){return-1<o.indexOf(e.$$host)?"_SELF":"_BLANK"}}]}),app.component("eventosList",{templateUrl:"app/partials/eventos-list.html",bindings:{data:"<",tipo:"@",qtdItens:"<",truncar:"<"},controller:function(){}}),app.component("customFooter",{templateUrl:"app/partials/custom-footer.html",bindings:{menuarray:"<",contactos:"="},controller:["$rootScope","$scope","$timeout","$translateLocalStorage",function(o,e,a,t){this.dataAtual={agora:new Date},this.idioma=t.get("NG_TRANSLATE_LANG_KEY"),this.$onInit=function(o){}}]}),app.component("cambio",{templateUrl:"app/partials/cambio.html",bindings:{data:"="}}),app.component("breadcrumb",{templateUrl:"app/partials/breadcrumb.html",bindings:{dataItens:"="}}),app.component("submenuSidebar",{templateUrl:"app/partials/submenu-sidebar.html",controller:["$rootScope","$state","LinkService",function(e,t,n){this.$onChanges=function(){this.menuPrincipal=e.menu,this.current=t.$current;for(var o=t.$current;o.parent;)(o=o.parent).name&&(this.menuTop=o)},this.linkarSubMenus=function(o){var e=t.href(o.state),a=n.target(o.url);return a?a[0]:e},this.changeSubMenuItem=function(o){o.aberto=!o.aberto},this.checkSubMenuParent=function(o){o.aberto=!1,0<=this.current.name.indexOf(o.state)&&(o.aberto=!0)}}]}),app.component("defaultInternaEditar",{templateUrl:"app/partials/default-interna-editar.html",bindings:{pagina:"<",menuAtual:"<",anexos:"="},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService",function(n,r,a,i,l,t){r.utilizador=t.get("utilizadorLogado"),n.$on("broadcastUtilizadorReceiver",function(o,e){r.utilizador=t.get("utilizadorLogado")}),this.$onChanges=function(o){r.pagina=angular.copy(this.pagina),r.menuAtual=this.menuAtual,r.extensoesPermitidas=["pdf","doc","docx","xls","xlsx"],r.tamanhoFicheiro=15,r.extensoesPermitidasImagens=["jpg","jpeg","png"],r.tamanhoFicheiroImagem=1,r.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:300,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | image media | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",image_dimensions:!0,image_description:!0,fontsize_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 20pt 21pt 22pt 23pt 24pt",nowrap:!1,setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){a(function(){"Inserir/editar imagem"==$(".mce-title").html()&&($(".mce-combobox input").attr("readonly","readonly").addClass("disabled"),$("input:last").focus())},100)})})},file_picker_callback:function(t,o,e){var n=angular.element("#editorImageUpload");a(function(){angular.element(n).click()},200),n.on("change",function(o){var e=o.target.files[0];e.extensao=e.name.split(".");var a=new FileReader;a.readAsDataURL(e),a.onload=function(){var o={permitir:!0,tamanho:!0};r.extensoesPermitidasImagens.indexOf(e.extensao[e.extensao.length-1].toLowerCase())<0&&(a.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),e.size>1048576*r.tamanhoFicheiroImagem&&(a.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&(n.val(""),t(a.result,{title:e.name}))},a.onloadstart=function(){l.showProgressAlert()},a.onloadend=function(){l.closeProgressAlert()},a.onabort=function(){l.closeProgressAlert()}})}};try{r.tinymceModel=this.pagina.html}catch(o){}},r.defaultInternaEditar=function(o){if(o.$valid&&o.$submitted){var e={portal:i.portalConfig.portalAPI,data:{cdMenu:r.menuAtual.cdMenu,html:r.tinymceModel||"",anexoPortalList:r.pagina.anexoPortalList}};r.pagina.html=r.tinymceModel,i.request("POST","/menu/salvarConteudoHtml",e,!0,function(o){o?200==o.retorno.codigo?l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}},r.ficheiroAnexoNovo=function(){r.pagina.anexoPortalList||(r.pagina.anexoPortalList=[{anexoPortalItemList:[]}]);r.pagina.anexoPortalList.push({novo:!0,cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]})},r.ficheiroAnexoExcluir=function(o,a,e,t){a.novo?r.pagina.anexoPortalList.splice(t,1):l.confirmar("Confirma Excluir Ficheiro ?",function(o){if(o){var e={portal:i.portalConfig.portalAPI,data:{cdAnexoPortal:a.cdAnexoPortal}};i.request("POST","/menu/removerAnexo",e,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),r.pagina.anexoPortalList.splice(t,1),n.$broadcast("broadcastHomeReceiver")):l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},r.preUpload=function(e,o,a,t){if(angular.isDefined(t)&&t.target.files.length){var n=t.target.files[0];if(n.extensao=n.name.split("."),0<n.size){var i=new FileReader;i.readAsDataURL(n),i.onload=function(){var o={permitir:!0,tamanho:!0};r.extensoesPermitidas.indexOf(n.extensao[n.extensao.length-1].toLowerCase())<0&&(i.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),n.size>1048576*r.tamanhoFicheiro&&(i.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&(e.nome=n.name,e.base64Anexo=i.result.substr(i.result.indexOf(",")+1).replace(/ /g,""),e.extensao=n.extensao[n.extensao.length-1],e.mimeType=n.type)},i.onloadstart=function(){l.showProgressAlert()},i.onloadend=function(){l.closeProgressAlert()},i.onabort=function(){l.closeProgressAlert()}}else l.showMensagemRetorno(400,"O ficheiro está vazio!")}}}]}),app.component("publicacoesCrud",{templateUrl:"app/partials/publicacoes-crud.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$timeout","$filter","RequestService","StorageService","AlertaService","UtilizadorService","Utils",function(t,i,r,n,e,l,o,s){var c=this;t.$on("broadcastUtilizadorReceiver",function(o,e){c.initUtilizador(!0)}),this.$onInit=function(o){c.initUtilizador(!1),c.extensoesPermitidasImagens=["jpg","jpeg","png"],c.tamanhoFicheiroImagem=1,c.editorImageUpload={},c.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:300,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | image media | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",image_dimensions:!0,image_description:!0,nowrap:!1,setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){i(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},100)})})},file_picker_callback:function(t,o,e){var n=angular.element("#editorImageUpload-"+r("slugify")(c.label.plural));i(function(){angular.element(n).click()},200),n.on("change",function(o){var e=o.target.files[0];e.extensao=e.name.split(".");var a=new FileReader;a.readAsDataURL(e),a.onload=function(){var o={permitir:!0,tamanho:!0};c.extensoesPermitidasImagens.indexOf(e.extensao[e.extensao.length-1].toLowerCase())<0&&(a.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),e.size>1048576*c.tamanhoFicheiroImagem&&(a.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&(n.val(""),t(a.result,{title:e.name}))},a.onloadstart=function(){l.showProgressAlert()},a.onloadend=function(){l.closeProgressAlert()},a.onabort=function(){l.closeProgressAlert()}})}}},c.initUtilizador=function(o){c.utilizador=e.get("utilizadorLogado"),c.administrador=!1,c.gestor=!1,c.publicador=!1,c.redator=!1,c.revisor=!1,c.editor=!1,c.utilizador&&(c.administrador=s.validaPermissao("administrador",c.utilizador.grupos),c.gestor=s.validaPermissao("gestor",c.utilizador.grupos),c.publicador=s.validaPermissao("publicador",c.utilizador.grupos),c.redator=s.validaPermissao("redator",c.utilizador.grupos),c.revisor=s.validaPermissao("revisor",c.utilizador.grupos),c.editor=s.validaPermissao("editor",c.utilizador.grupos),o&&c.init(null,c.utilizador.gestor))},c.init=function(o,e){o&&o.$setPristine(),c.publicacaoPesquisar={portal:n.portalConfig.portalAPI,flDestaque:null,tipo:{dominio:c.template.dominio,sigla:c.template.sigla},status:null,statusTipos:{AREV:"Aguardando Revisão",CRIA:"Criada",PUB:"Publicada",REV:"Revisado",RPUB:"Reprovada Publicador",RREV:"Reprovada Revisor"},titulo:null,todos:!0,paginaAtual:1,qtdPaginas:5,paginacaoArray:[5,10,15,20],quantidadeTotalItens:0},c.itensPaginados=null,e&&c.pesquisarPublicacao(!1)},c.validaEditar=function(o){var e=!1;return"CRIA"==o&&(c.editor||c.redator||c.gestor||c.administrador)?e=!0:"RREV"==o&&(c.editor||c.redator||c.gestor||c.administrador)?e=!0:c.administrador&&(e=!0),e},c.validaVisualizar=function(o){var e=!1;return"AREV"==o&&(c.editor||c.redator||c.revisor||c.gestor||c.administrador)?e=!0:"RPUB"==o&&(c.revisor||c.gestor||c.administrador)?e=!0:"REV"==o&&(c.publicador||c.gestor||c.administrador)?e=!0:"PUB"==o&&(c.publicador||c.editor||c.redator||c.revisor||c.gestor||c.administrador)?e=!0:"CRIA"==o&&(c.revisor||c.publicador||c.gestor||c.administrador)?e=!0:"RREV"==o&&(c.revisor||c.publicador||c.gestor||c.administrador)?e=!0:"REV"==o&&(c.revisor||c.publicador||c.gestor||c.administrador)&&(e=!0),e},c.formPublicacaoPesquisarSubmit=function(o){o.$valid&&(c.publicacaoPesquisar.paginaAtual=1,i(function(){c.pesquisarPublicacao()}))},c.pesquisarPublicacao=function(){c.publicacaoPesquisar.quantidadeTotalItens=0,n.request("POST","/publicacao/listar/",c.publicacaoPesquisar,!0,function(o){o?200==o.retorno.codigo?(c.itensPaginados=o,c.publicacaoPesquisar.quantidadeTotalItens=c.itensPaginados.quantidadeTotalItens,l.closeProgressAlert()):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},c.setObj=function(o){o&&o.$setPristine(),c.dataJson={portal:n.portalConfig.portalAPI,data:{cdPublicacao:null,descricao:null,dtFim:null,dtInicio:null,flStatusPublicacao:{sigla:"CRIA",descricao:"CRIA",detalhe:"Criada",dominio:"FL_STATUS_PUBLICACAO"},sumario:null,titulo:null,anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null,legenda:null}]}],templatePublicacao:{cdTemplatePublicacao:null,dsTemplate:null,flAtivo:null,noTemplate:null,token:null,cgRefCodes:{sigla:c.template.sigla,descricao:null,detalhe:null,dominio:c.template.dominio},publicacaoList:null,anexoPortalList:null},dsPortal:n.portalConfig.portalAPI,flDestaque:null,autor:null,dtCriacao:null,observacao:null,idAnexo:null,idImagem:null,filePath:null,urlImagemContent:null}}},c.salvarNoticia=function(o){o.$valid&&o.$submitted&&(c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo&&(c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo=c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo.substr(c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo.indexOf(",")+1).replace(/ /g,"")),c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].legenda&&(c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].legenda=c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].legenda),c.dataJson.data.dtInicio=moment(c.dataJson.data.dtInicio,"DD-MM-YYYY HH:mm:ss").format("DD-MM-YYYYTHH:mm:ss.000+0100"),c.dataJson.data.dtFim=moment(c.dataJson.data.dtFim,"DD-MM-YYYY HH:mm:ss").format("DD-MM-YYYYTHH:mm:ss.000+0100"),c.dataJson.portal=n.portalConfig.portalAPI,n.request("POST","/publicacao/salvar",c.dataJson,!0,function(o){o?200==o.retorno.codigo?l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){c.pesquisarPublicacao(),i(function(){c.dataJson={data:o.data},c.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYYTHH:mm:ss").format("DD/MM/YYYY HH:mm:ss"),c.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYYTHH:mm:ss").format("DD/MM/YYYY HH:mm:ss")},1e3),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()}))},c.excluirAnexo=function(){c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,c.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},c.editar=function(o,e){e&&e.$setPristine(),n.request("GET","/noticia/buscar/"+o.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),c.dataJson={data:o.data},c.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYYTHH:mm:ss").format("DD/MM/YYYY HH:mm:ss"),c.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYYTHH:mm:ss").format("DD/MM/YYYY HH:mm:ss")):l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},c.excluir=function(e,o){l.confirmar("Excluir este Registo ?",function(o){o&&n.request("DELETE","/publicacao/remover/"+e.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(c.pesquisarPublicacao(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})})},c.visualizar=function(o){c.noticiaVisualizada=null,n.request("GET","/publicacao/buscar/"+o.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),c.noticiaVisualizada=o.data,c.noticiaVisualizada.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),c.noticiaVisualizada.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY")):l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},c.selecionaMotivoNoticia=function(o,e,a){c.noticiaSelecionada=angular.copy(o),a.$setPristine(),c.noticiaSelecionada.observacao=null,c.motivoStatusSelecionado=e,s.mantemModal("#modalGerir"+r("slugify")(c.label.plural),!1),i(function(){s.mantemModal("#modalGerir"+r("slugify")(c.label.plural)+"Observacao",!0)},600)},c.limparMotivo=function(){c.noticiaSelecionada=null,c.motivoStatusSelecionado=null},c.salvarMotivo=function(o){o.$valid&&o.$submitted&&c.alterarStatusNoticia(c.noticiaSelecionada,c.motivoStatusSelecionado)},c.alterarStatusNoticia=function(e,a){l.confirmar(t.const.CONFIRMA_OPERACAO,function(o){o&&(c.dataJson={data:angular.copy(e)},c.dataJson.data.flStatusPublicacao.sigla=a,c.dataJson.data.flStatusPublicacao.descricao=a,c.dataJson.data.flStatusPublicacao.detalhe=null,c.dataJson.data.flStatusPublicacao.dominio="FL_STATUS_PUBLICACAO",c.noticiaSelecionada||(c.dataJson.data.observacao=null),c.dataJson.portal=n.portalConfig.portalAPI,n.request("POST","/publicacao/atualizar-situacao",c.dataJson,!0,function(o){o?200==o.retorno.codigo?(l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){c.pesquisarPublicacao(),i(function(){c.dataJson={data:o.data},c.dataJson.data.dtInicio=moment(o.data.dtInicio,"DD-MM-YYYY").format("DD/MM/YYYY"),c.dataJson.data.dtFim=moment(o.data.dtFim,"DD-MM-YYYY").format("DD/MM/YYYY"),c.noticiaSelecionada&&(c.noticiaSelecionada=null,c.motivoStatusSelecionado=null,s.mantemModal("#modalGerir"+r("slugify")(c.label.plural)+"Observacao",!1),i(function(){s.mantemModal("#modalGerir"+r("slugify")(c.label.plural),!0)},500))},1e3),t.$broadcast("broadcastHomeReceiver")}),form.$setPristine()):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()}))})}}]}),app.component("videosCrud",{templateUrl:"app/partials/videos-crud.html",bindings:{itens:"<",video:"<"},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService",function(t,n,o,i,r,a){n.utilizador=a.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,e){n.utilizador=a.get("utilizadorLogado")}),this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerirVideos",function(){n.paginaAtual=1,n.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirVideosNovo",function(){n.exibirForm=!1}),$(document).on("shown.bs.modal","#modalGerirVideosNovo",function(){n.exibirForm=!0})},n.novoVideo=function(e){e.$valid&&e.$submitted&&i.request("POST","/video/salvar",n.dataJson,!0,function(o){o?200==o.retorno.codigo?r.closeProgressAlert(function(){r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")}),e.$setPristine(),n.dataJson.data.cdPublicacao||e.$$element[0].reset(),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},n.setObj=function(o){n.dataJson={portal:i.portalConfig.portalAPI,data:{}},n.dataJson.data=o||{cdPublicacao:null,descricao:null,dtFim:null,dtInicio:null,autor:null,flStatusPublicacao:{sigla:"PUB",descricao:"PUB",detalhe:"Publicado",dominio:"FL_STATUS_PUBLICACAO"},qtdAcesso:0,sumario:null,titulo:null,anexoPortalList:[{cdAnexoPortal:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}],templatePublicacao:null,dsPortal:i.portalConfig.portalAPI,flDestaque:"N",dtCriacao:null,observacao:null}},n.dataJson={},n.paginaAtual=1,n.paginacaoQtdRegistros=5,n.paginacaoArray=[5,10,15,20],n.q="",n.paginarRegistos=function(){i.request("GET","/video/listar/"+i.portalConfig.portalAPI+"/"+n.paginaAtual+"/"+n.paginacaoQtdRegistros,null,!0,function(o){o?200==o.retorno.codigo?(r.closeProgressAlert(),n.itensPaginados=o):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},n.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(n.itensPaginados.quantidadeTotalItens/n.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}catch(o){}},n.setarPaginaAtual=function(o){n.paginaAtual=o,n.paginarRegistos()},n.setarRegistosPorPagina=function(o){n.paginacaoQtdRegistros=o.paginacaoQtdRegistros,n.paginarRegistos()},n.carregarRegistrosDestaques=function(o){n.exibirDestaques=o.exibirDestaques,n.paginarRegistos()},n.excluir=function(a,o){r.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:i.portalConfig.portalAPI,data:{cdPublicacao:a.cdPublicacao}};i.request("DELETE","/video/remover",e,!0,function(o){o?200==o.retorno.codigo?(n.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})}})}}]}),app.component("galeriasCrud",{templateUrl:"app/partials/galerias-crud.html",bindings:{template:"@",label:"@"},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService",function(n,i,r,l,s,a){i.utilizador=a.get("utilizadorLogado"),n.$on("broadcastUtilizadorReceiver",function(o,e){i.utilizador=a.get("utilizadorLogado")}),this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerirGaleria",function(){i.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirGaleriasNovo",function(){i.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerirGaleriasNovo",function(){i.exibirForm=!0})},i.extensoesPermitidasImagens=["jpg","jpeg","png"],i.tamanhoFicheiroImagem=1,i.novoFormulario=function(e){e.$valid&&e.$submitted&&l.request("POST","/noticia/galeria/salvar",i.dataJson,!0,function(o){o?200==o.retorno.codigo?(s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){i.paginarRegistos(),r(function(){i.setObj(o.data)},1e3),n.$broadcast("broadcastHomeReceiver")}),e.$setPristine()):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},i.preUpload=function(o){angular.isDefined(o)&&o.target.files.length&&angular.forEach(o.target.files,function(a){a.extensao=a.name.split(".");var o=new FileReader;o.readAsDataURL(a),o.onload=function(){var o={permitir:!0,tamanho:!0};if(i.extensoesPermitidasImagens.indexOf(a.extensao[a.extensao.length-1].toLowerCase())<0&&(e.onloadend=!1,o.permitir=!1,s.showMensagemRetorno(400,"Tipo do ficheiro inválido")),a.size>1048576*i.tamanhoFicheiroImagem&&(e.onloadend=!1,o.tamanho=!1,s.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho){var e=new FileReader;e.readAsDataURL(a),e.onload=function(){var o={cdAnexoPortal:null,anexoPortalItemList:[{nome:a.name,base64Anexo:e.result.substr(e.result.indexOf(",")+1).replace(/ /g,""),extensao:a.extensao[a.extensao.length-1],mimeType:a.type,url:null,videoUrl:null}]};i.dataJson.data.anexoPortalList.push(o)}}},o.onloadstart=function(){s.showProgressAlert()},o.onloadend=function(){s.closeProgressAlert()},o.onabort=function(){s.closeProgressAlert()}})},i.excluirAnexo=function(a,o,t){s.confirmar("Excluir este Registo ?",function(o){var e={portal:l.portalConfig.portalAPI,data:{cdAnexoPortal:a.cdAnexoPortal}};l.request("POST","/menu/removerAnexo",e,!0,function(o){r(function(){i.dataJson.data.anexoPortalList.splice(t,1),s.closeProgressAlert(),n.$broadcast("broadcastHomeReceiver")},100)})})},i.excluir=function(a,o){s.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:l.portalConfig.portalAPI,data:{cdPublicacao:a.cdPublicacao}};l.request("DELETE","/formulario/remover",e,!0,function(o){o?200==o.retorno.codigo?(i.paginarRegistos(),n.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})}})},i.setObj=function(o){i.dataJson={portal:l.portalConfig.portalAPI,data:{}},o?(i.dataJson.data=o,i.dataJson.data.anexoPortalList.length||(i.dataJson.data.anexoPortalList=[])):i.dataJson={portal:l.portalConfig.portalAPI,data:{cdPublicacao:null,descricao:null,descricaoGaleria:null,dtFim:null,dtInicio:null,flStatusPublicacao:{sigla:"PUB",detalhe:"Publicada",dominio:"FL_STATUS_PUBLICACAO"},qtdAcesso:0,sumario:null,titulo:null,templatePublicacao:null,dsPortal:l.portalConfig.portalAPI,flDestaque:"N",autor:null,dtCriacao:null,observacao:null,idAnexo:null,idImagem:null,filePath:null,urlImagemContent:null,anexoPortalList:[]}}},i.dataJson={},i.paginaAtual=0,i.paginacaoQtdRegistros=5,i.q="",i.paginarRegistos=function(){var o={portal:l.portalConfig.portalAPI,data:{flDestaque:"N"}};l.request("POST","/noticia/galeria/listar/",o,!0,function(o){o?200==o.retorno.codigo?(s.closeProgressAlert(),i.itensPaginados=o):923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()})},i.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(i.itensPaginados.quantidadeTotalItens/i.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}catch(o){}},i.setarPaginaAtual=function(o){i.paginaAtual=o,i.paginarRegistos()},i.setarRegistosPorPagina=function(o){i.paginacaoQtdRegistros=o.paginacaoQtdRegistros,i.paginarRegistos()}}]}),app.component("formulariosCrud",{templateUrl:"app/partials/formularios-crud.html",bindings:{template:"@",label:"@",imgCrop:"="},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService",function(t,r,a,n,l,i){var e=this;r.utilizador=i.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,e){r.utilizador=i.get("utilizadorLogado")}),this.$onInit=function(o){$(document).on("shown.bs.modal","#modalGerir"+e.template,function(){r.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerir"+e.template+"Novo",function(){r.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerir"+e.template+"Novo",function(){r.exibirForm=!0})},r.extensoesPermitidas=["pdf","doc","docx","xls","xlsx","jpg","png","zip","rar"],r.tamanhoFicheiro=10,r.extensoesImagensPermitidas=["jpg","jpeg","png"],r.tamanhoImagemFicheiro=1,r.novoFormulario=function(e){e.$valid&&e.$submitted&&n.request("POST","/formulario/salvar",r.dataJson,!0,function(o){o?200==o.retorno.codigo?(l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){a(function(){r.setObj(o.data)},1e3)}),t.$broadcast("broadcastHomeReceiver"),e.$setPristine()):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},r.preUpload=function(o,e,a,t){if(angular.isDefined(t)&&angular.isUndefined(t.isTrigger)&&t.target.files.length){var n=t.target.files[0];n.extensao=n.name.split(".");var i=new FileReader;i.readAsDataURL(n),i.onload=function(){var o={permitir:!0,tamanho:!0};r.extensoesPermitidas.indexOf(n.extensao[n.extensao.length-1].toLowerCase())<0&&(i.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),n.size>1048576*r.tamanhoFicheiro&&(i.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&(r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].nome=n.name,r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo=i.result.substr(i.result.indexOf(",")+1).replace(/ /g,""),r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].extensao=n.extensao[n.extensao.length-1],r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].mimeType=n.type)},i.onloadstart=function(){l.showProgressAlert()},i.onloadend=function(){l.closeProgressAlert()},i.onabort=function(){l.closeProgressAlert()}}},r.ficheiroAnexoExcluir=function(a,o,e,t){o.novo?r.ficheiroAnexoNovo():l.confirmar("Confirma Excluir Ficheiro ?",function(o){if(o){var e={portal:RequestSer.portalAPI,data:{cdAnexoPortalItem:a.cdAnexoPortalItem}};n.request("POST","/menu/removerAnexoItem",e,!1,function(o){o?200==o.retorno.codigo?r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0]={cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}:923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},r.ficheiroAnexoNovo=function(){r.dataJson.data.anexoPortalList=[{anexoPortalItemList:[]}];r.dataJson.data.anexoPortalList.push({novo:!0,cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null},{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]})},r.excluir=function(a,o){l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:n.portalConfig.portalAPI,data:{cdPublicacao:a.cdPublicacao}};n.request("DELETE","/formulario/remover",e,!0,function(o){o?200==o.retorno.codigo?(r.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},r.setObj=function(o){if(r.dataJson={portal:n.portalConfig.portalAPI,data:{}},o)if(r.dataJson.data=o,r.dataJson.data.anexoPortalList.length)try{var e=[];angular.forEach(r.dataJson.data.anexoPortalList[0].anexoPortalItemList,function(o){0<=o.nome.indexOf("_CAPA_")?e[1]=o:e[0]=o}),r.dataJson.data.anexoPortalList[0].anexoPortalItemList=e}catch(o){}else r.ficheiroAnexoNovo();else r.dataJson={portal:n.portalConfig.portalAPI,data:{cdPublicacao:null,descricao:"descricao",dtFim:null,dtInicio:null,flStatusPublicacao:{sigla:"PUB",descricao:"PUB",detalhe:"Publicado",dominio:"FL_STATUS_PUBLICACAO"},qtdAcesso:0,sumario:null,titulo:null,anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null},{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}],templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:this.$ctrl.template,descricao:this.$ctrl.template,detalhe:"Formulário",dominio:"TP_FORMULARIO"},publicacaoList:null,anexoPortalList:null},dsPortal:n.portalConfig.portalAPI,flDestaque:null,observacao:null,autor:null,dtCriacao:moment(new Date,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100")}}},r.dataJson={},r.paginaAtual=0,r.paginacaoQtdRegistros=5,r.paginacaoArray=[5,10,15,20],r.q="",r.paginarRegistos=function(){var o={portal:n.portalConfig.portalAPI,data:{paginaAtual:r.paginaAtual+1,itensPorPagina:r.paginacaoQtdRegistros,templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:e.template,descricao:e.template,detalhe:"Formulário",dominio:"TP_FORMULARIO"}}}};n.request("POST","/formulario/listar/",o,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),r.itensPaginados=o):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},r.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(r.itensPaginados.quantidadeTotalItens/r.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}catch(o){}},r.setarPaginaAtual=function(o){r.paginaAtual=o,r.paginarRegistos()},r.setarRegistosPorPagina=function(o){r.paginacaoQtdRegistros=o.paginacaoQtdRegistros,r.paginarRegistos()}}]}),app.component("eventosCrud",{templateUrl:"app/partials/eventos-crud.html",bindings:{itens:"<",artigo:"<"},controller:["$rootScope","$scope","$filter","$timeout","RequestService","StorageService","AlertaService","UtilizadorService",function(t,n,o,i,r,a,l,e){n.utilizador=a.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,e){n.utilizador=a.get("utilizadorLogado")});this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerirEventos",function(){n.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirEventosNovo",function(){n.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerirEventosNovo",function(){n.exibirForm=!0})},n.extensoesPermitidasImagens=["jpg","png","gif","bmp"],n.tamanhoFicheiroImagem=1,n.editorImageUpload={},n.tinymceOptions={paste_as_text:!0,menubar:!1,statusbar:!1,plugins:"link image media table lists imagetools paste textcolor",height:200,toolbar:"alignleft aligncenter alignright alignjustify | formatselect forecolor | copy paste cleanup | bold italic underline |  bullist numlist | link unlink | table | undo redo",automatic_uploads:!0,file_picker_types:"image",fontsize_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 20pt 21pt 22pt 23pt 24pt",image_title:!1,image_description:!1,imagetools_toolbar:"editimage imageoptions",content_css:"app/main/css/lato.css",setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){i(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},300)})})},file_picker_callback:function(t,o,e){var a=angular.element("#editorImageUpload");i(function(){angular.element(a).click()},200),a.on("change",function(o){var e=o.target.files[0];e.extensao=e.name.split(".");var a=new FileReader;a.readAsDataURL(e),a.onload=function(){var o={permitir:!0,tamanho:!0};n.extensoesPermitidasImagens.indexOf(e.extensao[e.extensao.length-1].toLowerCase())<0&&(a.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),e.size>1048576*n.tamanhoFicheiroImagem&&(a.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&t(a.result,{title:e.name})},a.onloadstart=function(){l.showProgressAlert()},a.onloadend=function(){l.closeProgressAlert()},a.onabort=function(){l.closeProgressAlert()}})}},n.salvarEvento=function(e){e.$valid&&e.$submitted&&(n.dataJson.data.dtInicial=moment(n.dataJson.data.dtInicial,"DD-MM-YYYY HH:mm").format("DD-MM-YYYYTHH:mm:ss.000+0100"),n.dataJson.data.dtFinal=moment(n.dataJson.data.dtFinal,"DD-MM-YYYY HH:mm").format("DD-MM-YYYYTHH:mm:ss.000+0100"),r.request("POST","/evento/salvar",n.dataJson,!0,function(o){o?200==o.retorno.codigo?(l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){t.$broadcast("broadcastHomeReceiver"),n.paginarRegistos(),i(function(){n.setObj(o.data)},1e3)}),e.$setPristine()):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()}))},n.excluirAnexo=function(){n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},n.excluir=function(a,o){l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:r.portalConfig.portalAPI,data:{cdAgendaEvento:a.cdAgendaEvento}};r.request("DELETE","/evento/remover",e,!0,function(o){o?200==o.retorno.codigo?(n.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},n.dataJson={},n.setObj=function(o){n.dataJson={portal:r.portalConfig.portalAPI,data:{}},o?(n.dataJson.data=o,n.dataJson.data.dtInicial=moment(n.dataJson.data.dtInicial,"DD-MM-YYYY HH:mm").format("DD/MM/YYYY HH:mm"),n.dataJson.data.dtFinal=moment(n.dataJson.data.dtFinal,"DD-MM-YYYY HH:mm").format("DD/MM/YYYY HH:mm")):n.dataJson={portal:r.portalConfig.portalAPI,data:{cdAgendaEvento:null,dsPortal:r.portalConfig.portalAPI,templatePublicacao:null,tituloAgendaEvento:null,localAgendaEvento:null,dsAgendaEvento:null,dtFinal:null,dtInicial:null,flAtivo:"S",flStatusPublicacao:{sigla:"PUB",descricao:"PUB",detalhe:"Publicado",dominio:"FL_STATUS_PUBLICACAO"},cgRefCodes:{sigla:"ACOE",descricao:"ACOE",detalhe:"Sala de Imprensa",dominio:"TP_AGENDA_EVENTO"},observacao:null,dtCriacao:moment(new Date,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),detalhe:null}}},n.toggleActivo=function(e){n.toggle(e);var o={portal:r.portalConfig.portalAPI,data:e};r.request("POST","/evento/salvar",o,!1,function(o){o?200==o.retorno.codigo?t.$broadcast("broadcastHomeReceiver"):(923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),n.toggle(e)):(l.erroRede(),n.toggle(e))})},n.toggle=function(o){return"S"==o.flAtivo?o.flAtivo="N":"N"==o.flAtivo&&(o.flAtivo="S"),o},n.paginaAtual=1,n.paginacaoQtdRegistros=5,n.paginacaoArray=[5,10,15,20],n.q="",n.exibirDestaques="S",n.paginarRegistos=function(){r.request("GET","/evento/listar/"+r.portalConfig.portalAPI+"/T/"+n.paginaAtual+"/"+n.paginacaoQtdRegistros,null,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),n.itensPaginados=o):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},n.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(n.itensPaginados.quantidadeTotalItens/n.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}catch(o){}},n.setarPaginaAtual=function(o){n.paginaAtual=o,n.paginarRegistos()},n.setarRegistosPorPagina=function(o){n.paginacaoQtdRegistros=o.paginacaoQtdRegistros,n.paginarRegistos()},n.carregarRegistrosDestaques=function(o){n.exibirDestaques=o.exibirDestaques,n.paginarRegistos()}}]}),app.component("linksUteisCrud",{templateUrl:"app/partials/links-uteis-crud.html",bindings:{tipo:"@",dimensoes:"@",titulo:"@",url:"=",activo:"="},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService","Utils",function(t,i,r,n,l,a,s){var c=this,u=this;i.utilizador=a.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,e){i.utilizador=a.get("utilizadorLogado")}),i.dataJson={},i.paginaAtual=1,i.paginacaoQtdRegistros=5,i.paginacaoArray=[5,10,15,20],i.q="",i.linksUteiSelecionado,i.motivoStatusSelecionado,this.$onInit=function(o){u.initUtilizador(!1)},this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerir"+c.tipo,function(){i.paginaAtual=1,i.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerir"+c.tipo+"Novo",function(){i.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerir"+c.tipo+"Novo",function(){i.exibirForm=!0})},u.initUtilizador=function(o){u.utilizador=a.get("utilizadorLogado"),u.administrador=!1,u.gestor=!1,u.publicador=!1,u.redator=!1,u.revisor=!1,u.editor=!1,u.utilizador&&(u.administrador=s.validaPermissao("administrador",u.utilizador.grupos),u.gestor=s.validaPermissao("gestor",u.utilizador.grupos),u.publicador=s.validaPermissao("publicador",u.utilizador.grupos),u.redator=s.validaPermissao("redator",u.utilizador.grupos),u.revisor=s.validaPermissao("revisor",u.utilizador.grupos),u.editor=s.validaPermissao("editor",u.utilizador.grupos),o&&u.init(null,u.utilizador.gestor))},u.validaEditar=function(o){var e=!1;return"CRIA"==o&&(u.editor||u.redator||u.gestor||u.administrador)?e=!0:"RREV"==o&&(u.editor||u.redator||u.gestor||u.administrador)?e=!0:u.administrador&&(e=!0),e},i.extensoesPermitidas=["jpg","jpeg","png","gif"],i.tamanhoFicheiro=1,i.tinymceOptionsUpload={paste_as_text:!0,menubar:!1,statusbar:!1,plugins:"link image media table lists paste code",height:200,toolbar:"image",automatic_uploads:!0,file_picker_types:"image",fontsize_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 20pt 21pt 22pt 23pt 24pt",image_title:!1,image_description:!1,image_dimensions:!1,nowrap:!1,readonly:!1,setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){r(function(){"Inserir/editar imagem"==$(".mce-title").html()&&($(".mce-combobox input").attr("readonly","readonly").addClass("disabled"),$("input:last").focus())},100)})})},file_picker_callback:function(t,o,e){var n=angular.element("#editorImagemLink_"+c.tipo);r(function(){angular.element(n).click()},200),n.on("change",function(o){i.ficheiroSelecionado=o.target.files[0],i.ficheiroSelecionado.extensao=i.ficheiroSelecionado.name.split(".");var a=new FileReader;a.readAsDataURL(i.ficheiroSelecionado),a.onload=function(){var o={permitir:!0,tamanho:!0};if(i.extensoesPermitidas.indexOf(i.ficheiroSelecionado.extensao[i.ficheiroSelecionado.extensao.length-1].toLowerCase())<0&&(a.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),i.ficheiroSelecionado.size>i.tamanhoMaximoPermitido&&(a.onloadend=!1,o.tamanho=!1,Alertas.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho){var e=a.result;i.editorImageUpload=e,n.val(""),t(e,{title:i.ficheiroSelecionado.name})}},a.onloadstart=function(){l.showProgressAlert()},a.onloadend=function(){l.closeProgressAlert()},a.onabort=function(){l.closeProgressAlert()}})}},i.novoLinkUtil=function(e){if(e.$valid&&e.$submitted){if(i.editorImageUpload){var a=i.editorImageUpload.substr(i.editorImageUpload.indexOf(",")+1).replace(/ /g,"");try{i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].nome=i.ficheiroSelecionado.name,i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].mimeType=i.ficheiroSelecionado.type,i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].extensao=i.ficheiroSelecionado.extensao[i.ficheiroSelecionado.extensao.length-1],i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo=a}catch(o){i.dataJson.data.anexoPortalList=[{anexoPortalList:[{nome:i.ficheiroSelecionado.name,mimeType:i.ficheiroSelecionado.type,extensao:i.ficheiroSelecionado.extensao[i.ficheiroSelecionado.extensao.length-1],base64:a}]}]}}var o=angular.copy(i.dataJson);"IMGALT"!=c.tipo||i.dataJson.data.url||(o.data.url="semurl"),n.request("POST","/linksUteis/salvar",o,!0,function(o){o?200==o.retorno.codigo?(l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){i.paginarRegistos()}),e.$setPristine(),i.dataJson.data.cdLinksUteis||e.$$element[0].reset(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}},i.toggleActivo=function(e){i.toggle(e);var o={portal:n.portalConfig.portalAPI,data:e};n.request("POST","/linksUteis/salvar",o,!1,function(o){o?200==o.retorno.codigo?t.$broadcast("broadcastHomeReceiver"):(923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),i.toggle(e)):(l.erroRede(),i.toggle(e))})},i.toggle=function(o){return"S"==o.flAtivo?o.flAtivo="N":"N"==o.flAtivo&&(o.flAtivo="S"),o},i.excluir=function(a,o){l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:n.portalConfig.portalAPI,data:{cdLinksUteis:a.cdLinksUteis}};n.request("DELETE","/linksUteis/remover",e,!0,function(o){o?200==o.retorno.codigo?(i.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},i.excluirAnexo=function(){i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,i.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},i.setObj=function(o){i.dataJson={portal:n.portalConfig.portalAPI,data:{}},o?("semurl"==o.url&&(o.url=null),i.dataJson.data=o):i.dataJson.data={cdLinksUteis:null,dsPortal:n.portalConfig.portalAPI,flAtivo:"S",dtCriacao:moment(new Date,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),titulo:null,url:null,flStatusPublicacao:{sigla:"CRIA",descricao:"CRIA",detalhe:"Criada",dominio:"FL_STATUS_PUBLICACAO"},observacao:null,tpLinksUteis:this.$ctrl.tipo,anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}]}},u.alterarStatusLinksUteis=function(e,a){l.confirmar(t.const.CONFIRMA_OPERACAO,function(o){o&&(u.dataJson={data:angular.copy(e)},u.dataJson.data.flStatusPublicacao.sigla=a,u.dataJson.data.flStatusPublicacao.descricao=a,u.dataJson.data.flStatusPublicacao.detalhe=null,u.dataJson.data.flStatusPublicacao.dominio="FL_STATUS_PUBLICACAO",u.linksUteiSelecionado,u.dataJson.portal=n.portalConfig.portalAPI,n.request("POST","/linksUteis/atualizar-situacao",u.dataJson,!0,function(o){o?200==o.retorno.codigo?(l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){i.paginarRegistos(),r(function(){u.dataJson={data:o.data},u.linksUteiSelecionado&&(u.linksUteiSelecionado=null,u.motivoStatusSelecionado=null,s.mantemModal("#modalGerir"+$filter("slugify")(u.label.plural),!1),r(function(){s.mantemModal("#modalGerir"+$filter("slugify")(u.label.plural),!0)},500))},1e3),t.$broadcast("broadcastHomeReceiver")}),form.$setPristine()):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()}))})},u.selecionaMotivolinksUteis=function(o,e,a){a.$setPristine(),u.linksUteisSelecionada=angular.copy(o),u.motivoStatusSelecionado=angular.copy(e),s.mantemModal("#modalGerirslugifyObservacao"+u.tipo,!1),r(function(){s.mantemModal("#modalGerirslugifyObservacao"+u.tipo,!0)},600)},u.limparMotivo=function(){u.linksUteisSelecionada=null,u.motivoStatusSelecionado=null},u.salvarMotivo=function(o){o.$valid&&o.$submitted&&u.alterarStatusLinksUteis(u.linksUteisSelecionada,u.motivoStatusSelecionado)},i.paginarRegistos=function(){n.request("GET","/linksUteis/listar/"+n.portalConfig.portalAPI+"/"+c.tipo+"/T/"+i.paginaAtual+"/"+i.paginacaoQtdRegistros,null,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),i.itensPaginados=o.data,i.quantidadeTotalItens=0<parseInt(o.quantidadeTotalItens)?o.quantidadeTotalItens:i.itensPaginados.length):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},i.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(i.itensPaginados.quantidadeTotalItens/i.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}catch(o){}},i.setarPaginaAtual=function(o){i.paginaAtual=o,i.paginarRegistos()},i.setarRegistosPorPagina=function(o){i.paginacaoQtdRegistros=o.paginacaoQtdRegistros,i.paginarRegistos()},i.carregarRegistrosDestaques=function(o){i.exibirDestaques=o.exibirDestaques,i.paginarRegistos()}}]}),app.component("linksInformativosCrud",{templateUrl:"app/partials/links-informativos-crud.html",bindings:{tipo:"@",dimensoes:"@",titulo:"@",url:"=",activo:"="},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService","Utils",function(t,r,i,n,l,a,s){var c=this,u=this;r.utilizador=a.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,e){r.utilizador=a.get("utilizadorLogado")}),r.dataJson={},r.paginaAtual=1,r.paginacaoQtdRegistros=5,r.paginacaoArray=[5,10,15,20],r.q="",r.linksUteiSelecionado,r.motivoStatusSelecionado,this.$onInit=function(o){u.initUtilizador(!1)},this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerir"+c.tipo,function(){r.paginaAtual=1,r.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerir"+c.tipo+"Novo",function(){r.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerir"+c.tipo+"Novo",function(){r.exibirForm=!0})},u.initUtilizador=function(o){u.utilizador=a.get("utilizadorLogado"),u.administrador=!1,u.gestor=!1,u.publicador=!1,u.redator=!1,u.revisor=!1,u.editor=!1,u.utilizador&&(u.administrador=s.validaPermissao("administrador",u.utilizador.grupos),u.gestor=s.validaPermissao("gestor",u.utilizador.grupos),u.publicador=s.validaPermissao("publicador",u.utilizador.grupos),u.redator=s.validaPermissao("redator",u.utilizador.grupos),u.revisor=s.validaPermissao("revisor",u.utilizador.grupos),u.editor=s.validaPermissao("editor",u.utilizador.grupos),o&&u.init(null,u.utilizador.gestor))},u.validaEditar=function(o){var e=!1;return"CRIA"==o&&(u.editor||u.redator||u.gestor||u.administrador)?e=!0:"RREV"==o&&(u.editor||u.redator||u.gestor||u.administrador)?e=!0:u.administrador&&(e=!0),e},r.extensoesPermitidas=["pdf","doc","docx","xls","xlsx","jpg","png","zip","rar"],r.tamanhoFicheiro=10,r.extensoesImagensPermitidas=["jpg","jpeg","png","gif"],r.tamanhoImagemFicheiro=1,r.tinymceOptionsUpload={paste_as_text:!0,menubar:!1,statusbar:!1,plugins:"link image media table lists paste code",height:200,toolbar:"image",automatic_uploads:!0,file_picker_types:"image",fontsize_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 20pt 21pt 22pt 23pt 24pt",image_title:!1,image_description:!1,image_dimensions:!1,nowrap:!1,readonly:!1,setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){i(function(){"Inserir/editar imagem"==$(".mce-title").html()&&($(".mce-combobox input").attr("readonly","readonly").addClass("disabled"),$("input:last").focus())},100)})})},file_picker_callback:function(t,o,e){var n=angular.element("#editorImagemLink_"+c.tipo);i(function(){angular.element(n).click()},200),n.on("change",function(o){r.ficheiroSelecionado=o.target.files[0],r.ficheiroSelecionado.extensao=r.ficheiroSelecionado.name.split(".");var a=new FileReader;a.readAsDataURL(r.ficheiroSelecionado),a.onload=function(){var o={permitir:!0,tamanho:!0};if(r.extensoesPermitidas.indexOf(r.ficheiroSelecionado.extensao[r.ficheiroSelecionado.extensao.length-1].toLowerCase())<0&&(a.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),r.ficheiroSelecionado.size>r.tamanhoMaximoPermitido&&(a.onloadend=!1,o.tamanho=!1,Alertas.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho){var e=a.result;r.editorImageUpload=e,n.val(""),t(e,{title:r.ficheiroSelecionado.name})}},a.onloadstart=function(){l.showProgressAlert()},a.onloadend=function(){l.closeProgressAlert()},a.onabort=function(){l.closeProgressAlert()}})}},r.novoLinkInformativo=function(e){if(e.$valid&&e.$submitted){if(r.editorImageUpload){var a=r.editorImageUpload.substr(r.editorImageUpload.indexOf(",")+1).replace(/ /g,"");try{r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].nome=r.ficheiroSelecionado.name,r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].mimeType=r.ficheiroSelecionado.type,r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].extensao=r.ficheiroSelecionado.extensao[r.ficheiroSelecionado.extensao.length-1],r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].base64Anexo=a}catch(o){r.dataJson.data.anexoPortalList=[{anexoPortalList:[{nome:r.ficheiroSelecionado.name,mimeType:r.ficheiroSelecionado.type,extensao:r.ficheiroSelecionado.extensao[r.ficheiroSelecionado.extensao.length-1],base64:a}]}]}}var o=angular.copy(r.dataJson);"IMGALT"!=c.tipo||r.dataJson.data.url||(o.data.url="semurl"),n.request("POST","/linksUteis/salvar",o,!0,function(o){o?200==o.retorno.codigo?(l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){r.paginarRegistos()}),e.$setPristine(),r.dataJson.data.cdLinksUteis||e.$$element[0].reset(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}},r.preUpload=function(o,e,a,t){if(angular.isDefined(t)&&angular.isUndefined(t.isTrigger)&&t.target.files.length){var n=t.target.files[0];n.extensao=n.name.split(".");var i=new FileReader;i.readAsDataURL(n),i.onload=function(){var o={permitir:!0,tamanho:!0};r.extensoesPermitidas.indexOf(n.extensao[n.extensao.length-1].toLowerCase())<0&&(i.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),n.size>1048576*r.tamanhoFicheiro&&(i.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&(r.dataJson.data.anexoPortalList[0].anexoPortalItemList[1].nome=n.name,r.dataJson.data.anexoPortalList[0].anexoPortalItemList[1].base64Anexo=i.result.substr(i.result.indexOf(",")+1).replace(/ /g,""),r.dataJson.data.anexoPortalList[0].anexoPortalItemList[1].extensao=n.extensao[n.extensao.length-1],r.dataJson.data.anexoPortalList[0].anexoPortalItemList[1].mimeType=n.type)},i.onloadstart=function(){l.showProgressAlert()},i.onloadend=function(){l.closeProgressAlert()},i.onabort=function(){l.closeProgressAlert()}}},r.toggleActivo=function(e){r.toggle(e);var o={portal:n.portalConfig.portalAPI,data:e};n.request("POST","/linksUteis/salvar",o,!1,function(o){o?200==o.retorno.codigo?t.$broadcast("broadcastHomeReceiver"):(923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),r.toggle(e)):(l.erroRede(),r.toggle(e))})},r.toggle=function(o){return"S"==o.flAtivo?o.flAtivo="N":"N"==o.flAtivo&&(o.flAtivo="S"),o},r.excluir=function(a,o){l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:n.portalConfig.portalAPI,data:{cdLinksUteis:a.cdLinksUteis}};n.request("DELETE","/linksUteis/remover",e,!0,function(o){o?200==o.retorno.codigo?(r.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},r.excluirAnexo=function(){r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,r.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},r.setObj=function(o){r.dataJson={portal:n.portalConfig.portalAPI,data:{}},o?("semurl"==o.url&&(o.url=null),r.dataJson.data=o):r.dataJson.data={cdLinksUteis:null,dsPortal:n.portalConfig.portalAPI,flAtivo:"S",dtCriacao:moment(new Date,"DD-MM-YYYY").format("DD-MM-YYYYTHH:mm:ss.000+0100"),titulo:null,url:null,tpLinksUteis:this.$ctrl.tipo,anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null},{cdAnexoPortalItem:null,nome:null,mimeType:null,extensao:null,base64Anexo:null,url:null}]}],flStatusPublicacao:{sigla:"CRIA",descricao:"CRIA",detalhe:"Criada",dominio:"FL_STATUS_PUBLICACAO"},observacao:null}},u.alterarStatusLinksUteis=function(e,a){l.confirmar(t.const.CONFIRMA_OPERACAO,function(o){o&&(u.dataJson={data:angular.copy(e)},u.dataJson.data.flStatusPublicacao.sigla=a,u.dataJson.data.flStatusPublicacao.descricao=a,u.dataJson.data.flStatusPublicacao.detalhe=null,u.dataJson.data.flStatusPublicacao.dominio="FL_STATUS_PUBLICACAO",u.linksUteiSelecionado,u.dataJson.portal=n.portalConfig.portalAPI,n.request("POST","/linksUteis/atualizar-situacao",u.dataJson,!0,function(o){o?200==o.retorno.codigo?(l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){r.paginarRegistos(),i(function(){u.dataJson={data:o.data},u.linksUteiSelecionado&&(u.linksUteiSelecionado=null,u.motivoStatusSelecionado=null,s.mantemModal("#modalGerir"+$filter("slugify")(u.label.plural),!1),i(function(){s.mantemModal("#modalGerir"+$filter("slugify")(u.label.plural),!0)},500))},1e3),t.$broadcast("broadcastHomeReceiver")}),form.$setPristine()):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()}))})},u.selecionaMotivolinksUteis=function(o,e,a){a.$setPristine(),u.linksUteisSelecionada=angular.copy(o),u.motivoStatusSelecionado=angular.copy(e),s.mantemModal("#modalGerirslugifyObservacao"+u.tipo,!1),i(function(){s.mantemModal("#modalGerirslugifyObservacao"+u.tipo,!0)},600)},u.limparMotivo=function(){u.linksUteisSelecionada=null,u.motivoStatusSelecionado=null},u.salvarMotivo=function(o){o.$valid&&o.$submitted&&u.alterarStatusLinksUteis(u.linksUteisSelecionada,u.motivoStatusSelecionado)},r.paginarRegistos=function(){n.request("GET","/linksUteis/listar/"+n.portalConfig.portalAPI+"/"+c.tipo+"/T/"+r.paginaAtual+"/"+r.paginacaoQtdRegistros,null,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),r.itensPaginados=o.data,r.quantidadeTotalItens=0<parseInt(o.quantidadeTotalItens)?o.quantidadeTotalItens:r.itensPaginados.length):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},r.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(r.itensPaginados.quantidadeTotalItens/r.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}catch(o){}},r.setarPaginaAtual=function(o){r.paginaAtual=o,r.paginarRegistos()},r.setarRegistosPorPagina=function(o){r.paginacaoQtdRegistros=o.paginacaoQtdRegistros,r.paginarRegistos()},r.carregarRegistrosDestaques=function(o){r.exibirDestaques=o.exibirDestaques,r.paginarRegistos()}}]}),app.component("perguntasCrud",{templateUrl:"app/partials/perguntas-crud.html",bindings:{itens:"<",artigo:"<",sigla:"@",label:"@"},controller:["$rootScope","$scope","$filter","$timeout","RequestService","StorageService","AlertaService","UtilizadorService",function(t,n,o,i,r,a,l,e){n.utilizador=a.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,e){n.utilizador=a.get("utilizadorLogado")});var s=this;this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerirPerguntas"+s.sigla,function(){n.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerirPerguntas"+s.sigla+"Novo",function(){n.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerirPerguntas"+s.sigla+"Novo",function(){n.exibirForm=!0})},n.extensoesPermitidasImagens=["jpg","jpeg","png"],n.tamanhoFicheiroImagem=1,n.editorImageUpload={},n.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists imagetools paste textcolor code",height:300,toolbar:"alignleft aligncenter alignright alignjustify | outdent indent | formatselect forecolor | copy paste cleanup | bold italic underline | bullist numlist | link unlink | table | image media | undo redo | code",automatic_uploads:!0,file_picker_types:"image",image_title:!1,image_description:!1,imagetools_toolbar:"editimage imageoptions",content_css:"app/main/css/lato.css",fontsize_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 20pt 21pt 22pt 23pt 24pt",font_formats:"Lato=lato",setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){i(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},300)})})},setup:function(o){o.on("load",function(o){$(".mce-btn button").click(function(){i(function(){"Inserir/editar imagem"==$(".mce-title").html()&&$(".mce-combobox input").attr("readonly","readonly").addClass("disabled")},300)})})},file_browser_callback:function(o,e,a,t){},file_picker_callback:function(t,o,e){var a=angular.element("#editorImageUpload");i(function(){angular.element(a).click()},200),a.on("change",function(o){var e=o.target.files[0];e.extensao=e.name.split(".");var a=new FileReader;a.readAsDataURL(e),a.onload=function(){var o={permitir:!0,tamanho:!0};n.extensoesPermitidasImagens.indexOf(e.extensao[e.extensao.length-1].toLowerCase())<0&&(a.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),e.size>1048576*n.tamanhoFicheiroImagem&&(a.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&t(a.result,{title:e.name})},a.onloadstart=function(){l.showProgressAlert()},a.onloadend=function(){l.closeProgressAlert()},a.onabort=function(){l.closeProgressAlert()}})}},n.salvarPergunta=function(o){o.$valid&&o.$submitted&&r.request("POST","/perguntasFrequentes/salvar",n.dataJson,!0,function(o){o?200==o.retorno.codigo?l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.dataJson=o,n.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},n.excluirAnexo=function(){n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].contentUrlARemover=n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url,n.dataJson.data.anexoPortalList[0].anexoPortalItemList[0].url=null},n.excluir=function(a,o){l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:r.portalConfig.portalAPI,data:{cdPerguntaFrequente:a.cdPerguntaFrequente}};r.request("DELETE","/perguntasFrequentes/remover",e,!0,function(o){o?200==o.retorno.codigo?l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},n.dataJson={},n.setObj=function(o){n.dataJson={portal:r.portalConfig.portalAPI,data:{}},o?n.dataJson.data=o:n.dataJson={portal:r.portalConfig.portalAPI,data:{cdPerguntaFrequente:null,dsPortal:r.portalConfig.portalAPI,dsPerguntaFrequente:null,dsResposta:null,flAtivo:{sigla:"S",descricao:"S",detalhe:"SIM",dominio:"SIM_NAO"},tpPergunta:{sigla:this.$ctrl.sigla,descricao:this.$ctrl.sigla,detalhe:"NENHUM TIPO DE PERGUNTA",dominio:"TP_PERGUNTA_PORTAL"}}}},n.paginaAtual=0,n.paginacaoQtdRegistros=5,n.paginacaoArray=[5,10,15,20],n.q="",n.exibirDestaques="S",n.paginarRegistos=function(){var o={portal:r.portalConfig.portalAPI,data:{tpPergunta:{sigla:this.$ctrl.sigla,descricao:this.$ctrl.sigla,detalhe:"NENHUM TIPO DE PERGUNTA",dominio:"TP_PERGUNTA_PORTAL"}}};r.request("POST","/perguntasFrequentes/listar",o,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),n.itensPaginados=o):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},n.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(n.itensPaginados.quantidadeTotalItens/n.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}catch(o){}},n.setarPaginaAtual=function(o){n.paginaAtual=o,n.paginarRegistos()},n.setarRegistosPorPagina=function(o){n.paginacaoQtdRegistros=o.paginacaoQtdRegistros,n.paginarRegistos()},n.carregarRegistrosDestaques=function(o){n.exibirDestaques=o.exibirDestaques,n.paginarRegistos()}}]}),app.component("videoPlayer",{templateUrl:"app/partials/video-player.html",bindings:{video:"<",height:"@"},controller:["$scope",function(o){}]}),app.component("produtoDestaque",{templateUrl:"app/partials/produto-destaque.html",bindings:{data:"<"}}),app.component("formulariosSessaoCrud",{templateUrl:"app/partials/formularios-sessao-crud.html",bindings:{template:"=",label:"@",imgCrop:"=",cdpagina:"="},controller:["$rootScope","$scope","$timeout","RequestService","AlertaService","StorageService","Utils",function(t,r,n,i,l,a,s){var c=this;r.utilizador=a.get("utilizadorLogado"),t.$on("broadcastUtilizadorReceiver",function(o,e){r.utilizador=a.get("utilizadorLogado")}),this.$onInit=function(o){$(document).on("shown.bs.modal","#modalGerir"+c.template,function(){r.paginarRegistos()}),$(document).on("hidden.bs.modal","#modalGerir"+c.template+"Novo",function(){r.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerir"+c.template+"Novo",function(){r.exibirForm=!0})},r.extensoesPermitidas=["pdf","doc","docx","xls","xlsx","jpg","png","zip","rar"],r.tamanhoFicheiro=30,r.extensoesImagensPermitidas=["jpg","jpeg","png"],r.tamanhoImagemFicheiro=1,r.preUpload=function(o,e,a,t){if(angular.isDefined(t)&&angular.isUndefined(t.isTrigger)&&t.target.files.length){var n=t.target.files[0];n.extensao=n.name.split(".");var i=new FileReader;i.readAsDataURL(n),i.onload=function(){var o={permitir:!0,tamanho:!0};r.extensoesPermitidas.indexOf(n.extensao[n.extensao.length-1].toLowerCase())<0&&(i.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),n.size>1048576*r.tamanhoFicheiro&&(i.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&(r.sessao.anexoPortalList[0].anexoPortalItemList[e].nome=n.name,r.sessao.anexoPortalList[0].anexoPortalItemList[e].nomeFicheiro=angular.copy(n.name),r.sessao.anexoPortalList[0].anexoPortalItemList[e].base64Anexo=i.result.substr(i.result.indexOf(",")+1).replace(/ /g,""),r.sessao.anexoPortalList[0].anexoPortalItemList[e].extensao=n.extensao[n.extensao.length-1],r.sessao.anexoPortalList[0].anexoPortalItemList[e].mimeType=n.type)},i.onloadstart=function(){l.showProgressAlert()},i.onloadend=function(){l.closeProgressAlert()},i.onabort=function(){l.closeProgressAlert()}}},r.dataAgora=moment().format("YYYY-MM-DD"),r.initSessao={cdPublicacao:null,titulo:null,descricao:null,dtinicial:null,nuOrdem:null,anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,cdPublicacao:null,cdQuemEQuem:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,url:null,videoUrl:null,ficheiroUrl:null,base64Anexo:null,mimeType:null,extensao:null,contentUrlARemover:"N",contentId:null,nuOrdem:null}]}]},r.sessao=angular.copy(r.initSessao),r.novaSessaoInit=function(){r.sessao=angular.copy(r.initSessao)},r.editarFormularioSessao=function(o){r.sessao=angular.copy(o)},r.addFicheiroInput=function(){var o={cdAnexoPortalItem:null,nome:null,url:null,videoUrl:null,ficheiroUrl:null,base64Anexo:null,mimeType:null,extensao:null,contentUrlARemover:"N",contentId:null,excluir:!1,nuOrdem:parseInt(r.sessao.anexoPortalList[0].anexoPortalItemList.length?r.sessao.anexoPortalList[0].anexoPortalItemList.slice(-1)[0].nuOrdem+1:"dtInicio DESC")};r.sessao.anexoPortalList[0].anexoPortalItemList.push(o)},r.verificarFicheiroObrigatorio=function(o){var a=0;return 0<o.length&&angular.forEach(o,function(o,e){o.nome||"S"==o.contentUrlARemover||a++}),!(0<a)},r.excluirFormularioSessao=function(a){l.confirmar(t.const.CONFIRMA_EXCLUIR_SESSAO,function(o){if(o){var e={portal:i.portalConfig.portalAPI,data:{cdPublicacao:a.cdPublicacao}};i.request("DELETE","/formularioSecao/remover",e,!1,function(o){o?200==o.retorno.codigo?l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n(function(){r.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")},500)}):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},r.nomeFicheiro=function(o){var e;return o.url&&!o.nomeFicheiro?(e=o.url.split("/"))[e.length-1]:o.url&&!o.nome?(e=o.url.split("/"))[e.length-1]:o.nomeFicheiro?o.nomeFicheiro:o.nome?o.nome:"Seleccionar Ficheiro..."},r.manterFomularioSessao=function(e){if(e.$valid&&e.$submitted&&r.verificarFicheiroObrigatorio(r.sessao.anexoPortalList[0].anexoPortalItemList)){r.sessao.cdPublicacao?angular.forEach(r.sessoes,function(o,e){o.cdPublicacao==r.sessao.cdPublicacao&&(r.sessoes[e]=r.sessao)}):r.sessoes.push(r.sessao);var o={portal:i.portalConfig.portalAPI,data:{cdMenu:c.cdpagina,secoes:null}};o.data.secoes=r.sessoes,i.request("POST","/formularioSecao/salvar",o,!0,function(o){o?200==o.retorno.codigo?l.showMensagemRetorno(200,t.const.SESSAO_SALVA_COM_SUCESSO,function(){n(function(){var o="#modalGerir"+c.template+"Novo";s.mantemModal(o,!1),n(function(){s.mantemModal("#modalGerir"+c.template,!0),r.paginarRegistos(),t.$broadcast("broadcastHomeReceiver"),e.$setPristine()},500)},500)}):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}},r.ficheiroAnexoExcluir=function(e,a){l.confirmar("Confirma Excluir Ficheiro ?",function(o){o&&n(function(){e.cdAnexoPortalItem?r.sessao.anexoPortalList[0].anexoPortalItemList[a].contentUrlARemover="S":r.sessao.anexoPortalList[0].anexoPortalItemList.splice(a,1)},100)})},r.dataJson={},r.submitListarDocumentos=function(o){o.$valid&&(r.paginaAtual=1,r.paginarRegistos(!0))},r.paginaAtual=1,r.quantidadeTotalItens=0,r.paginacaoQtdRegistros=10,r.paginacaoArray=[10,20,50,100],r.q="",r.ordenacaoLista=[{campo:"dtInicio",titulo:"Data"},{campo:"nuOrdem",titulo:"Ordem"},{campo:"titulo",titulo:"Título"}],r.ordenarSentidoLista=[{sentido:"DESC",titulo:"Decrescente"},{sentido:"ASC",titulo:"Ascendente"}],r.ordenacao=r.ordenacaoLista[0],r.ordenacaoSentido=r.ordenarSentidoLista[0],r.paginarRegistos=function(o){var e={portal:i.portalConfig.portalAPI,data:{cdMenu:c.cdpagina,titulo:null,paginaAtual:r.paginaAtual,qtdPaginas:r.paginacaoQtdRegistros,ordenacao:r.ordenacao.campo+" "+r.ordenacaoSentido.sentido}};i.request("POST","/formularioSecao/listarPaginado",e,o,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),r.sessoes=o.data.secoes?o.data.secoes:[],r.quantidadeTotalItens=o.quantidadeTotalItens):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},r.initEditarOrdem=function(o,e,a){o.$setPristine(),e.editando=!e.editando,e.editando&&n(function(){angular.element("#inputEditarOrdem_"+a).focus()},100)},r.editarOrdem=function(o,e){if(o.$valid){var a={portal:i.portalConfig.portalAPI,data:{cdMenu:c.cdpagina,secoes:[e]}};i.request("POST","/formularioSecao/salvar",a,!1,function(o){o?200==o.retorno.codigo?(r.paginarRegistos(),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}}}]}),app.component("formulariosSessaoView",{templateUrl:"app/partials/formularios-sessao-view.html",controller:["$rootScope","$scope","$timeout","$state","$window","RequestService","AlertaService","StorageService",function(o,a,t,e,n,i,r,l){o.$on("broadcastHomeReceiver",function(o,e){t(function(){a.init()},1e3)}),a.init=function(){a.dataJson={portal:i.portalConfig.portalAPI,data:{cdMenu:e.current.cdMenu,titulo:null,paginaAtual:1,qtdPaginas:10,ordenacao:"dtInicio DESC"}},a.quantidadeTotalItens=0,a.paginarRegistos()},a.paginarRegistos=function(){a.quantidadeTotalItens=0,a.sessoes=[],i.request("POST","/formularioSecao/listarPaginado",a.dataJson,!1,function(o){o?200==o.retorno.codigo?(a.sessoes=o.data.secoes,a.quantidadeTotalItens=o.quantidadeTotalItens,n.scrollTo(0,0)):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})}}]}),app.component("paginacao",{templateUrl:"app/partials/paginacao.html",bindings:{itensPorPagina:"=",paginaAtual:"=",itens:"=",totalRegistros:"<",funcao:"&"},controller:["$timeout",function(o){var i=this;this.$onInit=function(o){i.PAGINACAO_gap=5},this.$onChanges=function(o){o.totalRegistros.currentValue&&(i.totalRegistros=o.totalRegistros.currentValue,i.PAGINACAO_groupToPages())},i.PAGINACAO_groupToPages=function(){i.PAGINACAO_pagedItems=[];for(var o=0;o<i.totalRegistros;o++)o%i.itensPorPagina==0?i.PAGINACAO_pagedItems[Math.floor(o/i.itensPorPagina)]=[i.itens[o]]:i.PAGINACAO_pagedItems[Math.floor(o/i.itensPorPagina)].push(i.itens[o])},i.PAGINACAO_range=function(o,e,a){var t=[];o<a&&(e=(a=o)<=i.PAGINACAO_gap?1:o-i.PAGINACAO_gap);for(var n=e;n<=a;n++)t.push(n);return t},i.PAGINACAO_prevPage=function(){2<i.paginaAtual&&(i.paginaAtual--,i.chamarFuncao())},i.PAGINACAO_nextPage=function(){i.paginaAtual<i.PAGINACAO_pagedItems.length&&(i.paginaAtual++,i.chamarFuncao())},i.PAGINACAO_firstPage=function(){i.paginaAtual=1,i.chamarFuncao()},i.PAGINACAO_lastPage=function(){i.paginaAtual=i.PAGINACAO_pagedItems.length,i.chamarFuncao()},i.PAGINACAO_setPage=function(o){i.paginaAtual=o,i.chamarFuncao()},i.chamarFuncao=function(){o(function(){i.funcao()})},i.retornaDivisao=function(o,e){if(angular.isDefined(o)&&angular.isDefined(e))return Math.ceil(o/e)}}]}),app.component("pesquisaView",{templateUrl:"app/partials/pesquisa.html",controller:["$timeout","$state","RequestService","AlertaService","Slug",function(e,a,t,n,i){var r=this;this.$onInit=function(o){r.init(),$(document).on("show.bs.modal","#modalPesquisar",function(){e(function(){$(".input-pesquisa").focus()},300)})},r.init=function(o){o&&o.$setPristine(),r.filterPesquisa={pesquisarTexto:null,paginacaoQtdRegistros:5,resultados:[]},r.paginaAtual=1},r.retornaLinkOrigem=function(o){var e={href:null,descricao:o.descricao?o.descricao:null};switch(o.flOrigem){case"PUBLICACAO":switch(o.noTemplate){case"TP_PUBLICACAO":case"COMUNICACAO":case"TP_PRONUNCIAMENTOS":case"RESENHA LEGISLATIVA":case"Noticias Internas":case"Teste":case"Newsletter":case null:e.href=a.href("sala-de-imprensa.noticias.cdPublicacao",{cdPublicacao:o.codigo,slug:i.slugify(o.titulo)},{absolute:!0})}break;case"LINKS_UTEIS":e.href=o.descricao;break;case"AGENDA_EVENTO":e.href=a.href("sala-de-imprensa.eventos.evento",{cdPublicacao:o.codigo,slug:i.slugify(o.titulo)},{absolute:!0});break;case"QUEM_E_QUEM":e.href=a.href("sobre-o-minfin.quem-e-quem.cdQuemEQuem",{cdQuemEQuem:o.codigo,regimeCarreira:i.slugify(o.state),noQuemEQuem:i.slugify(o.titulo)},{absolute:!0}),e.descricao=e.href;break;case"MENU":e.href=a.href(o.state,{},{absolute:!0});try{e.descricao=a.get(o.state).ncyBreadcrumb.label}catch(o){e.descricao=e.href}break;case"PERGUNTA_FREQUENTE":e.href=a.href("veja-tambem.perguntas-frequentes",{},{absolute:!0})}return e},r.submitPesquisarConteudo=function(o){o.$valid&&(r.paginaAtual=1,r.pesquisarConteudo())},r.pesquisarConteudo=function(){var o={portal:t.portalConfig.portalAPI,data:{texto:r.filterPesquisa.pesquisarTexto,paginaAtual:r.paginaAtual,qtdPaginas:r.filterPesquisa.paginacaoQtdRegistros}};t.request("POST","/pesquisar",o,!0,function(o){o?200==o.retorno.codigo?(n.closeProgressAlert(),r.filterPesquisa.resultados=o,r.pristineRequest=!1):923!=o.retorno.codigo&&n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},r.fecharModal=function(o){$(".modal.in").modal("hide")},r.numeroDePaginas=function(){if(angular.isDefined(r.filterPesquisa.resultados)&&angular.isDefined(r.filterPesquisa.resultados.quantidadeTotalItens)){for(var o=new Array(Math.ceil(r.filterPesquisa.resultados.quantidadeTotalItens/r.filterPesquisa.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}},r.setarPaginaAtual=function(o){r.paginaAtual=o,r.paginarRegistos(!0)},r.setarRegistosPorPagina=function(o){r.filterPesquisa.paginacaoQtdRegistros=o.paginacaoQtdRegistros,r.paginarRegistos(!0)}}]}),function(o,e,a,t,n,i){(t=o.gapi||(o.gapi={})).analytics={q:[],ready:function(o){this.q.push(o)}},n=e.createElement("script"),i=e.getElementsByTagName("script")[0],n.src="https://apis.google.com/js/platform.js",i.parentNode.insertBefore(n,i),n.onload=function(){t.load("analytics")}}(window,document),app.component("analytics",{templateUrl:"app/partials/analytics.html",bindings:{uidportal:"<",trackerid:"<"},controller:["$rootScope","$scope","RequestService","$window","$timeout","UtilizadorService","AlertaService",function(o,l,e,a,t,n,i){var r=this;l.uidportal=null,l.tokenAcessoAnalytics=null,l.filter={dtInicial:null,dtFinal:null},l.getTokenAnalytics=function(){e.request("GET","/analytics/token",null,!1,function(o){o?200==o.retorno.codigo?o.data&&(i.closeProgressAlert(),l.tokenAcessoAnalytics=o.data,t(function(){l.callGoogleAnalytics()},1e3)):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},l.getReportAnalytics=function(o){o.$valid&&o.$submitted&&l.callGoogleAnalytics()},l.callGoogleAnalytics=function(){gapi.analytics.ready(function(){var o=moment(l.filter.dtInicial,"DD/MM/YYYY").format("YYYY-MM-DD"),e=moment(l.filter.dtFinal,"DD/MM/YYYY").format("YYYY-MM-DD"),a=l.uidportal,t=l.tokenAcessoAnalytics;function n(o){return("0"+o).slice(-2)}gapi.analytics.auth.authorize({serverAuth:{access_token:t}}),gapi.analytics.auth.on("error",function(o){$("#infolabelC").css("display","block")}),gapi.analytics.auth.on("success",function(o){$("#infolabelC").css("display","none"),$(".painelAnalytics").css("opacity","1"),gapi.analytics.auth.authorize({serverAuth:{access_token:o.access_token}})}),gapi.analytics.auth.isAuthorized()?$("#painelAnalytics").css("opacity","1"):$(".painelAnalytics").css("opacity","0.4"),new gapi.analytics.report.Data({query:{ids:a,dimensions:"ga:country",metrics:"ga:sessions","start-date":o,"end-date":e,output:"dataTable"}}).on("success",function(o){$("#info_1").html(o.totalsForAllResults["ga:sessions"])}).execute(),new gapi.analytics.report.Data({query:{ids:a,metrics:"ga:users",dimensions:"ga:country","start-date":o,"end-date":e,output:"dataTable"}}).on("success",function(o){$("#info_2").html(o.totalsForAllResults["ga:users"])}).execute(),new gapi.analytics.report.Data({query:{ids:a,metrics:"ga:avgSessionDuration",dimensions:"ga:country","start-date":o,"end-date":e,output:"dataTable"}}).on("success",function(o){var e=function(o){var e=Math.floor(o/60);o%=60;var a=Math.floor(e/60);return e%=60,n(a)+":"+n(e)+":"+n(o)}(Math.floor(o.totalsForAllResults["ga:avgSessionDuration"]));$("#info_3").html(e)}).execute(),new gapi.analytics.report.Data({query:{ids:a,metrics:"ga:newUsers",dimensions:"ga:country","start-date":o,"end-date":e,output:"dataTable"}}).on("success",function(o){$("#info_4").html(o.totalsForAllResults["ga:newUsers"])}).execute(),$("#title_grafico_1").html("Quantidade de visualização de páginas:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:a,dimensions:"ga:date",metrics:"ga:pageviews","start-date":o,"end-date":e},chart:{type:"LINE",container:"grafico_1",options:{width:"auto"}}}).execute();$("#title_grafico_2").html("Acessos por páginas:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:a,dimensions:"ga:country",metrics:"ga:sessions,ga:users","start-date":o,"end-date":e},chart:{type:"GEO",container:"grafico_2",options:{width:"100%"}}}).execute();$("#title_grafico_7").html("Dispositivos móveis:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:a,dimensions:"ga:mobileDeviceBranding",metrics:"ga:sessions","start-date":o,"end-date":e,sort:"-ga:sessions","max-results":"5"},chart:{type:"PIE",container:"grafico_7",options:{width:"100%"}}}).execute();$("#title_grafico_8").html("Acessos por páginas:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:a,dimensions:"ga:country",metrics:"ga:sessions,ga:users","start-date":o,"end-date":e,sort:"-ga:sessions","max-results":"8"},chart:{type:"TABLE",container:"grafico_8",options:{width:"100%"}}}).execute();$("#title_grafico_3_4").html("Quantidade de acessos por navegador:");var i=new gapi.analytics.googleCharts.DataChart({query:{ids:a,dimensions:"ga:browser",metrics:"ga:sessions",sort:"-ga:sessions","max-results":"6"},chart:{type:"PIE",container:"grafico_3",options:{width:"100%"}}}),r=new gapi.analytics.googleCharts.DataChart({query:{ids:a,dimensions:"ga:date",metrics:"ga:sessions","start-date":o,"end-date":e,filters:"ga:browser==Internet Explorer"},chart:{type:"LINE",container:"grafico_4",options:{title:"Internet Explorer",width:"100%"}}});$("#title_grafico_5").html("Visualizações de página:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:a,dimensions:"ga:pageTitle",metrics:"ga:pageviews","start-date":o,"end-date":e,sort:"-ga:pageviews","max-results":"8"},chart:{type:"TABLE",container:"grafico_5",options:{width:"100%"}}}).execute();$("#title_grafico_6").html("Média de páginas visitadas em cada sessão:");new gapi.analytics.googleCharts.DataChart({reportType:"ga",query:{ids:a,dimensions:"ga:date",metrics:"ga:pageviewsPerSession","start-date":o,"end-date":e},chart:{type:"COLUMN",container:"grafico_6",options:{width:"100%"}}}).execute();i.execute(),i.on("success",function(o){var n=o.chart,i=o.dataTable;google.visualization.events.addListener(n,"select",function(o){if(n.getSelection().length){var e=n.getSelection()[0].row,a=i.getValue(e,0),t={query:{filters:"ga:browser=="+a},chart:{options:{title:a}}};r.set(t).execute()}}),r.execute()})})},this.$onInit=function(o){l.getTokenAnalytics(),l.filter.dtInicial=moment().subtract(1,"months").format("DD/MM/YYYY"),l.filter.dtFinal=moment().format("DD/MM/YYYY"),l.uidportal=r.uidportal}}]}),app.component("menuCrud",{transclude:!0,retrict:"E",templateUrl:"app/partials/menu-crud.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$filter","$timeout","RequestService","StorageService","AlertaService","dynamicStates","UploadService",function(a,n,i,r,o,l,t,s){var c=this;a.$on("broadcastUtilizadorReceiver",function(o,e){c.initUtilizador(!0)}),this.$onInit=function(o){c.initUtilizador(),c.extensoesPermitidasImagens="jpg,jpeg,png,gif,svg",c.tamanhoFicheiroImagem=1},c.initUtilizador=function(){c.utilizador=o.get("utilizadorLogado")},c.init=function(o){o&&r.request("GET","/menu/listar/"+r.portalConfig.portalAPI,null,!0,function(o){o?(l.closeProgressAlert(),200==o.retorno.codigo&&(c.menuPrincipal=o.data.menuItemList)):l.erroRede()})},c.novoItem=function(o,e){var a=e?c.menuPrincipal[c.menuPrincipal.length-1].nuOrdem+1:o.subPaginas?o.subPaginas.length+1:1,t={displayName:"Novo Menu "+a,url:null,state:null,cdMenu:null,contentID:null,nuOrdem:a,dsMenu:null,flAtivo:"N",subPaginas:null};t.state=e?n("slugify")(t.displayName):o.state+"."+n("slugify")(t.displayName),t.url="/"+n("slugify")(t.displayName),e?o.push(t):(o.subPaginas||(o.subPaginas=[]),o.subPaginas.push(t))},c.removerItem=function(a,t,n){a.cdMenu?l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:r.portalConfig.portalAPI,data:{cdMenu:a.cdMenu}};r.request("POST","/menu/removerMenu",e,!0,function(o){o?200==o.retorno.codigo?i(function(){l.closeProgressAlert();try{t.$parent.$parent.$parent.menuItem.subPaginas.splice(n,1)}catch(o){c.menuPrincipal.splice(n,1)}},200):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}}):i(function(){try{t.$parent.$parent.$parent.menuItem.subPaginas.splice(n,1)}catch(o){c.menuPrincipal.splice(n,1)}},200)},c.salvarMenu=function(o){if(o.$valid){var e={portal:r.portalConfig.portalAPI,data:{menu:c.menuPrincipal}};r.request("POST","/menu/salvar",e,!0,function(o){o?200==o.retorno.codigo?l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){c.atualizarRotas(function(){a.$broadcast("broadcastHomeReceiver")})}):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}},c.atualizarRotas=function(e){r.request("GET","/menu/listar/"+r.portalConfig.portalAPI,null,null,function(o){o?200==o.retorno.codigo&&(a.menu=o.data.menuItemList,a.contactos=o.data.contactos,c.menuPrincipal=o.data.menuItemList,t.fetchRoutes(o.data.menuItemList),l.closeProgressAlert(),e&&e()):l.erroRede()})},c.preUpload=function(o,e){s.preUploadMenu(o,c.extensoesPermitidasImagens,c.tamanhoFicheiroImagem,e)},c.extensoesPermitidasMap=function(o){if(o)return s.extensoesPermitidasMap(o.split(","))},c.resetarAnexo=function(o,e){o.ficheiro=null,e.$setPristine(),e.$$attr.id&&angular.element("#"+e.$$attr.id).val(null)},c.removerUrl=function(e){l.confirmar("Excluir este Registo ?",function(o){o&&i(function(){e.logoContentID=null},100)})}}]}),app.component("quemEQuemCrud",{templateUrl:"app/partials/quem-e-quem-crud.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$timeout","RequestService","StorageService","AlertaService",function(a,i,r,e,l){var n=this;a.$on("broadcastUtilizadorReceiver",function(o,e){n.initUtilizador(!1)}),this.$onInit=function(o){n.initUtilizador(),n.extensoesPermitidasImagens=["jpg","jpeg","png"],n.tamanhoFicheiroImagem=1,n.editorImageUpload={},n.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:200,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",nowrap:!1},n.exibirFormAreaColocacao=!1},n.initUtilizador=function(o){n.utilizador=e.get("utilizadorLogado"),o&&n.paginarRegistos(!1)},n.init=function(o){n.registos=[],o&&n.paginarRegistos(!0)},n.paginarRegistos=function(e){e=e||!1,r.request("GET","/quemEQuem/listar/"+r.portalConfig.portalAPI,null,e,function(o){o?(l.closeProgressAlert(),200==o.retorno.codigo&&(e&&l.closeProgressAlert(),n.registos=o.data)):l.erroRede()})},n.salvarQuemEQuem=function(o,e){o.$valid&&r.request("POST","/quemEQuem/salvar",n.dataJson,e,function(o){o?200==o.retorno.codigo?e?l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){n.registo(null,o.data),n.paginarRegistos(!1),a.$broadcast("broadcastHomeReceiver")}):(n.registo(null,o.data),n.paginarRegistos(!1),a.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},n.registo=function(o,e){o&&o.$setPristine(),n.dataJson={portal:r.portalConfig.portalAPI},e?n.dataJson.data=angular.copy(e):(n.dataJson.data={cdQuemEQuem:null,dsPortal:r.portalConfig.portalAPI,regimeCarreira:null,cdAreaColocacao:null,areaColocacaoItem:null,endereco:".",filiacao:".",nacionalidade:null,naturalidade:null,noQuemEQuem:null,quemEQuemItemList:[],anexoPortalList:[{cdAnexoPortal:null,cdLinksUteis:null,cdPublicacao:null,anexoPortalItemList:[{cdAnexoPortalItem:null,nome:null,url:null,base64Anexo:null,mimeType:null,extensao:null,contentUrlARemover:null}]}]},n.adicionarFormacao()),r.request("GET","/quemEQuem/listar/area-colocacao/"+r.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&(n.areaColocacaoList=o.data,e&&(n.dataJson.data.cdAreaColocacao=n.dataJson.data.areaColocacaoItem.areaColocacaoDTO.cdAreaColocacao,n.atualizarSelectPosicao(!1))):l.erroRede()}),n.listarRegimeCarreira(function(o){o&&(n.regimeDeCarreiraList=o.data)})},n.listarRegimeCarreira=function(e){r.request("GET","/quemEQuem/listar/regime-carreira/"+r.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&e(o):l.erroRede()})},n.atualizarSelectPosicao=function(e){n.dataJson.data.cdAreaColocacao&&r.request("GET","/quemEQuem/listar/area-colocacao-item/"+r.portalConfig.portalAPI+"/"+n.dataJson.data.cdAreaColocacao,null,e,function(o){o?(e&&l.closeProgressAlert(),200==o.retorno.codigo&&(n.areaColocacaoListItem=o.data)):l.erroRede()})},n.adicionarFormacao=function(){n.dataJson.data.quemEQuemItemList.push({cdQuemEQuemItem:null,dsQuemEQuemItem:null,noQuemEQuemItem:null})},n.removerFormacao=function(e){l.confirmar("Excluir este Registo ?",function(o){o&&i(function(){n.dataJson.data.quemEQuemItemList.splice(e,1)},200)})},n.remover=function(a){l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:r.portalConfig.portalAPI,data:{cdQuemEQuem:a.cdQuemEQuem}};r.request("DELETE","/quemEQuem/remover",e,!0,function(o){o?200==o.retorno.codigo?n.paginarRegistos(!1):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},n.initEditarLabelAreaColocacao=function(o,e){o.$setPristine(),e.area.editando=!e.area.editando},n.editarLabel=function(o,e){if(o.$valid){var a={portal:r.portalConfig.portalAPI,data:{cdAreaColocacao:e.area.cdAreaColocacao,dsAreaColocacao:e.area.dsAreaColocacao,nuOrdem:e.area.nuOrdem}};r.request("POST","/quemEQuem/salvar/area-colocacao",a,!0,function(o){o?200==o.retorno.codigo?(n.paginarRegistos(!1),e.editando=!1):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}},n.initEditarOrdem=function(o,e,a,t){o.$setPristine(),e.editando=!e.editando,e.editando&&i(function(){angular.element("#inputEditarOrdem_"+a+"_"+t).focus()},200)},n.editarOrdem=function(o,e){o.$valid&&(n.dataJson={portal:r.portalConfig.portalAPI,data:e},n.salvarQuemEQuem(o,!1))},n.initAreaColocacao=function(o){o.$setPristine(),n.exibirFormAreaColocacao=!n.exibirFormAreaColocacao,n.novaAreaColocacao={portal:r.portalConfig.portalAPI,data:{cdAreaColocacao:null,dsAreaColocacao:null,nuOrdem:null}}},n.adicionarArea=function(o){o.$valid&&r.request("POST","/quemEQuem/salvar/area-colocacao",n.novaAreaColocacao,!0,function(o){o?200==o.retorno.codigo?(n.paginarRegistos(!0),n.exibirFormAreaColocacao=!n.exibirFormAreaColocacao):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},n.excluirAreaColocacao=function(a){l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:r.portalConfig.portalAPI,data:{cdAreaColocacao:a.area.cdAreaColocacao}};r.request("DELETE","/quemEQuem/remover/area-colocacao",e,!0,function(o){o?200==o.retorno.codigo?n.paginarRegistos(!1):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},n.initGerirPosicoes=function(e){e.exibirGerirPosicao=!e.exibirGerirPosicao,e.exibirGerirPosicao&&r.request("GET","/quemEQuem/listar/area-colocacao-item/"+r.portalConfig.portalAPI+"/"+e.area.cdAreaColocacao,null,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),e.listarAreaPosicoes=o.data,o.data.length||(e.adicionandoPosicao=!0)):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},n.removerPosicao=function(a,t,n){l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:r.portalConfig.portalAPI,data:{cdAreaColocacaoItem:a.cdAreaColocacaoItem}};r.request("DELETE","/quemEQuem/remover/area-colocacao-item",e,!0,function(o){o?200==o.retorno.codigo?i(function(){t.listarAreaPosicoes.splice(n,1),t.listarAreaPosicoes.length||(t.exibirGerirPosicao=!1,t.area.temFilho=!1),l.closeProgressAlert()},200):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},n.initEditarPosicao=function(o,e,a,t){o.$setPristine(),n.editarPosicao={portal:r.portalConfig.portalAPI,data:{cdAreaColocacaoItem:e?e.cdAreaColocacaoItem:null,dsAreaColocacaoItem:e?e.dsAreaColocacaoItem:null,areaColocacaoDTO:{cdAreaColocacao:a.area.cdAreaColocacao,dsAreaColocacao:a.area.dsAreaColocacao,nuOrdem:a.area.nuOrdem}}},angular.forEach(a.listarAreaPosicoes,function(o){e&&e.cdAreaColocacaoItem==o.cdAreaColocacaoItem?(o.editando=!e.editando,a.adicionandoPosicao=!1,o.editando&&i(function(){angular.element("#inputEditarPosicaoLabel_"+o.cdAreaColocacaoItem).focus()},200)):o.editando=!1}),angular.isDefined(t)&&(a.adicionandoPosicao=t)},n.formSubmitPosicaoDescricao=function(e,a){if(e.$valid){var o={portal:r.portalConfig.portalAPI,data:{cdAreaColocacaoItem:n.editarPosicao.data.cdAreaColocacaoItem?n.editarPosicao.data.cdAreaColocacaoItem:null,dsAreaColocacaoItem:n.editarPosicao.data.dsAreaColocacaoItem,areaColocacaoDTO:{cdAreaColocacao:a.area.cdAreaColocacao,dsAreaColocacao:a.area.dsAreaColocacao,nuOrdem:a.area.nuOrdem}}};r.request("POST","/quemEQuem/salvar/area-colocacao-item",o,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),a.exibirGerirPosicao=!1,a.area.temFilho=!0,n.initGerirPosicoes(a),a.adicionandoPosicao&&n.initEditarPosicao(e,null,a,!0)):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}},n.initCargoCarreira=function(){n.listarRegimeCarreira(function(o){o&&(n.listarCargoCarreira=o.data)})},n.initEditarCargoCarreira=function(o,e){o.$setPristine(),n.cargoCarreira={portal:r.portalConfig.portalAPI,data:{cdRegimeCarreira:e?e.cdRegimeCarreira:null,cargo:e?e.cargo:null,dsPortal:r.portalConfig.portalAPI,flQeq:"S",nivel:{sigla:"CEN",descricao:"CEN",detalhe:"Nivel Central",dominio:"QV_NIVEL"},nuVagas:0,posto:{sigla:"CAR",descricao:"CAR",detalhe:"Titulares de Cargos de Direcção e Chefia",dominio:"QV_POSTO"},regime:{sigla:"GER",descricao:"GER",detalhe:"Utilizador Geral",dominio:"TP_PERFIL"},subposto:null}},angular.forEach(n.listarCargoCarreira,function(o){e?(o.cdRegimeCarreira==e.cdRegimeCarreira?e.editando=!e.editando:o.editando=!1,n.exibirFormCargo=!1):o.editando=!1}),e?i(function(){angular.element("#inputEditarCargo_"+e.cdRegimeCarreira).focus()},200):n.exibirFormCargo=!n.exibirFormCargo},n.editarCargoCarreira=function(e,a){e.$valid&&r.request("POST","/quemEQuem/salvar/regime-carreira",n.cargoCarreira,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),a?a.editando=!1:(n.initEditarCargoCarreira(e),n.exibirFormCargo=!1),n.initCargoCarreira()):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},n.removerCargoCarreira=function(a,t){l.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:r.portalConfig.portalAPI,data:{cdRegimeCarreira:a.cdRegimeCarreira}};r.request("DELETE","/quemEQuem/remover/regime-carreira",e,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),i(function(){n.listarCargoCarreira.splice(t,1)},200)):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}})},n.toggleActivo=function(o,e){e.flAtivo=n.flAtivoSNull(e)?"S":"N",n.dataJson={portal:r.portalConfig.portalAPI,data:e},n.salvarQuemEQuem(o,!1)},n.flAtivoSNull=function(o){return"N"==o.flAtivo||null==o.flAtivo}}]}),app.component("petroleoCrud",{templateUrl:"app/partials/petroleo-crud.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$timeout","$filter","RequestService","StorageService","AlertaService",function(t,n,o,i,e,r){var l=this;t.$on("broadcastUtilizadorReceiver",function(o,e){l.initUtilizador(!0)}),this.$onInit=function(o){l.initUtilizador(),l.anos=[];for(var e=2007;e<=moment().format("Y");e++)l.anos.push(e);l.meses=[];var a=moment.months();for(e=0;e<a.length;e++){var t={id:e,label:a[e]};l.meses.push(t)}},l.initUtilizador=function(){l.utilizador=e.get("utilizadorLogado")},l.init=function(o){l.itensPaginados=[],l.filter={portal:i.portalConfig.portalDefault,cdAno:(new Date).getFullYear(),cdMes:(new Date).getMonth(),paginaAtual:1,qtdPaginas:5},o&&l.paginarRegistos(!0)},l.gravarRegisto=function(o){o.$valid&&i.request("POST","/receita-petroleo/salvar",l.dataJson,!0,function(o){o?200==o.retorno.codigo?r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){l.registo(null,o.data),l.paginarRegistos(!0),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()},!0)},l.registo=function(o,e){o&&o.$setPristine(),l.dataJson={portal:i.portalConfig.portalDefault},l.dataJson.data=e?angular.copy(e):{cdReceita:null,cdAno:(new Date).getFullYear(),cdMes:(new Date).getMonth(),exportacaoBbls:null,precoMedio:null,irp:null,ipp:null,itp:null,vlTaxaGaz:null,vlServicoDivida:null,vlTaxaSuperficie:null,vlOutrosValores:null,concessionaria:null,descricao:null,total:null},l.somarTotal()},l.somarTotal=function(){n(function(){l.dataJson.data.total=o("valor")(o("stringToFloat")(l.dataJson.data.irp)+o("stringToFloat")(l.dataJson.data.ipp)+o("stringToFloat")(l.dataJson.data.itp)+o("stringToFloat")(l.dataJson.data.vlTaxaGaz)+o("stringToFloat")(l.dataJson.data.vlServicoDivida)+o("stringToFloat")(l.dataJson.data.vlTaxaSuperficie)+o("stringToFloat")(l.dataJson.data.vlOutrosValores)+o("stringToFloat")(l.dataJson.data.concessionaria))},50)},l.paginarRegistos=function(e){e=!!e,i.request("POST","/receita-petroleo/listar",l.filter,e,function(o){o?200==o.retorno.codigo&&(e&&r.closeProgressAlert(),o.data=o.data.length?o.data:null,l.itensPaginados=o):r.erroRede()},!0)},l.remover=function(a){r.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:i.portalConfig.portalDefault,data:{cdReceita:a.cdReceita}};i.request("DELETE","/receita-petroleo/remover",e,!0,function(o){o?200==o.retorno.codigo?(l.paginarRegistos(!0),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()},!0)}})},l.submitFormFiltrarRegistoCrud=function(o){o.$valid&&(l.filter.paginaAtual=1,l.itensPaginados=null,l.paginarRegistos(!0))},l.initEditarOrdem=function(o,e,a){o.$setPristine(),e.editando=!e.editando,e.editando&&n(function(){angular.element("#inputEditarOrdemPetroleo_"+a).focus()},200)},l.editarOrdem=function(o,e){o.$valid&&(l.dataJson={portal:i.portalConfig.portalDefault,data:e},l.gravarRegisto(o))}}]}),app.component("diamanteCrud",{templateUrl:"app/partials/diamante-crud.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$timeout","$filter","RequestService","StorageService","AlertaService",function(t,o,e,n,a,i){var r=this;t.$on("broadcastUtilizadorReceiver",function(o,e){r.initUtilizador(!0)}),this.$onInit=function(o){r.initUtilizador(),r.anos=[];for(var e=2007;e<=moment().format("Y");e++)r.anos.push(e);r.meses=[];var a=moment.months();for(e=0;e<a.length;e++){var t={id:e,label:a[e]};r.meses.push(t)}},r.initUtilizador=function(){r.utilizador=a.get("utilizadorLogado")},r.init=function(o){r.itensPaginados=[],r.filter={portal:n.portalConfig.portalDefault,cdAno:(new Date).getFullYear(),cdMes:(new Date).getMonth(),paginaAtual:1,qtdPaginas:5},o&&r.paginarRegistos(!0)},r.gravarRegisto=function(o){o.$valid&&n.request("POST","/receita-diamante/salvar",r.dataJson,!0,function(o){o?200==o.retorno.codigo?i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){r.registo(null,o.data),r.paginarRegistos(!0),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},r.registo=function(o,e){o&&o.$setPristine(),r.dataJson={portal:n.portalConfig.portalDefault},r.dataJson.data=e?angular.copy(e):{cdReceita:null,cdAno:(new Date).getFullYear(),cdMes:(new Date).getMonth(),volume:null,preco:null,valorCompra:null,impostoIndustrial:null,royalty:null,valorArrecadado:null},r.somarTotal()},r.somarTotal=function(){o(function(){r.dataJson.data.valorArrecadado=e("valor")(e("stringToFloat")(r.dataJson.data.impostoIndustrial)+e("stringToFloat")(r.dataJson.data.royalty))},50)},r.paginarRegistos=function(e){e=!!e,n.request("POST","/receita-diamante/listar",r.filter,e,function(o){o?200==o.retorno.codigo&&(e&&i.closeProgressAlert(),o.data=o.data.length?o.data:null,r.itensPaginados=o):i.erroRede()})},r.remover=function(a){i.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:n.portalConfig.portalDefault,data:{cdReceita:a.cdReceita}};n.request("DELETE","/receita-diamante/remover",e,!0,function(o){o?200==o.retorno.codigo?(r.paginarRegistos(!0),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})}})},r.submitFormFiltrarRegistoCrud=function(o){o.$valid&&(r.filter.paginaAtual=1,r.itensPaginados=null,r.paginarRegistos(!0))}}]}),app.component("inflacaoCrud",{templateUrl:"app/partials/inflacao-crud.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$timeout","$filter","RequestService","StorageService","AlertaService",function(t,o,e,n,a,i){var r=this;t.$on("broadcastUtilizadorReceiver",function(o,e){r.initUtilizador(!0)}),this.$onInit=function(o){r.initUtilizador(),r.anos=[];for(var e=2007;e<=moment().format("Y");e++)r.anos.push(e);r.meses=[];var a=moment.months();for(e=0;e<a.length;e++){var t={id:e,label:a[e]};r.meses.push(t)}},r.initUtilizador=function(){r.utilizador=a.get("utilizadorLogado")},r.init=function(o){r.itensPaginados=[],r.filter={portal:n.portalConfig.portalDefault,cdAno:(new Date).getFullYear(),cdMes:null,paginaAtual:1,qtdPaginas:5},o&&r.paginarRegistos(!0)},r.gravarRegisto=function(o){o.$valid&&n.request("POST","/taxa-inflacao/salvar",r.dataJson,!0,function(o){o?200==o.retorno.codigo?i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){r.registo(null,o.data),r.paginarRegistos(!0),t.$broadcast("broadcastHomeReceiver")}):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},r.registo=function(o,e){o&&o.$setPristine(),r.dataJson={portal:n.portalConfig.portalDefault},r.dataJson.data=e?angular.copy(e):{cdTaxaInflacao:null,cdAno:(new Date).getFullYear(),cdMes:(new Date).getMonth(),mensal:null,acumulada:null,homologa:null,media:0}},r.paginarRegistos=function(e){e=!!e,n.request("POST","/taxa-inflacao/listar",r.filter,e,function(o){o?200==o.retorno.codigo&&(e&&i.closeProgressAlert(),o.data=o.data.length?o.data:null,r.itensPaginados=o):i.erroRede()})},r.remover=function(a){i.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:n.portalConfig.portalDefault,data:{cdTaxaInflacao:a.cdTaxaInflacao}};n.request("DELETE","/taxa-inflacao/remover",e,!0,function(o){o?200==o.retorno.codigo?(r.paginarRegistos(!0),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})}})},r.submitFormFiltrarRegistoCrud=function(o){o.$valid&&(r.filter.paginaAtual=1,r.itensPaginados=null,r.paginarRegistos(!0))}}]}),app.component("glossarioCrud",{templateUrl:"app/partials/glossario-crud.html",bindings:{label:"<"},controller:["$rootScope","$timeout","RequestService","StorageService","AlertaService",function(t,o,n,e,i){var r=this;t.$on("broadcastUtilizadorReceiver",function(o,e){r.initUtilizador(!1)}),this.$onInit=function(o){r.initUtilizador(),r.extensoesPermitidasImagens=["jpg","jpeg","png"],r.tamanhoFicheiroImagem=1,r.editorImageUpload={},r.tinymceOptions={menubar:!1,statusbar:!1,plugins:"link image media table lists paste textcolor code",height:200,toolbar:"insertfile alignleft aligncenter alignright alignjustify | outdent indent | fontselect fontsizeselect formatselect forecolor | cop/y paste cleanup | bold italic underline |  bullist numlist | link unlink | table | undo redo | code",automatic_uploads:!0,file_picker_types:"image",content_css:"app/main/css/lato.css",font_formats:"Lato=lato",nowrap:!1},r.exibirFormAreaColocacao=!1},r.initUtilizador=function(o){r.utilizador=e.get("utilizadorLogado"),o&&r.paginarRegistos(!1)},r.init=function(o){r.registos=[],r.filter=null,o&&r.paginarRegistos(!0)},r.paginarRegistos=function(e){e=e||!1,n.request("GET","/glossario/listar/"+n.portalConfig.portalAPI,null,e,function(o){o?(i.closeProgressAlert(),200==o.retorno.codigo&&(e&&i.closeProgressAlert(),r.registos=o.data,r.indices=angular.copy(r.registos),r.filter&&r.indices[r.filter]||(r.filter=Object.keys(r.registos)[0]))):i.erroRede()})},r.salvarGlossario=function(o,e){o.$valid&&n.request("POST","/glossario/salvar",r.dataJson,e,function(o){o?200==o.retorno.codigo?e?i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){r.registo(null,o.data),r.paginarRegistos(!1),t.$broadcast("broadcastHomeReceiver")}):r.paginarRegistos(!1):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},r.registo=function(o,e){o&&o.$setPristine(),r.dataJson={portal:n.portalConfig.portalAPI},r.dataJson.data=e?angular.copy(e):{cdGlossario:null,tituloGlossario:null,dsGlossario:null}},r.remover=function(a){i.confirmar("Excluir este Registo ?",function(o){if(o){var e={portal:n.portalConfig.portalAPI,data:{cdGlossario:a.cdGlossario}};n.request("DELETE","/glossario/remover",e,!0,function(o){o?200==o.retorno.codigo?(r.paginarRegistos(!0),t.$broadcast("broadcastHomeReceiver")):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})}})}}]}),app.component("candidaturaCrud",{templateUrl:"app/partials/candidatura-crud.html",bindings:{label:"<",template:"<",listarOrgao:"<"},controller:["$scope","FileSaver","Blob","$ws","RouteServce","AlertaService","$location","$timeout","ComumServices","Utils","ContribuinteService","EnderecoService","$translate",function(o,e,a,t,n,i,r,l,s,c,u,d,g){var m=this;m.regimesCandidatura=[],m.categoriasCandidatura=[],m.estadosCivis=[],m.tiposCartaConducao=[],m.formacoesAcademicas=[],m.orgaos=[],m.listaProvincia=[],m.cursos=[],m.cdPaisAngola=null,m.cursoOutros=null,m.visualizarMensagemDeSucesso=!1,m.candidaturaView={ilAnexo:[],inCdCandidaturaPublica:null,inCdProvincia:null,inCdRgc:null,ivDsEndereco:null,ivDsStCandidaturaPublica:null,idDtCandidatura:null,ivTpCandidaturaCat:null,inCatSeq:null,ivEmail:null,inFupSeq:null,ivNoContribuinte:null,ivNuContribuinte:null,inNuProtocolo:null,ivStCandidaturaPublica:null,ivTelefone:null},m.anexoOriginal={inCdCandidaturaAnexo:null,ivNoFicheiro:null,ivMimeType:null,ivAnexo:null,cdTpAnexoSigfe:null},m.indexAnexo=0,m.cdTpAnexoSigfeAtual=null,m.setIndexAnexo=function(o,e){m.indexAnexo=o,m.cdTpAnexoSigfeAtual=e},m.documentosObrigatorios=[],m.solicitacaoOriginal={flCartaConducao:null,inCdCandidaturaPublica:null,inNuProtocolo:null,idDtCandidatura:null,ivDsEndereco:null,inCdRgc:null,inFupSeq:null,inCatSeq:null,ivDsCategoria:null,ivTpCandidaturaCat:null,ivDsTpCandidaturaCat:null,ivNuContribuinte:null,ivNoContribuinte:null,ivStCandidaturaPublica:null,ivDsStCandidaturaPublica:null,ivDsMotivRejeicao:null,inIdVdpOrgao:null,ddi:"+244 ",ivTelefone:null,ivEmail:null,ivFlPossuiVinculo:null,inTempoServico:null,ivNoInstituicaoEnsino:null,inNuAnoInicioFormacao:null,inNuAnoFimFormacao:null,ivNoCursoOutro:null,inCdFormacAcademica:null,inCdFormacCurso:null,ilAnexo:[],ioCandidato:{inCdPessoaSisp:null,ivNuBi:null,ivDsLocalEmissao:null,ivNoPai:null,ivNoMae:null,ivSexo:null,ivEsCivil:null,idDtNascimento:null,inCdPaisNacionalidade:null,inCdProvinciaNaturalidade:null,ivNuCartaConducao:null,ivTipoCartaConducao:null}},m.dataHoraDoRegisto=null,m.dateToday=moment().format("YYYY-MM-DD"),m.ficheiroTemporario=angular.copy(m.anexoOriginal),m.extensoesPermitidas=["pdf","png","jpg","jpeg","doc","docx"],m.uploadLimite=2,m.init=function(o){m.cdPaisAngola=null,m.ultimoNIFPesquisado=null,m.confirmaEmail=null,m.isContribuinteLocalizado=!1,m.visualizarMensagemDeSucesso=!1,m.solicitacao=angular.copy(m.solicitacaoOriginal),o&&o.$setPristine(),m.listaPais||this.getListaPais(),m.listaProvincia.length||this.getListaProvincias(),l(function(){$("#modalMensagemCandidatura").modal("show"),$('[data-toggle="tooltip"]').tooltip()},400),m.listarRegimes(),m.listarEstadoCivil(),m.listarTiposDeCarta(),m.listarFormacoesAcademicas(),m.getListaTiposAnexos(),m.listarOrgao&&m.listarOrgaos(),$(document).on("shown.bs.modal","#modalAdicionarFicheiroEdital",function(){m.ficheiroTemporario=angular.copy(m.anexoOriginal)})},m.validaSituacaoMilitar=function(){m.documentosObrigatorios.forEach(function(o,e){if("CAM"===o.tipo){var a=m.retornaIdade();"M"===m.solicitacao.ioCandidato.ivSexo&&a<=30?o.obrigatorio=!0:o.obrigatorio=!1}})},m.retornaIdade=function(){var o=parseInt(moment(m.solicitacao.ioCandidato.idDtNascimento,"DD/MM/YYYY").format("YYYY"));return parseInt(moment().format("YYYY"))-o},m.listarRegimes=function(){s.getDominios("TP_CANDIDATURA_CAT",function(o){m.regimesCandidatura=o})},m.getListaTiposAnexos=function(){m.documentosObrigatorios=[],s.getListaTiposAnexos(!1,function(o){o.length&&o.forEach(function(o,e){if(o.cdTpAnexoSigfe){var a={cdTpAnexoSigfe:o.cdTpAnexoSigfe,noDocumento:o.dsTpAnexoSigfe,tipo:o.sgTpAnexoSigfe,obrigatorio:"S"===o.flObrigatorio,activo:"S"===o.flAtivo,links:[]};"RQ_CON_ING"===a.tipo&&a.links.push({name:"Download do Requerimento",url:"http://www.ucm.minfin.gov.ao:80/cs/groups/public/documents/document/zmlu/mdy0/~edisp/minfin064102.docx",target:"_blank"}),a.activo&&m.documentosObrigatorios.push(a)}})})},m.listarEstadoCivil=function(){s.getDominios("ESTADO_CIVIL",function(o){m.estadosCivis=o})},m.listarTiposDeCarta=function(){s.getDominios("CARTA_CONDUCAO",function(o){m.tiposCartaConducao=o})},m.listarCategorias=function(o){if(o){i.showProgressAlert("A Carregar...");var e={inCdCandidaturaCat:null,inCatSeq:null,ivTpCandidaturaCat:o,inCdFormacAcademica:"MINFIN"===n.portalConfig.portalDefault?null:m.solicitacao.inCdFormacAcademica,ivFlAtivo:"S"};t.comum("POST","/candidatura/listar-categorias",e,!1,function(o){o.data&&200===o.retorno.codigo?(i.closeProgressAlert(),m.categoriasCandidatura=o.data.lista):i.showMensagemRetorno(201,"Nenhuma categoria encontrada.")})}else m.categoriasCandidatura=[],m.solicitacao.ivTpCandidaturaCat=null,m.solicitacao.inCatSeq=null},m.listarFormacoesAcademicas=function(o){t.comum("POST","/candidatura/listar-formacao-academica",{inCdFormacAcademica:null,ivDsFormacAcademica:null,ivSgFormacAcademica:null,ivFlAtivo:null},!1,function(o){o.data&&(200===o.retorno.codigo?(i.closeProgressAlert(),m.formacoesAcademicas=o.data.lista):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem))})},m.listarOrgaos=function(o){var e={inCdOrgao:null,inIdVpd:null,ivSigla:null,inCdAno:parseInt(moment().format("YYYY")),paginaAtual:1,itensPorPagina:2e3,ordenacao:"1 DESC"};t.comum("POST","/candidatura/listar-orgao",e,!1,function(o){o.data?200===o.retorno.codigo?(i.closeProgressAlert(),m.orgaos=o.data.lista):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},m.esconderCusos=!1,m.listarCursos=function(){if(m.solicitacao.inCdFormacAcademica){var o={inCdFormacCurso:null,ivDsFormacCurso:null,ivSgFormacCurso:null,inCdFormacAcademica:m.solicitacao.inCdFormacAcademica,ivFlAtivo:null};m.cursos=[],m.solicitacao.inCdFormacCurso=null,t.comum("POST","/candidatura/listar-formacao-concurso",o,!1,function(o){o.data?200===o.retorno.codigo?(i.closeProgressAlert(),m.cursos=o.data.lista,m.esconderCusos=!1,m.cursoOutros=m.cursos.filter(function(o){return"OUTRO"===o.ivSgFormacCurso.toUpperCase()})[0].inCdFormacCurso):i.showMensagemRetorno(201,"Nenhum curso foi encontrado para o Grau Académico seleccionado!"):m.esconderCusos=!0})}else m.cursos=[]},m.getListaPais=function(){s.getListaPaises(function(o){m.cdPaisAngola=o.filter(function(o){return"ANGOLA"==o.ivNoPais.toUpperCase()})[0].inCdPais,m.listaPais=o})},m.getListaProvincias=function(){s.getListaProvincias(function(o){m.listaProvincia=o})},m.pesquisaNIF=function(){if(""!=m.solicitacao.nif&&null!=m.solicitacao.nif){m.ultimoNIFPesquisado=m.solicitacao.nif,m.isContribuinteLocalizado=!1,i.showProgressAlert("A Carregar...");var o={ivIdentificador:m.solicitacao.nif,ivTpConsulta:"RGC",ivTpPessoa:"NAC"};u.recuperarContribuinte(o,function(o){if(null!=o&&1==o.length)m.setContribuinteLocalizado(o[0]);else{var e={ivIdentificador:m.solicitacao.nif,ivTpConsulta:"RGC_BI"};u.recuperarContribuinte(e,function(o){null!=o&&1==o.length?m.setContribuinteLocalizado(o[0]):m.contribuinteNaoLocalizado()})}})}},m.setContribuinteLocalizado=function(o){m.isContribuinteLocalizado=!0;var e=o;m.solicitacao.ivNoContribuinte=e.noContribuinte,m.solicitacao.ivNuContribuinte=e.nuContribuinte,m.solicitacao.inCdRgc=e.cdRgc,m.solicitacao.ioCandidato.idDtNascimento=e.dtNascimento,m.solicitacao.ioCandidato.inCdProvinciaNaturalidade=e.cdProvinciaNaturalidade,m.solicitacao.ioCandidato.ivEsCivil=e.esCivil,m.solicitacao.ioCandidato.ivSexo=e.sexo,m.solicitacao.ioCandidato.ivNuBi="BI"===e.tpDocumento?e.nuDocumento:null,m.solicitacao.ioCandidato.ivNoPai=e.noPai,m.solicitacao.ioCandidato.ivNoMae=e.noMae,m.solicitacao.ioCandidato.inCdPaisNacionalidade=m.cdPaisAngola,i.closeProgressAlert()},m.contribuinteNaoLocalizado=function(){m.isContribuinteLocalizado=!1,i.showMensagemRetorno(400,g.instant("MSG_CONTRIBUINTE_NAO_LOCALIZADO")),m.solicitacao=angular.copy(m.solicitacaoOriginal)},m.filtrarPais=function(){if("E"==m.solicitacao.tipoPessoaOrigem)return m.cdPaisAngola},m.validaFicheirosObrigatorios=function(){var o=!1;return m.documentosObrigatorios.filter(function(o,e){var a=null;return m.solicitacao.ilAnexo[e]&&o.obrigatorio&&m.solicitacao.ilAnexo[e].inCdCandidaturaAnexo&&(a=o),a}).length===m.documentosObrigatorios.filter(function(o){return o.obrigatorio}).length&&(o=!0),o},m.salvarSolicitacao=function(o){if(o.$valid&&o.$submitted)if(m.validaFicheirosObrigatorios()){var e=angular.copy(m.solicitacao);e.ilAnexo=JSON.stringify(e.ilAnexo),e.inNuAnoInicioFormacao=parseInt(e.inNuAnoInicioFormacao),e.inNuAnoFimFormacao=parseInt(e.inNuAnoFimFormacao),e.inNuAnoFimFormacao=parseInt(e.inNuAnoFimFormacao),e.ioCandidato.idDtNascimento=e.ioCandidato.idDtNascimento?e.ioCandidato.idDtNascimento:"",e.ioCandidato.ivDsLocalEmissao=e.ioCandidato.ivDsLocalEmissao?e.ioCandidato.ivDsLocalEmissao:"",e.ioCandidato.ivEsCivil=e.ioCandidato.ivEsCivil?e.ioCandidato.ivEsCivil:"",e.ioCandidato.ivNoMae=e.ioCandidato.ivNoMae?e.ioCandidato.ivNoMae:"",e.ioCandidato.ivNoPai=e.ioCandidato.ivNoPai?e.ioCandidato.ivNoPai:"",e.ioCandidato.ivNuBi=e.ioCandidato.ivNuBi?e.ioCandidato.ivNuBi:"",e.ioCandidato.ivNuCartaConducao=e.ioCandidato.ivNuCartaConducao?e.ioCandidato.ivNuCartaConducao:"",e.ioCandidato.ivSexo=e.ioCandidato.ivSexo?e.ioCandidato.ivSexo:"",e.ioCandidato.ivTipoCartaConducao=e.ioCandidato.ivTipoCartaConducao?e.ioCandidato.ivTipoCartaConducao:"",e.ioCandidato=JSON.stringify(e.ioCandidato),i.confirmar(g.instant("MSG_CONFIRMACAO_INCLUSAO"),function(o){o&&l(function(){t.comum("POST","/candidatura/salvar",e,!0,function(o){o.data?200===o.retorno.codigo?(m.candidaturaView=o.data.lista[0],i.showMensagemRetorno(200,g.instant("CANDIDATURA_REALIZADA_COM_SUCESSO"),function(){l(function(){m.dataHoraDoRegisto=moment(o.dataHora,"DD-MM-YYYYTHH:mm:ss").format("DD/MM/YYYY HH:mm"),m.visualizarMensagemDeSucesso=!0},200)})):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},200)})}else i.showMensagemRetorno(201,g.instant("OS_ANEXOS_SAO_OBRIGATORIOS"))},m.investidorPrint=null,m.captchaSetResponse=function(o){m.gRecaptchaResponse=!!o},m.captchacbExpiration=function(){m.gRecaptchaResponse=!1},m.adicionarFicheiro=function(a){if(a.$valid&&m.ficheiroTemporario.ivAnexo){i.showProgressAlert("A Carregar...");var o={ilAnexo:JSON.stringify([m.ficheiroTemporario])};s.uploadFicheiroContentAnexo(o,function(o){i.closeProgressAlert();var e=o.id?o.id:null;m.ficheiroTemporario.inCdCandidaturaAnexo=e,m.ficheiroTemporario.ivAnexo=null,m.ficheiroTemporario.inCdTpAnexoSigfe=m.cdTpAnexoSigfeAtual,m.solicitacao.ilAnexo[m.indexAnexo]=m.ficheiroTemporario,l(function(){a.$setPristine(),m.ficheiroTemporario=angular.copy(m.anexoOriginal),angular.element(".progresso").width("0"),angular.element("form[name="+a.$name+"]")[0].reset(),$(".input-nome-ficheiro").html(""),c.mantemModal(".modal",!1)},200)})}},m.removerSeleccionado=function(){m.ficheiroTemporario=angular.copy(m.anexoOriginal)},m.preUpload=function(o){if(o&&o.target.files.length){var e={permitir:!0,tamanho:!0,maximo:!0},a=o.target.files[0];if(a.extensao=a.name.split(".")[a.name.split(".").length-1],m.extensoesPermitidas.indexOf(a.extensao.toLowerCase())<0&&(e.permitir=!1,i.showMensagemRetorno(400,g.instant("MSG_TIPO_FICHEIRO_INVALIDO"))),a.size>1048576*m.uploadLimite&&(e.tamanho=!1,i.showMensagemRetorno(400,g.instant("MSG_TAMANHO_FICHEIRO_INVALIDO"))),9<m.solicitacao.ilAnexo.length&&(e.maximo=!1,i.showMensagemRetorno(400,"Quantidade máxima de ficheiros obrigatórios excedida.")),e.permitir&&e.tamanho&&e.maximo){$(".input-nome-ficheiro").html(a.name);var t=new FileReader;t.readAsDataURL(a),t.onload=function(){m.ficheiroTemporario.ivNoFicheiro=o.target.value.replace(/^.*[\\\/]/,""),m.ficheiroTemporario.ivMimeType=a.type,m.ficheiroTemporario.ivAnexo=t.result.substr(t.result.indexOf(",")+1).replace(/ /g,""),m.ficheiroTemporario.inCdTpAnexoSigfe=m.cdTpAnexoSigfeAtual,i.closeProgressAlert()},t.onloadstart=function(){i.showProgressAlert("A Carregar...")},t.onloadend=function(){},t.onabort=function(){i.closeProgressAlert()}}}},m.excluirAnexo=function(t){i.confirmar(g.instant("MSG_CONFIRMA_EXCLUSAO_ANEXO"),function(o){o&&l(function(){var a=[];angular.forEach(m.solicitacao.ilAnexo,function(o,e){t!=e&&a.push(o)}),m.solicitacao.ilAnexo=a,i.showMensagemRetorno(200,g.instant("MSG_ANEXO_EXCLUIDO"))},200)})},m.validaAnoFormacao=function(){var o=parseInt(m.solicitacao.inNuAnoInicioFormacao),e=parseInt(m.solicitacao.inNuAnoFimFormacao);0<o&&0<e&&e<o&&i.showMensagemRetorno(201,"A data final não pode ser menor do que a inicial!",function(){l(function(){m.solicitacao.inNuAnoFimFormacao=null},200)})},m.downloadTest=function(){var o=new a(["Hey ho lets go!"],{type:"text/plain;charset=utf-8"});e.saveAs(o,"text.txt")}}]}),app.component("candidaturaConsultar",{templateUrl:"app/partials/candidatura-consultar.html",bindings:{label:"<",template:"<"},controller:["$scope","$ws","AlertaService","$location","$timeout","ComumServices","Utils","ContribuinteService","EnderecoService","$translate",function(o,a,t,e,n,i,r,l,s,c){var u=this;u.visualizarResultadoConsulta=!1,u.dataHoraDoRegisto=null,u.candidatura={ivDsStCandidaturaPublica:null,idDtCandidatura:null,ivNoContribuinte:null,inNuProtocolo:null},u.init=function(o){u.visualizarResultadoConsulta=!1,u.filter={tipoPesquisa:"N",nuProtocolo:null,paginaAtual:1,qtdPaginas:10}},u.consultarSolicitacao=function(o){if(o.$valid&&o.$submitted){t.showProgressAlert("A Carregar...");var e={inNuProtocolo:null,ivNuContribuinte:null};"P"===u.filter.tipoPesquisa?(e.inNuProtocolo=u.filter.nuProtocolo,e.ivNuContribuinte=null):(e.ivNuContribuinte=u.filter.nuProtocolo,e.inNuProtocolo=null),a.comum("POST","/candidatura/listar-publico",e,!1,function(o){o&&200===o.retorno.codigo&&o.data?(t.closeProgressAlert(),u.candidatura=o.data.lista[0],u.candidatura.idDtCandidatura=moment(o.data.lista[0].idDtCandidatura,"YYYY-MM-DD").format("DD/MM/YYYY"),n(function(){u.dataHoraDoRegisto=moment(o.dataHora,"DD-MM-YYYYTHH:mm:ss").format("DD/MM/YYYY HH:mm"),u.visualizarResultadoConsulta=!0},200)):t.showMensagemRetorno(201,"Nenhum registo encontrado!")})}},u.checarValor=function(){angular.isDefined(u.filter.nuProtocolo)&&(u.filter.nuProtocolo=u.filter.nuProtocolo.replace(/ /g,""),"P"===u.filter.tipoPesquisa&&(u.filter.nuProtocolo=u.filter.nuProtocolo.replace(/[^0-9]/g,"")))}}]}),app.component("candidaturaGerir",{templateUrl:"app/partials/candidatura-gerir.html",bindings:{tipo:"@",titulo:"@",url:"=",activo:"="},controller:["$rootScope","FileSaver","Blob","$timeout","$ws","RequestService","AlertaService","$translate","ComumService","ComumServices","StorageService",function(o,n,c,i,r,e,l,s,a,u,t){var d=this;d.utilizador=t.get("utilizadorLogado"),o.$on("broadcastUtilizadorReceiver",function(o,e){d.utilizador=t.get("utilizadorLogado")}),d.situacoesCandidaturas=[],d.reprovarView=!1,d.candidatura={ilAnexo:[],inCdCandidaturaPublica:null,inCdProvincia:null,inCdRgc:null,ivDsEndereco:null,ivDsStCandidaturaPublica:null,idDtCandidatura:null,ivTpCandidaturaCat:null,inCatSeq:null,ivEmail:null,inFupSeq:null,ivNoContribuinte:null,ivNuContribuinte:null,inNuProtocolo:null,ivStCandidaturaPublica:null,ivTelefone:null,ivDsMotivRejeicao:null,motivoReprovacao:null},d.paginaAtual=1,d.paginacaoQtdRegistros=10,d.paginacaoArray=[5,10,15,20],d.q="",d.filter={situacao:null,nuProtocolo:null,nif:null},this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerir",function(){d.paginarRegistos(),d.listarSituacoes()}),$(document).on("hidden.bs.modal","#modalGerirNovo",function(){d.exibirForm=!1}),$(document).on("show.bs.modal","#modalGerirNovo",function(){d.exibirForm=!0})},d.listarSituacoes=function(){u.getDominios("ST_CANDIDATURA_PUBLICA",function(o){d.situacoesCandidaturas=o})},d.alterarStatusCandidatura=function(o,e,a){a&&"REP"===e?a.$valid&&a.$submitted&&d.finalizarAnalise(o,e):"APROV"===e&&d.finalizarAnalise(o,e)},d.finalizarAnalise=function(a,t){l.confirmar(s.instant("TEM_CERTEZA_QUE_DESEJA_CONCLUIR"),function(o){if(o)if(a.inCdCandidaturaPublica&&t){var e={inCdCandidaturaPublica:a.inCdCandidaturaPublica,ivStCandidaturaPublica:t,ivDsMotivRejeicao:a.motivoReprovacao};r.comum("POST","/candidatura/atualizar-situacao",e,!0,function(o){o?200==o.retorno.codigo?l.showMensagemRetorno(200,"Operação Realizada Com Sucesso!",function(){$("#modalGerirNovo").modal("hide"),i(function(){$("#modalGerir").modal("show")},500)}):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}else l.showMensagemRetorno(800,"Parametros Inválidos")})},d.paginarRegistos=function(){var o={inNuProtocolo:d.filter.nuProtocolo,ivNuContribuinte:d.filter.nif,ivStCandidaturaPublica:d.filter.situacao,paginaAtual:d.paginaAtual,itensPorPagina:d.paginacaoQtdRegistros,ordenacao:"1 DESC"};r.comum("POST","/candidatura/listar",o,!0,function(o){o?200==o.retorno.codigo?(l.closeProgressAlert(),d.itensPaginados=o.data?o.data.lista:[],d.itensPaginados.map(function(o){o.ilAnexo=JSON.parse(o.ilAnexo)}),d.quantidadeTotalItens=0<parseInt(o.quantidadeTotalItens)?o.quantidadeTotalItens:d.itensPaginados.length,i(function(){$('[data-toggle="popover"]').popover()},200)):923!=o.retorno.codigo&&l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})},d.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(d.itensPaginados.quantidadeTotalItens/d.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}catch(o){}},d.setarPaginaAtual=function(o){d.paginaAtual=o,d.paginarRegistos()},d.setarRegistosPorPagina=function(o){d.paginacaoQtdRegistros=o.paginacaoQtdRegistros,d.paginarRegistos()},d.carregarRegistrosDestaques=function(o){d.exibirDestaques=o.exibirDestaques,d.paginarRegistos()},d.setObj=function(o){d.candidatura=angular.copy(o),d.candidatura.ioCandidato=JSON.parse(d.candidatura.ioCandidato),d.reprovarView=!1},d.downloadFicheiro=function(o,a,t){l.showProgressAlert("A Carregar..."),u.downloadAnexo(o,function(o){l.closeProgressAlert();var e=o.lista[0]?o.lista[0].ivAnexo:null;i(function(){d.downloadBlob(e,a,t)},300)})},d.downloadBlob=function(o,e,a){var t=d.b64toBlob(o,a);n.saveAs(t,e)},d.b64toBlob=function(o,e){for(var a=atob(o),t=[],n=0;n<a.length;n+=512){for(var i=a.slice(n,n+512),r=new Array(i.length),l=0;l<i.length;l++)r[l]=i.charCodeAt(l);var s=new Uint8Array(r);t.push(s)}return new c(t,{type:e})}}]}),app.component("candidaturaCategoria",{templateUrl:"app/partials/candidatura-categoria.html",bindings:{tipo:"@",titulo:"@",url:"=",activo:"="},controller:["$rootScope","$timeout","$ws","AlertaService","$translate","ComumService","ComumServices","StorageService",function(o,n,i,r,e,a,t,l){var s=this;s.utilizador=l.get("utilizadorLogado"),o.$on("broadcastUtilizadorReceiver",function(o,e){s.utilizador=l.get("utilizadorLogado")}),s.pesquisado=!1,s.categoria={ivCdCandidaturaCat:null,inCdCandidaturaCat:null,ivDsTpCandidaturaCat:null,inCatSeq:null,ivDsCarreira:null,ivDsCategoria:null},s.regimesCandidatura=[],s.paginaAtual=1,s.paginacaoQtdRegistros=10,s.paginacaoArray=[5,10,15,20],s.q="",s.filter={regime:null},this.$onChanges=function(o){$(document).on("shown.bs.modal","#modalGerirCategorias",function(){s.listarRegimes()})},s.listarRegimes=function(){t.getDominios("TP_CANDIDATURA_CAT",function(o){s.regimesCandidatura=o})},s.finalizarAnalise=function(a,t){r.confirmar(e.instant("TEM_CERTEZA_QUE_DESEJA_CONCLUIR"),function(o){if(o)if(a.ivCdCandidaturaPublica&&t){var e={ivCdCandidaturaPublica:a.ivCdCandidaturaPublica,ivStCandidaturaPublica:t,ivDsMotivoRejeicao:a.motivoReprovacao};i.comum("POST","/candidatura/atualizar-situacao",e,!0,function(o){o?200==o.retorno.codigo?r.showMensagemRetorno(200,"Operação Realizada Com Sucesso!",function(){$("#modalGerirNovo").modal("hide"),n(function(){$("#modalGerir").modal("show")},500)}):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})}else r.showMensagemRetorno(800,"Parametros Inválidos")})},s.paginarRegistos=function(o){if(o.$valid&&o.$submitted){var e={inCdCandidaturaCat:null,inCatSeq:null,ivTpCandidaturaCat:s.filter.regime,ivFlAtivo:null};i.comum("POST","/candidatura/listar-categorias",e,!0,function(o){o?200==o.retorno.codigo?(r.closeProgressAlert(),s.itensPaginados=o.data?o.data.lista:[],s.pesquisado=!0,s.quantidadeTotalItens=0<parseInt(o.quantidadeTotalItens)?o.quantidadeTotalItens:s.itensPaginados.length,n(function(){$('[data-toggle="popover"]').popover()},200)):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})}},s.numeroDePaginas=function(){try{for(var o=new Array(Math.ceil(s.itensPaginados.quantidadeTotalItens/s.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}catch(o){}},s.setarPaginaAtual=function(o){s.paginaAtual=o,s.paginarRegistos()},s.setarRegistosPorPagina=function(o){s.paginacaoQtdRegistros=o.paginacaoQtdRegistros,s.paginarRegistos()},s.carregarRegistrosDestaques=function(o){s.exibirDestaques=o.exibirDestaques,s.paginarRegistos()},s.toggleActivo=function(e){s.toggle(e),r.showProgressAlert("A Carregar..."),i.comum("PUT","/candidatura/categorias/"+e.inCdCandidaturaCat+"/ativar/"+e.ivFlAtivo,null,!1,function(o){o?200===o.retorno.codigo?(r.closeProgressAlert(),s.paginarRegistos()):(923!==o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),s.toggle(e)):(r.erroRede(),s.toggle(e))})},s.toggle=function(o){return"S"==o.ivFlAtivo?o.ivFlAtivo="N":"N"==o.ivFlAtivo&&(o.ivFlAtivo="S"),o}}]});var btn=$("#button-voltar-topo");$(window).scroll(function(){300<$(window).scrollTop()?btn.addClass("show"):btn.removeClass("show")}),btn.on("click",function(o){o.preventDefault(),$("html, body").animate({scrollTop:0},"300")}),app.component("bandeiraDetraducao",{templateUrl:"app/partials/bandeira-de-traducao.html",controller:["$translate","$translateLocalStorage","$scope","$rootScope","$timeout","$window","$state",function(e,o,a,t,n,i,r){this.traducao=function(o){e.use(o),n(function(){i.location.reload()},300)},a.init=function(){a.language=a.getLanguage()},a.switchLanguage=function(o){e.use(o),a.language=o,r.go("home"),n(function(){i.location.reload(!0),$ionicLoading.hide()},1e3)},a.getLanguage=function(){return o.get("NG_TRANSLATE_LANG_KEY")}}]}),app.component("gerirUtilizadores",{templateUrl:"app/partials/gerir-utilizadores.html",bindings:{label:"<",template:"<"},controller:["$rootScope","$timeout","$scope","RequestService","StorageService","AlertaService","UtilizadorService","Utils",function(o,e,t,a,n,i,r,l){var s=this;t.pr={closed:!1},o.$on("broadcastUtilizadorReceiver",function(o,e){s.initUtilizador(!0)}),this.$onInit=function(o){s.initUtilizador(!1)},s.initUtilizador=function(o){s.utilizador=n.get("utilizadorLogado"),s.administrador=!1,s.gestor=!1,s.publicador=!1,s.redator=!1,s.revisor=!1,s.editor=!1,s.utilizador&&(s.administrador=l.validaPermissao("administrador",s.utilizador.grupos),s.gestor=l.validaPermissao("gestor",s.utilizador.grupos),s.publicador=l.validaPermissao("publicador",s.utilizador.grupos),s.redator=l.validaPermissao("redator",s.utilizador.grupos),s.revisor=l.validaPermissao("revisor",s.utilizador.grupos),s.editor=l.validaPermissao("editor",s.utilizador.grupos),o&&s.init(null,s.utilizador.gestor))},s.init=function(o,e){o&&o.$setPristine(),s.publicacaoPesquisar={portal:a.portalConfig.portalAPI,data:{noGapUtilizador:null,paginaAtual:1,qtdPaginas:10,flAtivo:null,paginacaoArray:[5,10,15,20],quantidadeTotalItens:0}},s.itensPaginados=null,e&&s.pesquisarUtilizadores(!1),s.pefisList=[],a.request("GET","/gestao-utilizador/perfis?portal="+a.portalConfig.portalAPI,!1,!0,function(o){o?200==o.retorno.codigo?t.perfis=o.data:i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},t.GetValue=function(){t.perfisList=[];for(var o=0;o<t.perfis.length;o++)if(t.perfis[o].Selected){var e=t.perfis[o].noGapPerfil;t.perfisList.push(e)}return t.perfisList},t.GetValueUnchecked=function(a){t.perfisCadastrado.forEach(function(o){if(a==o){var e=t.perfisCadastrado.indexOf(o);t.perfisCadastrado.splice(e,1)}else t.GetValue()})},s.formPublicacaoPesquisarSubmit=function(o){o.$valid&&(s.publicacaoPesquisar.paginaAtual=1,e(function(){s.pesquisarUtilizadores()}))},s.alterarStatusUser=function(o){"S"==o.flAtivo?a.request("GET","/gestao-utilizador/inativar/"+a.portalConfig.portalAPI+"/"+o.userName,null,!0,function(o){o?200==o.retorno.codigo?(i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),s.pesquisarUtilizadores()):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()}):a.request("GET","/gestao-utilizador/ativar/"+a.portalConfig.portalAPI+"/"+o.userName,null,!0,function(o){o?200==o.retorno.codigo?(i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),s.pesquisarUtilizadores()):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},s.pesquisarUtilizadores=function(){s.publicacaoPesquisar.quantidadeTotalItens=0,a.request("POST","/gestao-utilizador/utilizadores",s.publicacaoPesquisar,!1,function(o){o?200==o.retorno.codigo?(s.itensPaginados=o,s.publicacaoPesquisar.quantidadeTotalItens=s.itensPaginados.quantidadeTotalItens,i.closeProgressAlert()):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},s.setObj=function(o){o&&o.$setPristine(),s.dataJson={portal:a.portalConfig.portalAPI,data:{email:null,noGapUtilizador:null,perfis:null}}},s.dataJson={portal:a.portalConfig.portalAPI,data:{email:null,noGapUtilizador:null,perfis:null}},s.salvarUtilizador=function(o){t.GetValue().forEach(function(o){t.perfisCadastrado.push(o)}),s.dataJson.data.perfis=t.GetValue(),o.$valid&&o.$submitted&&(s.dataJson.data.cdGapUtilizador?(t.GetValue().forEach(function(o){t.perfisCadastrado.push(o)}),s.dataJsonUpdateUser={portal:a.portalConfig.portalAPI,data:{cdGapUtilizador:s.dataJson.data.cdGapUtilizador,noGapUtilizador:s.dataJson.data.noGapUtilizador,perfis:t.perfisCadastrado}},a.request("POST","/gestao-utilizador/atualizar",s.dataJsonUpdateUser,!0,function(o){o?200==o.retorno.codigo?i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){}):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})):a.request("POST","/gestao-utilizador/novo",s.dataJson,!0,function(o){o?200==o.retorno.codigo?i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem,function(){s.pesquisarUtilizadores()}):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()}))},t.perfisCadastrado=[],s.editar=function(e,o){o&&o.$setPristine(),a.request("GET","/gestao-utilizador/utilizadores?cdGapUtilizador="+e.cdGapUtilizador,null,!0,function(o){o?200==o.retorno.codigo?(i.closeProgressAlert(),s.dataJson={data:o.data},e.perfis=s.dataJson.data.perfis,e.perfis.forEach(function(o){t.perfisCadastrado.push(o)})):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},s.dataJsonUser={portal:a.portalConfig.portalAPI,data:{userName:null}},s.redefinirSenha=function(o){i.confirmar("Deseja Redefinir palavra-passe deste Utilizador ?",function(o){o&&a.request("POST","/gestao-utilizador/resetasenha",s.dataJsonUser,!0,function(o){o?200==o.retorno.codigo?i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):923!=o.retorno.codigo&&i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})})}}]}),app.controller("homeController",["$rootScope","$scope","$window","$timeout","$state","RequestService","AlertaService","$location","$ws","MenuService","GraficosService",function(e,t,o,a,n,i,r,l,s,c,u){e.$on("broadcastHomeReceiver",function(o,e){"home"==n.current.name&&a(function(){t.init()},1e3)}),t.init=function(){t.menuEspecial=e.getState("menu-especial"),t.tituloMenuMateriasRealce=c.tituloMenu("materias-de-realce"),t.menuMateriasRealce=c.menu("materias-de-realce"),t.tituloPortaisDeServicos=c.tituloMenu("portais-servicos"),t.menuPortaisDeServicos=c.menu("portais-servicos"),t.tituloMenuEconomiaNacional=c.tituloMenu("economia-nacional"),t.menuEconomiaNacional=c.menu("economia-nacional"),t.tituloMenuServicosPublicos=c.tituloMenu("servicos-publicos"),t.menuServicosPublicos=c.menu("servicos-publicos"),t.tituloMenuFinancasPublicas=c.tituloMenu("financas-publicas"),t.menuFinancasPublicas=c.menu("financas-publicas"),t.tituloMenuOrganismosTutelados=c.tituloMenu("sobre-o-minfin.organismos-tutelados"),t.menuOrganismosTutelados=c.menu("sobre-o-minfin.organismos-tutelados"),t.tituloMenuServicosDeApoioTecnico=c.tituloMenu("sobre-o-minfin.servicos-de-apoio-tecnico"),t.menuServicosDeApoioTecnico=c.menu("sobre-o-minfin.servicos-de-apoio-tecnico"),t.tituloMenuServicosExecutivosCentrais=c.tituloMenu("sobre-o-minfin.servicos-executivos-centrais"),t.menuServicosExecutivosCentrais=c.menu("sobre-o-minfin.servicos-executivos-centrais"),t.tituloMenuSalaDeImprensa=c.tituloMenu("sala-de-imprensa"),t.menuSalaDeImprensa=c.menu("sala-de-imprensa");var o={portal:i.portalConfig.portalAPI,flDestaque:"S",tipo:{dominio:"TP_PUBLICACAO",sigla:"NOT"},status:"PUB",titulo:null,todos:!1,paginaAtual:1,qtdPaginas:5};i.request("POST","/publicacao/listarPublico",o,null,function(o){if(o&&200==o.retorno.codigo){t.noticiasRecentes=o.data;var a=[];t.noticiasRecentes.forEach(function(o,e){a.push(o.cdPublicacao)});var e={portal:i.portalConfig.portalAPI,flDestaque:null,tipo:{dominio:"TP_PUBLICACAO",sigla:"NOT"},removeCdPublicacao:a,status:"PUB",titulo:null,todos:!0,paginaAtual:1,qtdPaginas:10};i.request("POST","/publicacao/listarPublico",e,null,function(o){o&&200==o.retorno.codigo&&(t.maisNoticias=o.data)})}}),i.request("GET","/linksUteis/listar/"+i.portalConfig.portalAPI+"/LK/S/1/100",null,null,function(o){o&&200==o.retorno.codigo&&(t.linksUteis=o.data.filter(function(o){if(o.flStatusPublicacao)return"PUB"===o.flStatusPublicacao.sigla?o:null}))}),i.request("GET","/taxaCambio/listar/"+moment().format("YYYY-MM-DD"),null,null,function(o){o&&200==o.retorno.codigo&&(t.cotacoes=o.data)}),i.request("GET","/linksUteis/listar/"+i.portalConfig.portalAPI+"/BAN/S/1/100",null,null,function(o){o&&200==o.retorno.codigo&&(t.bannersMinfin=o.data.filter(function(o){if("PUB"===o.flStatusPublicacao.sigla)return o}),t.bannersMinfin.map(function(o){t.getUrl(o.url)}))}),i.request("GET","/evento/listar/"+i.portalConfig.portalAPI+"/S/1/4",null,null,function(o){o&&200==o.retorno.codigo&&(t.proximosEventos=o.data)}),i.request("GET","/linksUteis/listar/"+i.portalConfig.portalAPI+"/INFO/S/1/5",null,null,function(o){o&&200==o.retorno.codigo&&(t.informativos=o.data)});o={portal:i.portalConfig.portalAPI,data:{tpPergunta:{sigla:"ANY",descricao:"ANY",detalhe:"NENHUM TIPO DE PERGUNTA",dominio:"TP_PERGUNTA_PORTAL"}}};i.request("POST","/perguntasFrequentes/listar",o,null,function(o){o&&200==o.retorno.codigo&&(t.perguntasFrequentes=o.data)});o={portal:i.portalConfig.portalAPI,data:{paginaAtual:1,itensPorPagina:6,templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:"GUIA",descricao:"GUIA",detalhe:"Formulário",dominio:"TP_FORMULARIO"}}}};i.request("POST","/formulario/listar",o,null,function(o){o&&200==o.retorno.codigo&&(t.guias=o.data,angular.forEach(t.guias,function(o,e){angular.forEach(o.anexoPortalList,function(o,e){var a=[];angular.forEach(o.anexoPortalItemList,function(o,e){0<=o.nome.indexOf("_CAPA_")?a[1]=o:a[0]=o}),o.anexoPortalItemList=a})}))}),u.buscarGraficosPath(function(o){o&&(t.graficos=o.data)})},t.getUrl=function(a){if(1===a.split("/").length){var o=[];o.push(a),i.comum("POST","/privado/content/dados",o,!1,function(o){var e=o.data?o.data[0].ivUrl:"#";t.bannersMinfin.map(function(o){o.url===a&&(o.url=e)})})}},t.painelDeInformacaoChartReady=function(o){o},t.painelDeInformacaoChart={items:1,lazyLoad:!0,loop:!1,margin:10,dots:!0,nav:!1,autoplay:!1,autoplayTimeout:5e3,autoplayHoverPause:!0,navText:["<i class='glyphicon glyphicon-chevron-left'></i>","<i class='glyphicon glyphicon-chevron-right'></i>"],responsiveClass:!0,responsive:{0:{items:1},300:{items:1},600:{items:1},1000:{items:1}}},t.getGrafico=function(o,e,a,t){u.getGrafico(o,e,a,t)}}]),app.controller("homeIdiomasController",["$rootScope","$scope","$window","$timeout","$state","RequestService","MenuService",function(o,t,e,a,n,i,r){o.$on("broadcastHomeReceiver",function(o,e){"home"==n.current.name&&a(function(){t.init()},1e3)}),t.init=function(){t.tituloSobreOMinfin=r.tituloMenu("sobre-o-minfin"),t.menuSobreOMinfin=r.menu("sobre-o-minfin"),t.tituloUltimasPublicacoes=r.tituloMenu("ultimas-publicacoes"),t.menuUltimasPublicacoes=r.menu("ultimas-publicacoes"),t.tituloMenuEconomiaNacional=r.tituloMenu("economia-nacional"),t.menuEconomiaNacional=r.menu("economia-nacional"),t.tituloMenuFinancasPublicas=r.tituloMenu("financas-publicas"),t.menuFinancasPublicas=r.menu("financas-publicas"),t.tituloMenuInformacoesEconomicas=r.tituloMenu("informacoes-economicas"),t.menuInformacoesEconomicas=r.menu("informacoes-economicas");var o={portal:i.portalConfig.portalAPI,flDestaque:"S",tipo:{dominio:"TP_PUBLICACAO",sigla:"NOT"},status:"PUB",titulo:null,todos:!1,paginaAtual:1,qtdPaginas:5};i.request("POST","/publicacao/listarPublico",o,null,function(o){if(o&&200==o.retorno.codigo){t.noticiasRecentes=o.data;var a=[];t.noticiasRecentes.forEach(function(o,e){a.push(o.cdPublicacao)});var e={portal:i.portalConfig.portalAPI,flDestaque:null,tipo:{dominio:"TP_PUBLICACAO",sigla:"NOT"},removeCdPublicacao:a,status:"PUB",titulo:null,todos:!0,paginaAtual:1,qtdPaginas:10};i.request("POST","/publicacao/listarPublico",e,null,function(o){o&&200==o.retorno.codigo&&(t.maisNoticias=o.data)}),i.request("GET","/linksUteis/listar/"+i.portalConfig.portalAPI+"/BAN/S/1/100",null,null,function(o){o&&200==o.retorno.codigo&&(t.bannersMinfin=o.data,t.bannersMinfin.map(function(o){t.getUrl(o.url)}))})}})},t.getUrl=function(a){if(1===a.split("/").length){var o=[];o.push(a),i.comum("POST","/privado/content/dados",o,!1,function(o){var e=o.data?o.data[0].ivUrl:"#";t.bannersMinfin.map(function(o){o.url===a&&(o.url=e)})})}}}]),app.controller("defaultInternaController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","StorageService",function(o,a,e,t,n,i,r,l){a.utilizador=l.get("utilizadorLogado"),o.$on("broadcastHomeReceiver",function(o,e){n(function(){a.init()},1e3)}),a.produtosDestaqueItens=[],a.pagina={},a.menuAtual=e.current,a.exibirPagina=!1;var s=new RegExp(/[.]/g);a.statePaths=s.test(a.menuAtual.name),a.init=function(){a.menuAtual.cdMenu&&i.request("GET","/menu/buscarConteudoHtml/"+a.menuAtual.cdMenu,null,!1,function(o){a.exibirPagina=!0,o?200==o.retorno.codigo&&(a.pagina=o.data):r.erroRede()})}}]),app.controller("UtilizadorController",["$rootScope","$scope","$state","$timeout","RequestService","AlertaService","StorageService","UtilizadorService","Alertas","$ws","$translate","$translateLocalStorage",function(o,a,e,t,n,i,r,l,s,c,u,d){a.utilizador=r.get("utilizadorLogado"),o.$on("broadcastUtilizadorReceiver",function(o,e){a.utilizador=r.get("utilizadorLogado")}),a.login=function(e){if(e.$valid&&e.$submitted){var o={portal:n.portalConfig.portalAPI,data:{login:e.$$element[0].formLoginUtilizador.value,"palavra-passe":e.$$element[0].formLoginPalavraPasse.value}};l.login(e,o,function(o){o?200==o.retorno.codigo?($(".popover").popover().hide(),e.$$element[0].reset(),o.data.trocarPalavraPasse?i.closeProgressAlert(function(){$("#modalAlterarPalavraPasse").modal("toggle")}):(i.closeProgressAlert(function(){a.setLogin(o)}),a.setLogin(o))):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})}},a.loginModal=function(o){if(o.$valid&&o.$submitted){var e={portal:n.portalConfig.portalAPI,data:{login:o.$$element[0].formLoginUtilizador.value,"palavra-passe":o.$$element[0].formLoginPalavraPasse.value}};l.login(o,e,function(o){o?200==o.retorno.codigo?i.closeProgressAlert(function(){$("#modalLogin").modal("toggle"),a.setLogin(o)}):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})}},a.setLogin=function(o){l.setCookies(o)},a.logout=function(){i.confirmar(u.instant("CONFIRMA_SAIR"),function(o){o&&l.logout(function(o){o?200==o.retorno.codigo?a.utilizador=null:i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})})},a.recuperarPalavraPasse=function(e){if(e.$valid&&e.$submitted){var o={portal:n.portalConfig.portalAPI,data:{login:e.$$element[0].formRecuperarPalavraPasseUtilizador.value}};n.request("POST","/acesso/recuperarPalavraPasse",o,!0,function(o){o?200==o.retorno.codigo?(i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),e.$$element[0].reset(),angular.element(".close").trigger("click")):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})}},a.alterarPalavraPasse=function(e){if(e.$valid&&e.$submitted){var o={portal:n.portalConfig.portalAPI,data:{palavraPasseAtual:e.$$element[0].palavraPasseAtual.value,palavraPasseNova:e.$$element[0].palavraPasseNova.value,confirmarPalavraPasseNova:e.$$element[0].confirmarPalavraPasseNova.value}};n.request("POST","/acesso/alterarPalavraPasse",o,!0,function(o){o?200==o.retorno.codigo?(i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem),e.$$element[0].reset(),angular.element(".close").trigger("click")):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})}},a.fecharPopOver=function(){t(function(){angular.element("#exibirPopOverLogin").trigger("click")},500)},a.focarInput=function(){t(function(){angular.element(".popover.in").find("input").first().focus()},500)},a.switchLanguage=function(o){u.use(o),a.init=o,e.go("home"),t(function(){$window.location.reload(!0),$ionicLoading.hide()},1e3)},a.init=function(){return a.idiomas=u.getAvailableLanguageKeys(),a.idiomaAtual=d.get("NG_TRANSLATE_LANG_KEY"),a.idiomaAtual},a.labelIdioma=function(o){var e=o;switch(o.toUpperCase()){case"PT":e="AO"}return e}}]),app.controller("perguntasFrequentesController",["$rootScope","$scope","$state","$stateParams","$location","$anchorScroll","$timeout","RequestService","AlertaService",function(o,a,e,t,n,i,r,l,s){o.$on("broadcastHomeReceiver",function(o,e){r(function(){a.init()},1e3)}),a.pagina={},a.init=function(){a.menuAtual=e.current,a.cdPerguntaFrequente=t.cdPerguntaFrequente,a.sigla=e.current.sigla,a.anexos=e.current.anexos,a.label=e.current.ncyBreadcrumb.label;var o={portal:l.portalConfig.portalAPI,data:{tpPergunta:{sigla:a.sigla,descricao:a.sigla,detalhe:"NENHUM TIPO DE PERGUNTA",dominio:"TP_PERGUNTA_PORTAL"}}};l.request("POST","/perguntasFrequentes/listar",o,null,function(o){200==o.retorno.codigo?(a.perguntasFrequentes=o.data,a.cdPerguntaFrequente&&r(function(){n.hash("pergunta-"+a.cdPerguntaFrequente),i()},200)):s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem)}),a.menuAtual.cdMenu&&l.request("GET","/menu/buscarConteudoHtml/"+a.menuAtual.cdMenu,null,!1,function(o){o?200==o.retorno.codigo&&(a.pagina=o.data):s.erroRede()})}}]),app.controller("publicacoesController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService",function(o,a,t,e,n,i,r){o.$on("broadcastHomeReceiver",function(o,e){"sala-de-imprensa.noticias"!=t.current.name&&"sala-de-imprensa.artigos"!=t.current.name||n(function(){a.init()},1e3),"sala-de-imprensa.noticias.cdPublicacao"!=t.current.name&&"sala-de-imprensa.artigos.cdPublicacao"!=t.current.name||n(function(){a.noticiaCdPublicacao()},1e3)}),this.$onInit=function(){a.pagina={},a.menuAtual=t.current},a.init=function(){a.pagina.anexoPortalList=[],a.paginaAtual=1,a.paginacaoQtdRegistros=9,a.paginarRegistos(),a.menuAtual.cdMenu&&i.request("GET","/menu/buscarConteudoHtml/"+a.menuAtual.cdMenu,null,!0,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(a.pagina=o.data)):r.erroRede()})},a.noticiaCdPublicacao=function(){e.cdPublicacao&&i.request("GET","/publicacao/buscar/"+e.cdPublicacao,null,!1,function(o){o?200==o.retorno.codigo?(r.closeProgressAlert(),a.noticia=o.data,t.current.ncyBreadcrumb.label=a.noticia.titulo):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},a.paginarRegistos=function(o){o=!!o;var e={portal:i.portalConfig.portalAPI,flDestaque:null,tipo:{sigla:t.current.publicacao.template.sigla,dominio:t.current.publicacao.template.dominio},status:"PUB",titulo:null,todos:!0,paginaAtual:a.paginaAtual,qtdPaginas:a.paginacaoQtdRegistros};i.request("POST","/publicacao/listarPublico",e,o,function(o){o?200==o.retorno.codigo?(a.itensPaginados=o,r.closeProgressAlert()):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})}}]),app.controller("videosController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService",function(o,t,a,e,n,i,r){o.$on("broadcastHomeReceiver",function(o,e){"sala-de-imprensa.videos"==a.current.name&&n(function(){t.init()},1e3)}),t.paginaAtual=1,t.paginacaoQtdRegistros=8,t.paginacaoArray=[8,16,32],t.pagina={},t.init=function(){t.menuAtual=a.current,t.pagina.anexoPortalList=[],i.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!0,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(t.pagina=o.data)):r.erroRede()}),t.paginarRegistos()},t.pagina={},t.videoCdPublicacao=function(){t.cdPublicacao=e.cdPublicacao,i.request("GET","/video/buscar/"+t.cdPublicacao,null,!0,function(o){o?200==o.retorno.codigo?(r.closeProgressAlert(),t.video=o.data,a.current.ncyBreadcrumb={label:t.video.titulo}):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},t.paginarRegistos=function(o){o=!!o,i.request("GET","/video/listar/"+i.portalConfig.portalAPI+"/"+t.paginaAtual+"/"+t.paginacaoQtdRegistros,null,o,function(o){o?200==o.retorno.codigo?(t.itensPaginados=o,r.closeProgressAlert()):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},t.numeroDePaginas=function(){if(angular.isDefined(t.itensPaginados)&&angular.isDefined(t.itensPaginados.quantidadeTotalItens)){for(var o=new Array(Math.ceil(t.itensPaginados.quantidadeTotalItens/t.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}},t.setarPaginaAtual=function(o){t.paginaAtual=o,t.paginarRegistos(!0)},t.setarRegistosPorPagina=function(o,e){e&&(t.paginaAtual=1),t.paginacaoQtdRegistros=o.paginacaoQtdRegistros,t.paginarRegistos(!0)}}]),app.controller("fotosController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService",function(o,a,t,e,n,i,r){o.$on("broadcastHomeReceiver",function(o,e){"sala-de-imprensa.galerias"==t.current.name&&n(function(){a.init()},1e3),"sala-de-imprensa.galerias.cdPublicacao"==t.current.name&&n(function(){a.fotosCdPublicacao()},1e3)}),a.pagina={},a.totalDePaginas=0,a.paginaAtual=1,a.qtdPaginas=5,a.init=function(){a.menuAtual=t.current;var o={portal:i.portalConfig.portalAPI,data:{flDestaque:"N",paginaAtual:a.paginaAtual,qtdPaginas:a.qtdPaginas}};i.request("POST","/noticia/galeria/listar/",o,!1,function(o){o?200==o.retorno.codigo?(a.itensPaginados=o.data,a.totalDePagina=o.quantidadeTotalItens,r.closeProgressAlert()):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()}),a.pagina.anexoPortalList=[],i.request("GET","/menu/buscarConteudoHtml/"+a.menuAtual.cdMenu,null,!0,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(a.pagina=o.data)):r.erroRede()})},a.various6={padding:0,autoScale:!0,transitionIn:"fade",transitionOut:"fade",enableEscapeButton:!0,overlayColor:"#000",centerOnScroll:!0,showCloseButton:!0,showNavArrows:!0},a.Paginar=function(){a.pagina={},a.pagina.anexoPortalList=[];var o={portal:i.portalConfig.portalAPI,data:{flDestaque:"N",paginaAtual:a.paginaAtual,qtdPaginas:a.qtdPaginas}};i.request("POST","/noticia/galeria/listar/",o,!1,function(o){o?200==o.retorno.codigo?(a.itensPaginados=o.data,a.totalDePagina=o.quantidadeTotalItens,r.closeProgressAlert()):923!=o.retorno.codigo&&r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()}),a.menuAtual.cdMenu&&i.request("GET","/menu/buscarConteudoHtml/"+a.menuAtual.cdMenu,null,!1,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(a.pagina=o.data)):r.erroRede()})},a.retornaDivisao=function(o,e){if(angular.isDefined(o)&&angular.isDefined(e))return Math.ceil(o/e)},a.next=function(){a.paginaAtual<a.retornaDivisao(a.totalDePagina,a.qtdPaginas)&&(a.paginaAtual=a.paginaAtual+1,a.Paginar())},a.last=function(){a.paginaAtual!=a.retornaDivisao(a.totalDePagina,a.qtdPaginas)&&(a.paginaAtual=a.retornaDivisao(a.totalDePagina,a.qtdPaginas),a.Paginar())},a.previous=function(){2<=a.paginaAtual&&(a.paginaAtual--,a.Paginar())},a.numeroPagina=function(o){for(var e=[],a=1;a<=o;a++)e.push(a);return e},a.PAGINACAO_setPage=function(o){a.paginaAtual=o,a.Paginar()},a.PAGINACAO_first=function(){a.paginaAtual=1,a.Paginar()},a.fotosCdPublicacao=function(){a.cdPublicacao=e.cdPublicacao;var o={portal:i.portalConfig.portalAPI,data:{flDestaque:"N"}};i.request("POST","/noticia/galeria/listar/",o,!0,function(o){o?200==o.retorno.codigo?(t.current.ncyBreadcrumb={label:o.data[0].descricaoGaleria},r.closeProgressAlert(),angular.forEach(o.data,function(o){o.cdPublicacao==a.cdPublicacao&&(a.galeria=o)})):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})}}]),app.controller("eventosController",["$rootScope","$scope","$state","$stateParams","RequestService","AlertaService","$timeout",function(o,t,a,e,n,i,r){o.$on("broadcastHomeReceiver",function(o,e){"sala-de-imprensa.eventos"==a.current.name&&r(function(){t.init()},1e3)}),t.paginaAtual=1,t.paginacaoQtdRegistros=9,t.paginacaoArray=[9,18,36],t.pagina={},t.init=function(){t.menuAtual=a.current,t.pagina.anexoPortalList=[],n.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!0,function(o){o?(i.closeProgressAlert(),200==o.retorno.codigo&&(t.pagina=o.data)):i.erroRede()}),t.paginarRegistos()},t.eventoCdPublicacao=function(){t.cdPublicacao=e.cdPublicacao,n.request("GET","/evento/buscar/"+t.cdPublicacao,null,!1,function(o){o?200==o.retorno.codigo?(i.closeProgressAlert(),t.evento=o.data):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},t.paginarRegistos=function(o){o=!!o,n.request("GET","/evento/listar/"+n.portalConfig.portalAPI+"/T/"+t.paginaAtual+"/"+t.paginacaoQtdRegistros,null,o,function(o){o?200==o.retorno.codigo?(t.itensPaginados=o,i.closeProgressAlert()):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},t.numeroDePaginas=function(){if(angular.isDefined(t.itensPaginados)&&angular.isDefined(t.itensPaginados.quantidadeTotalItens)){for(var o=new Array(Math.ceil(t.itensPaginados.quantidadeTotalItens/t.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}},t.setarPaginaAtual=function(o){t.paginaAtual=o,t.paginarRegistos(!0)},t.setarRegistosPorPagina=function(o,e){e&&(t.paginaAtual=1),t.paginacaoQtdRegistros=o.paginacaoQtdRegistros,t.paginarRegistos(!0)},t.verificaEncerramento=function(o){var e=moment();return moment(o,"DD-MM-YYYY HH:mm")<e}}]),app.controller("informativosController",["$rootScope","$scope","$state","$stateParams","RequestService","AlertaService","$timeout",function(o,t,a,e,n,i,r){o.$on("broadcastHomeReceiver",function(o,e){"sala-de-imprensa.informativos"==a.current.name&&r(function(){t.init()},1e3)}),t.paginaAtual=1,t.paginacaoQtdRegistros=9,t.paginacaoArray=[9,18,36],t.pagina={},t.init=function(){t.menuAtual=a.current,t.pagina.anexoPortalList=[],n.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!0,function(o){o?(i.closeProgressAlert(),200==o.retorno.codigo&&(t.pagina=o.data)):i.erroRede()}),t.paginarRegistos()},t.paginarRegistos=function(o){o=!!o,n.request("GET","/linksUteis/listar/"+n.portalConfig.portalAPI+"/INFO/S/"+t.paginaAtual+"/"+t.paginacaoQtdRegistros,null,o,function(o){o?200==o.retorno.codigo?(t.informativos=o,t.itensPaginados=o,i.closeProgressAlert()):i.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):i.erroRede()})},t.numeroDePaginas=function(){if(angular.isDefined(t.itensPaginados)&&angular.isDefined(t.itensPaginados.quantidadeTotalItens)){for(var o=new Array(Math.ceil(t.itensPaginados.quantidadeTotalItens/t.paginacaoQtdRegistros)),e=[],a=0;a<o.length;a++)e.push(a);return e}},t.setarPaginaAtual=function(o){t.paginaAtual=o,t.paginarRegistos(!0)},t.setarRegistosPorPagina=function(o,e){e&&(t.paginaAtual=1),t.paginacaoQtdRegistros=o.paginacaoQtdRegistros,t.paginarRegistos(!0)},t.verificaEncerramento=function(o){var e=moment();return moment(o,"DD-MM-YYYY HH:mm")<e}}]),app.controller("calendarizacaoController",["$scope","RequestService","AlertaService",function(i,r,l){i.init=function(o,e,a){var t=moment().range(o,e),n=moment(o).add(parseInt(t.diff("d")/2),"days");r.request("GET","/calendarioFiscal/listar/periodo/"+r.portalConfig.portalAPI+"/"+n.format("M")+"/"+n.format("Y"),null,null,function(o){o?200==o.retorno.codigo?(i.eventos=o.data,a&&a(o.data)):l.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):l.erroRede()})}}]),app.controller("contactoController",["$rootScope","$scope","RequestService","AlertaService","vcRecaptchaService","Alertas","$timeout","$location",function(e,a,t,n,o,i,r,l){a.dataJsonOriginal={portal:t.portalConfig.portalAPI,data:{nome:null,email:null,telemovel:null,assunto:null,mensagem:null}},a.init=function(){a.gRecaptchaResponse=!1,a.dataJson=angular.copy(a.dataJsonOriginal),t.request("GET","/contacto/email/listarAssuntos/"+t.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&(a.listarAssuntos=o.data):n.erroRede()})},a.contactoEnviar=function(o){o.$submitted&&o.$valid&&a.gRecaptchaResponse&&t.request("POST","/contacto/email/enviar",a.dataJson,!0,function(o){o?200==o.retorno.codigo?i.aviso("success",e.const.TITLE_SUCESSO,o.retorno.mensagem,function(){r(function(){l.path("/")},400)}):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},a.captchaSetResponse=function(o){a.gRecaptchaResponse=!!o},a.captchacbExpiration=function(){a.gRecaptchaResponse=!1}}]),app.controller("formulariosController",["$rootScope","$scope","$state","$timeout","RequestService","AlertaService",function(o,a,e,t,n,i){o.$on("broadcastHomeReceiver",function(o,e){t(function(){a.init()},1e3)}),a.pagina={},a.init=function(){a.menuAtual=e.current,a.label=e.current.ncyBreadcrumb.label,a.sigla=e.current.sigla;var o={portal:n.portalConfig.portalAPI,data:{paginaAtual:1,itensPorPagina:1e3,templatePublicacao:{cdTemplatePublicacao:38,dsTemplate:null,flAtivo:"S",noTemplate:"TP_FORMULARIO",token:null,cgRefCodes:{sigla:a.sigla,descricao:a.sigla,detalhe:"Formulário",dominio:"TP_FORMULARIO"}}}};n.request("POST","/formulario/listar",o,null,function(o){o?200==o.retorno.codigo&&(a.formularios=o.data):i.erroRede()}),n.request("GET","/menu/buscarConteudoHtml/"+a.menuAtual.cdMenu,null,!0,function(o){o?(i.closeProgressAlert(),200==o.retorno.codigo&&(a.pagina=o.data)):i.erroRede()})}}]),app.controller("mapaDoSiteController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","fancyboxService",function(o,e,a,t,n,i,r){}]),app.controller("graficosController",["$scope","$stateParams","$timeout","AlertaService","GraficosService","$ws","$window",function(a,o,e,t,n,i,r){a.init=function(){var e=o.id;a.graficoSelecionado=null,n.buscarGraficosPath(function(o){o?(a.graficos=o.data,e?angular.forEach(a.graficos,function(o){o.id==e&&(a.graficoSelecionado=o,a.getGraficoSelect())}):(a.graficoSelecionado=a.graficos[0],a.getGraficoSelect())):t.erroRede()})},a.getGraficoSelect=function(){a.getGrafico(a.graficoSelecionado.path,"1",a.graficoSelecionado.nome,a.graficoSelecionado.tipo)},a.getGrafico=function(o,e,a,t){n.getGrafico(o,e,a,t)}}]),app.controller("estatisticasController",["$scope","$state","StorageService",function(o,e,a){o.init=function(){o.utilizador=a.get("utilizadorLogado"),o.utilizador||e.go("home")}}]),app.controller("quemEquemController",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","StorageService",function(o,a,t,e,n,i,r,l){a.utilizador=l.get("utilizadorLogado"),o.$on("broadcastHomeReceiver",function(o,e){"sobre-o-minfin.quem-e-quem"==t.current.name&&n(function(){a.init()},1e3),"sobre-o-minfin.quem-e-quem.cdQuemEQuem"==t.current.name&&n(function(){a.initVisualizarDetalhes()},1e3)}),a.pagina={},a.menuAtual=t.current,a.init=function(){a.menuAtual.cdMenu&&i.request("GET","/menu/buscarConteudoHtml/"+a.menuAtual.cdMenu,null,!1,function(o){o?200==o.retorno.codigo&&(a.pagina=o.data):r.erroRede()}),i.request("GET","/quemEQuem/listar/"+i.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo&&(a.quemEQuemList=o.data):r.erroRede()})},a.initVisualizarDetalhes=function(){i.request("GET","/quemEQuem/buscar/"+e.cdQuemEQuem,null,!1,function(o){o?200==o.retorno.codigo&&(a.detalhe=o.data):r.erroRede()})}}]),app.controller("petroleoController",["$rootScope","$scope","$state","$timeout","$filter","$translate","RequestService","AlertaService","StorageService",function(o,t,n,a,i,r,l,s,e){t.utilizador=e.get("utilizadorLogado"),o.$on("broadcastHomeReceiver",function(o,e){a(function(){t.init()},1e3)}),t.pagina={},t.init=function(){t.dataJson={portal:l.portalConfig.portalDefault,cdAno:(new Date).getFullYear(),cdMes:(new Date).getMonth(),paginaAtual:1,qtdPaginas:1e3},t.menuAtual=n.current,t.menuAtual.cdMenu&&l.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!1,function(o){o?200==o.retorno.codigo&&(t.pagina=o.data):s.erroRede()}),t.anos=[];for(var o=2007;o<=moment().format("Y");o++)t.anos.push(o);t.meses=[];var e=moment.months();for(o=0;o<e.length;o++){var a={id:o,label:r.instant(e[o].toUpperCase())};t.meses.push(a)}t.paginarRegistos(!1)},t.paginarRegistos=function(e){e=!!e,l.request("POST","/receita-petroleo/listar",t.dataJson,e,function(o){o?200==o.retorno.codigo&&(e&&s.closeProgressAlert(),(t.itensPaginados=o).data.length&&(t.total={exportacaoBbls:0,precoMedio:0,irp:0,ipp:0,itp:0,vlTaxaGaz:0,vlServicoDivida:0,vlTaxaSuperficie:0,vlOutrosValores:0,concessionaria:0,total:0},t.totalPrecoMedio=0,t.dadosPrecoMedio=[],angular.forEach(o.data,function(o){t.total.exportacaoBbls+=i("stringToFloat")(o.exportacaoBbls),t.total.precoMedio+=i("stringToFloat")(o.precoMedio),t.total.irp+=i("stringToFloat")(o.irp),t.total.ipp+=i("stringToFloat")(o.ipp),t.total.itp+=i("stringToFloat")(o.itp),t.total.vlTaxaGaz+=i("stringToFloat")(o.vlTaxaGaz),t.total.vlServicoDivida+=i("stringToFloat")(o.vlServicoDivida),t.total.vlTaxaSuperficie+=i("stringToFloat")(o.vlTaxaSuperficie),t.total.vlOutrosValores+=i("stringToFloat")(o.vlOutrosValores),t.total.concessionaria+=i("stringToFloat")(o.concessionaria),t.total.total+=i("stringToFloat")(o.total),"0,00"<o.precoMedio&&t.dadosPrecoMedio.push(o.precoMedio)}),angular.forEach(t.dadosPrecoMedio,function(o){t.totalPrecoMedio+=i("stringToFloat")(o)}))):s.erroRede()})},t.submitFormFiltrarRegisto=function(o){o.$valid&&(t.dataJson.paginaAtual=1,t.itensPaginados=null,t.paginarRegistos(!0))}}]),app.controller("diamanteController",["$rootScope","$scope","$state","$timeout","$filter","$translate","RequestService","AlertaService","StorageService",function(o,t,n,a,i,r,l,s,e){t.utilizador=e.get("utilizadorLogado"),o.$on("broadcastHomeReceiver",function(o,e){a(function(){t.init()},1e3)}),t.pagina={},t.init=function(){t.dataJson={portal:l.portalConfig.portalDefault,cdAno:(new Date).getFullYear(),cdMes:(new Date).getMonth(),paginaAtual:1,qtdPaginas:1e3},t.menuAtual=n.current,t.menuAtual.cdMenu&&l.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!1,function(o){o?200==o.retorno.codigo&&(t.pagina=o.data):s.erroRede()}),t.anos=[];for(var o=2007;o<=moment().format("Y");o++)t.anos.push(o);t.meses=[];var e=moment.months();for(o=0;o<e.length;o++){var a={id:o,label:r.instant(e[o].toUpperCase())};t.meses.push(a)}t.paginarRegistos(!1)},t.paginarRegistos=function(e){e=!!e,l.request("POST","/receita-diamante/listar",t.dataJson,e,function(o){o?200==o.retorno.codigo&&(e&&s.closeProgressAlert(),(t.itensPaginados=o).data.length&&(t.total={volume:0,preco:0,valorCompra:0,impostoIndustrial:0,royalty:0,valorArrecadado:0},angular.forEach(o.data,function(o){t.total.volume+=i("stringToFloat")(o.volume),t.total.preco+=i("stringToFloat")(o.preco),t.total.valorCompra+=i("stringToFloat")(o.valorCompra),t.total.impostoIndustrial+=i("stringToFloat")(o.impostoIndustrial),t.total.royalty+=i("stringToFloat")(o.royalty),t.total.valorArrecadado+=i("stringToFloat")(o.valorArrecadado)}))):s.erroRede()})},t.submitFormFiltrarRegisto=function(o){o.$valid&&(t.dataJson.paginaAtual=1,t.itensPaginados=null,t.paginarRegistos(!0))}}]),app.controller("inflacaoController",["$rootScope","$scope","$state","$timeout","$translate","RequestService","AlertaService","StorageService",function(o,t,n,a,i,r,l,e){t.utilizador=e.get("utilizadorLogado"),o.$on("broadcastHomeReceiver",function(o,e){a(function(){t.init()},1e3)}),t.pagina={},t.init=function(){t.dataJson={portal:r.portalConfig.portalDefault,cdAno:(new Date).getFullYear(),cdMes:null,paginaAtual:1,qtdPaginas:1e3},t.menuAtual=n.current,t.menuAtual.cdMenu&&r.request("GET","/menu/buscarConteudoHtml/"+t.menuAtual.cdMenu,null,!1,function(o){o?200==o.retorno.codigo&&(t.pagina=o.data):l.erroRede()}),t.anos=[];for(var o=2007;o<=moment().format("Y");o++)t.anos.push(o);t.meses=[];var e=moment.months();for(o=0;o<e.length;o++){var a={id:o,label:i.instant(e[o].toUpperCase())};t.meses.push(a)}t.paginarRegistos(!1)},t.paginarRegistos=function(e){e=!!e,r.request("POST","/taxa-inflacao/listar",t.dataJson,e,function(o){o?200==o.retorno.codigo&&(e&&l.closeProgressAlert(),t.itensPaginados=o):l.erroRede()})},t.submitFormFiltrarRegisto=function(o){o.$valid&&(t.dataJson.paginaAtual=1,t.itensPaginados=null,t.paginarRegistos(!0))}}]),app.controller("glossarioController",["$rootScope","$scope","$state","$stateParams","$location","$anchorScroll","$timeout","RequestService","AlertaService",function(o,a,e,t,n,i,r,l,s){o.$on("broadcastHomeReceiver",function(o,e){r(function(){a.init()},1e3)}),a.pagina={},a.init=function(){a.menuAtual=e.current,l.request("GET","/glossario/listar/"+l.portalConfig.portalAPI,null,!1,function(o){o?200==o.retorno.codigo?a.glossarios=o.data:923!=o.retorno.codigo&&s.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):s.erroRede()}),a.menuAtual.cdMenu&&l.request("GET","/menu/buscarConteudoHtml/"+a.menuAtual.cdMenu,null,!1,function(o){o?200==o.retorno.codigo&&(a.pagina=o.data):s.erroRede()})}}]),app.controller("candidaturaController",["$scope",function(o){o.init=function(){}}]),app.controller("detalharPipCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","RequestService","AlertaService","states",function(o,a,e,t,n,i,r,l){if(o.$on("broadcastHomeReceiver",function(o,e){n(function(){a.init()},1e3)}),a.statePrincipal=o.getState(l.statePrincipal),a.stateAreaAzul=o.getState(l.stateAreaAzul),a.stateAreaAzulFilho=o.getState(l.stateAreaAzulFilho),l.stateAcordion)for(var s=0;s<l.stateAcordion.length;s++)a.stateAcordion.push(o.getState(l.stateAcordion[s]));a.pagina={},a.init=function(){a.pagina.anexoPortalList=[],angular.forEach(o.menu,function(o){o.state==e.current.name?a.menuAtual=subMenu:o.subPaginas&&angular.forEach(o.subPaginas,function(o){o.state==e.current.name?a.menuAtual=o:o.subPaginas&&angular.forEach(o.subPaginas,function(o){o.state==e.current.name&&(a.menuAtual=o)})})}),a.$watch("menuAtual",function(){a.menuAtual&&i.request("GET","/menu/buscarConteudoHtml/"+a.menuAtual.cdMenu,null,!0,function(o){o?(r.closeProgressAlert(),200==o.retorno.codigo&&(a.pagina=o.data)):r.erroRede()})})}}]),app.controller("candidaturaConsultarController",["$scope",function(o){o.init=function(){}}]),app.component("candidaturaEstatisticas",{templateUrl:"app/partials/candidatura-estatisticas.html",controller:["$rootScope","AlertaService","StorageService","$ws",function(o,d,a,e){var g=this;g.utilizador=a.get("utilizadorLogado"),o.$on("broadcastUtilizadorReceiver",function(o,e){g.utilizador=a.get("utilizadorLogado")}),this.$onInit=function(o){$(document).on("shown.bs.modal","#modalGerirEstatisticas",function(){g.carregarGraficos(),g.atualizarGrafico=setInterval(function(){g.carregarGraficos()},3e4)}),$(document).on("hidden.bs.modal","#modalGerirEstatisticas",function(){clearInterval(g.atualizarGrafico)})},g.carregarGraficos=function(){e.comum("GET","/candidatura/painel",null,null,function(o){if(o){if(200==o.retorno.codigo){g.dataLista=o.data.lista;var e={labels:g.getListaAtributo(o.data.lista,"GENERO","label",!0),datasets:[{data:g.getListaAtributo(o.data.lista,"GENERO","valor"),backgroundColor:g.paletaCores(g.getListaAtributo(o.data.lista,"GENERO","valor").length)}]};if(angular.isDefined(g.graficoGenero))g.graficoGenero.data=e,g.graficoGenero.update();else{var a=document.getElementById("genero").getContext("2d");g.graficoGenero=new Chart(a,{type:"pie",data:e,options:{responsive:!0,maintainAspectRatio:!1}})}var t={labels:g.getListaAtributo(o.data.lista,"IDADE","label",!0),datasets:[{data:g.getListaAtributo(o.data.lista,"IDADE","valor"),backgroundColor:g.paletaCores(g.getListaAtributo(o.data.lista,"IDADE","valor").length)}]};if(angular.isDefined(g.graficoIdade))g.graficoIdade.data=t,g.graficoIdade.update();else{var n=document.getElementById("idade").getContext("2d");g.graficoIdade=new Chart(n,{type:"bar",data:{labels:g.getListaAtributo(o.data.lista,"IDADE","label",!0),datasets:[{data:g.getListaAtributo(o.data.lista,"IDADE","valor"),backgroundColor:g.paletaCores(g.getListaAtributo(o.data.lista,"IDADE","valor").length)}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{ticks:{beginAtZero:!0}}]},legend:{display:!1}}})}var i={labels:g.getListaAtributo(o.data.lista,"GRAU","label",!0),datasets:[{data:g.getListaAtributo(o.data.lista,"GRAU","valor"),backgroundColor:g.paletaCores(g.getListaAtributo(o.data.lista,"GRAU","valor").length)}]};if(angular.isDefined(g.graficoGrau))g.graficoGrau.data=i,g.graficoGrau.update();else{var r=document.getElementById("grau").getContext("2d");g.graficoGrau=new Chart(r,{type:"horizontalBar",data:i,options:{responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{ticks:{beginAtZero:!0}}]},legend:{display:!1}}})}var l={labels:g.getListaAtributo(o.data.lista,"PROGRESSAO_DIARIA","label",!0),datasets:[{fill:!1,data:g.getListaAtributo(o.data.lista,"PROGRESSAO_DIARIA","valor"),backgroundColor:g.paletaCores(g.getListaAtributo(o.data.lista,"PROGRESSAO_DIARIA","valor").length)}]};if(angular.isDefined(g.graficoProgressao))g.graficoProgressao.data=l,g.graficoProgressao.update();else{var s=document.getElementById("progressao").getContext("2d");g.graficoProgressao=new Chart(s,{type:"line",data:l,options:{responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{ticks:{beginAtZero:!0}}],yAxes:[{ticks:{beginAtZero:!0}}]},legend:{display:!1}}})}var c={labels:g.getListaAtributo(o.data.lista,"EXCLUIDO_RESUMO","categoria"),datasets:[{label:"Idade",data:g.getListaAtributo(o.data.lista,"EXCLUIDO_RESUMO","excluido_idade"),backgroundColor:g.paletaCores(g.getListaAtributo(o.data.lista,"EXCLUIDO_RESUMO","excluido_idade").length)},{label:"Cursos / Categoria",data:g.getListaAtributo(o.data.lista,"EXCLUIDO_RESUMO","excluido_total"),backgroundColor:g.paletaCores(g.getListaAtributo(o.data.lista,"EXCLUIDO_RESUMO","excluido_total").length)},{label:"Total",data:g.getListaAtributo(o.data.lista,"EXCLUIDO_RESUMO","total"),backgroundColor:g.paletaCores(g.getListaAtributo(o.data.lista,"EXCLUIDO_RESUMO","total").length)}]};if(angular.isDefined(g.graficoInelegivel))g.graficoInelegivel.data=c,g.graficoInelegivel.update();else{var u=document.getElementById("inelegivel").getContext("2d");g.graficoInelegivel=new Chart(u,{type:"horizontalBar",data:c,options:{responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{ticks:{beginAtZero:!0}}]},legend:{display:!1}}})}}}else d.erroRede()})},g.paletaCores=function(o){for(var e=[],a=["rgba(31, 50, 100, .8)","rgba(198, 201, 209, .8)","rgba(176, 16, 16, .8)","rgba(27, 93, 15, .8)"],t=0;t<o;t++)e.push(a[t%a.length]);return e},g.getListaAtributo=function(o,e,a,t){for(var n=[],i=0;i<o.length;i++)if(o[i].codigo===e)for(var r=0;r<o[i].dados.length;r++)t?n.push(o[i].dados[r][a]+" ("+o[i].dados[r].valor+")"):n.push(o[i].dados[r][a]);return n},g.somaTotal=function(){var o=0;if(angular.isDefined(g.dataLista)){for(var e=0;e<g.dataLista[0].dados.length;e++)o+=g.dataLista[0].dados[e].valor;return o}}}]}),app.config(["cfpLoadingBarProvider","$httpProvider",function(o,e){o.includeSpinner=!1}]).service("RequestService",["$rootScope","base64","$http","$timeout","$q","AlertaService","StorageService","RouteServce","$state","$breadcrumb",function(s,a,c,u,d,g,m,p,t,n){var i=p.portalConfig,f=function(){var o=m.get("utilizadorLogado"),e={"Content-Type":"application/json",PORTAL:i.portalAPI,ORIGEM_BREADCRUMB:a.encode(r()),ORIGEM_URL:t.href(t.current.state||"home",{},{absolute:!0})};return o&&(e.Authorization=o.token),e},r=function(){for(var o="",e=n.getStatesChain(),a=0;a<e.length;a++)o+=e[a].ncyBreadcrumb.label,a<e.length-1&&(o+=" / ");return o},v=function(o){UtilizadorService.updateToken(o)};return s.$on("$routeChangeStart",function(o,e,a){c.pendingRequests.forEach(function(o){o.cancel&&o.cancel.resolve()})}),{request:function(o,e,a,t,n){var i=p.componentesPath+e,r=d.defer();t&&g.showProgressAlert("A Carregar...");var l={method:o,data:a,url:i,timeout:r.promise,cancel:r,cache:!1,withCredentials:!0,headers:f()};c(l).then(function(o){923==o.data.retorno.codigo?(m.clear(),u(function(){s.$broadcast("broadcastUtilizadorReceiver")},100),g.showMensagemRetorno(o.data.retorno.codigo,"Faça Login Novamente para continuar a acção",function(){u(function(){angular.element("#exibirPopOverLogin").trigger("click")},500),n&&n(o.data)})):(n&&n(o.data),angular.isDefined(o.data.token)&&o.data.token&&v(o.data.token))},function(o){n&&n()})},comum:function(o,e,a,t,n){var i=p.comumPath+e,r=d.defer(),l={method:o,data:a,url:i,timeout:r.promise,cancel:r,cache:!1,withCredentials:!0,headers:f()};t&&g.showProgressAlert("A Carregar..."),c(l).then(function(o){923==o.data.retorno.codigo?(m.clear(),u(function(){s.$broadcast("broadcastUtilizadorReceiver")},100),g.showMensagemRetorno(o.data.retorno.codigo,"Faça Login Novamente para continuar a acção",function(){u(function(){angular.element("#exibirPopOverLogin").trigger("click")},500),n&&n(o.data)})):(n&&n(o.data),angular.isDefined(o.data.token)&&o.data.token&&v(o.data.token))},function(o){n&&n()}).finally(function(){})},local:function(o,e,a,t,n){c.get("app/services/offline/"+e).then(function(o){n(o.data)})},versao:function(o,e){var a=p.portalPath+o,t=d.defer(),n={method:"GET",url:a,timeout:t.promise,cancel:t,cache:!1,headers:{"Content-Type":"application/json"}};c(n).then(function(o){e&&e(o)},function(o){e&&e()}).finally(function(o){})},portalConfig:i}}]),app.service("AlertaService",["$timeout","$translate",function(n,a){swal.setDefaults({allowOutsideClick:!1,allowEscapeKey:!0,allowEnterKey:!0,confirmButtonColor:"#1f3264",onClose:function(){},onOpen:function(){}});return{showMensagemRetorno:function(o,e,a){var t;switch(o){case 200:t="success";break;case 923:default:t="warning"}swal("",e,t).then(function(o){a&&n(function(){a()},500)})},confirmar:function(o,e){o=o||a.instant("CONFIRMA_ACCAO"),swal({text:o,cancelButtonText:a.instant("CANCELAR"),confirmButtonText:a.instant("SIM"),type:"question",showCancelButton:!0}).then(function(){e(!0)},function(o){"cancel"===o&&e(!1)})},showProgressAlert:function(o){swal({html:'<div class="loading"></div>',showConfirmButton:!1,allowOutsideClick:!1}).done()},closeProgressAlert:function(o){n(function(){swal.close(function(){o&&o()})},500)},erroRede:function(){swal("",a.instant("VERIFIQUE_CONEXAO"),"warning")}}}]),angular.module("storage.service",["LocalStorageModule"]).config(["localStorageServiceProvider",function(o){var e,a="^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$";(0<=window.location.hostname.indexOf(".dev")||0<=window.location.hostname.indexOf("localhost")||window.location.hostname.match(a))&&(e="DEV"),0<=window.location.hostname.indexOf(".hml")&&(e="HML"),0<=window.location.hostname.indexOf(".pre")&&(e="PRE"),window.location.hostname.indexOf(".dev")<0&&window.location.hostname.indexOf(".hml")<0&&window.location.hostname.indexOf(".pre")<0&&window.location.hostname.indexOf("localhost")<0&&!window.location.hostname.match(a)&&(e="PROD"),(7e3<=window.location.port&&window.location.port<=7999||3e3<=window.location.port&&window.location.port<=3999)&&(e="LOCAL"),o.setPrefix("MINFIN-"+e).setNotify(!0,!0)}]).factory("StorageService",["localStorageService",function(a){return{set:function(o,e){return a.set(o,e)},get:function(o){return a.get(o)},remove:function(o){return a.remove(o)},clear:function(){return a.clearAll()}}}]),angular.module("utilizador.service",[]).factory("UtilizadorService",["$rootScope","$q","StorageService","RequestService","$location","AlertaService","Utils",function(a,t,i,n,e,r,l){return{login:function(o,e,a){n.request("POST","/acesso/loginToken",e,!0,function(o){a&&a(o)})},logout:function(o){n.request("GET","/acesso/logout",null,!0,function(o){i.clear(),a.$broadcast("broadcastUtilizadorReceiver"),o?200==o.retorno.codigo?(r.closeProgressAlert(),e.path("/")):r.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):r.erroRede()})},limparCookies:function(o){i.clear(),a.$broadcast("broadcastUtilizadorReceiver"),o&&o()},setCookies:function(o){var n={grupos:[]},e=o.data.grupos?o.data.grupos:[];angular.forEach(e,function(o,e){var a=String(o).split(","),t=String(a[0]).replace("cn=","");n.grupos.push(t)}),o.data.grupos=n.grupos,a.utilizador=o.data,a.utilizador.token=o.token,a.utilizador.gestor=l.validaPermissao("administrador",n.grupos)||l.validaPermissao("gestor",n.grupos)||l.validaPermissao("publicador",n.grupos)||l.validaPermissao("redator",n.grupos)||l.validaPermissao("revisor",n.grupos)||l.validaPermissao("editor",n.grupos),a.utilizador.candidatura=l.validaPermissao("candidatura",n.grupos),i.set("utilizadorLogado",a.utilizador),a.$broadcast("broadcastUtilizadorReceiver")},statusUtilizador:function(e){n.request("GET","/acesso/utilizadorLogado",null,null,function(o){a.$broadcast("broadcastUtilizadorReceiver"),e&&e(o)})},updateToken:function(o){a.utilizador=i.get("utilizadorLogado"),a.utilizador.token=o,i.set("utilizadorLogado",a.utilizador)},setPermissoes:function(o){a.utilizador=i.get("utilizadorLogado"),a.utilizador.listaPermissao=o.data[0].listaPermissao,a.utilizador.listaPerfil=o.data[0].listaPerfil,i.set("utilizadorLogado",a.utilizador)},checarPermissao:function(o){var e=i.get("utilizadorLogado"),a=t.defer();return e?angular.forEach(e.grupos,function(e){angular.forEach(o,function(o){e.toString().toUpperCase()==o.toString().toUpperCase()&&a.resolve(!0)})}):a.resolve(!1),a.promise}}}]),String.prototype.extenso=function(o){for(var e,a,t,n,i,r=[["zero","um","dois","três","quatro","cinco","seis","sete","oito","nove","dez","onze","doze","treze","quatorze","quinze","dezesseis","dezessete","dezoito","dezenove"],["dez","vinte","trinta","quarenta","cinqüenta","sessenta","setenta","oitenta","noventa"],["cem","cento","duzentos","trezentos","quatrocentos","quinhentos","seiscentos","setecentos","oitocentos","novecentos"],["mil","milhão","bilhão","trilhão","quadrilhão","quintilhão","sextilhão","setilhão","octilhão","nonilhão","decilhão","undecilhão","dodecilhão","tredecilhão","quatrodecilhão","quindecilhão","sedecilhão","septendecilhão","octencilhão","nonencilhão"]],l=" e ",s="centavo",c=(n=this.replace(o?/[^,\d]/g:/\D/g,"").split(",")).length-1,u=-1,d=[],g=[],m="";++u<=c;g=[])if(u&&(n[u]=(1*("."+n[u])).toFixed(2).slice(2)),(e=(a=n[u]).slice((i=a.length)%3).match(/\d{3}/g),a=i%3?[a.slice(0,i%3)]:[],a=e?a.concat(e):a).length){for(e=-1,i=a.length;++e<i;m="")(t=1*a[e])&&(t%100<20&&(m+=r[0][t%100])||t%100+1&&(m+=r[1][(t%100/10>>0)-1]+(t%10?l+r[0][t%10]:"")),g.push((t<100?m:t%100?r[2][t/100>>0]+l+m:r[2][100==t?0:t/100>>0])+(-1<(m=i-e-2)?" "+(1<t&&0<m?r[3][m].replace("ão","ões"):r[3][m]):"")));(e=1<g.length?(e=g.pop(),g.join(" ")+l+e):g.join("")||(!u&&0<1*n[u+1]||d.length?"":r[0][0]))&&d.push(e+(o?" "+(1<1*a.join("")?u?s+"s":(/0{6,}$/.test(n[0])?"de ":"")+"real".replace("l","is"):u?s:"real"):""))}return d.join(l)},app.service("Utils",["$http",function(o){this.retornaValorExtenso=function(o){for(var e,a,t,n,i,r=[["zero","um","dois","três","quatro","cinco","seis","sete","oito","nove","dez","onze","doze","treze","quatorze","quinze","dezesseis","dezessete","dezoito","dezenove"],["dez","vinte","trinta","quarenta","cinqüenta","sessenta","setenta","oitenta","noventa"],["cem","cento","duzentos","trezentos","quatrocentos","quinhentos","seiscentos","setecentos","oitocentos","novecentos"],["mil","milhão","bilhão","trilhão","quadrilhão","quintilhão","sextilhão","setilhão","octilhão","nonilhão","decilhão","undecilhão","dodecilhão","tredecilhão","quatrodecilhão","quindecilhão","sedecilhão","septendecilhão","octencilhão","nonencilhão"]],l=" e ",s="centavo",c=(n=this.replace(o?/[^,\d]/g:/\D/g,"").split(",")).length-1,u=-1,d=[],g=[],m="";++u<=c;g=[])if(u&&(n[u]=(1*("."+n[u])).toFixed(2).slice(2)),(e=(a=n[u]).slice((i=a.length)%3).match(/\d{3}/g),a=i%3?[a.slice(0,i%3)]:[],a=e?a.concat(e):a).length){for(e=-1,i=a.length;++e<i;m="")(t=1*a[e])&&(t%100<20&&(m+=r[0][t%100])||t%100+1&&(m+=r[1][(t%100/10>>0)-1]+(t%10?l+r[0][t%10]:"")),g.push((t<100?m:t%100?r[2][t/100>>0]+l+m:r[2][100==t?0:t/100>>0])+(-1<(m=i-e-2)?" "+(1<t&&0<m?r[3][m].replace("ão","ões"):r[3][m]):"")));(e=1<g.length?(e=g.pop(),g.join(" ")+l+e):g.join("")||(!u&&0<1*n[u+1]||d.length?"":r[0][0]))&&d.push(e+(o?" "+(1<1*a.join("")?u?s+"s":(/0{6,}$/.test(n[0])?"de ":"")+"real".replace("l","is"):u?s:"real"):""))}return d.join(l)};var e=function(o){var e=String(o).toUpperCase().replace(/[^A-Z0-9]/g,""),a=e.match(/^([A-Z]{2})(\d{2})([A-Z\d]+)$/);return!(!a||e.length!=={AD:24,AE:23,AT:20,AZ:28,BA:20,BE:16,BG:22,BH:22,BR:29,CH:21,CR:21,CY:28,CZ:24,DE:22,DK:18,DO:28,EE:20,ES:24,FI:18,FO:18,FR:27,GB:22,GI:23,GL:18,GR:27,GT:28,HR:21,HU:28,IE:22,IL:23,IS:26,IT:27,JO:30,KW:30,KZ:20,LB:28,LI:21,LT:20,LU:20,LV:21,MC:27,MD:24,ME:22,MK:19,MR:27,MT:31,MU:30,NL:18,NO:15,PK:24,PL:28,PS:29,PT:25,QA:29,RO:24,RS:22,SA:24,SE:24,SI:19,SK:24,SM:27,TN:24,TR:26,AO:25}[a[1]])&&function(o){for(var e,a=o.slice(0,2),t=2;t<o.length;t+=7)e=String(a)+o.substring(t,t+7),a=parseInt(e,10)%97;return a}((a[3]+a[1]+a[2]).replace(/[A-Z]/g,function(o){return o.charCodeAt(0)-55}))};this.validarIBAN=function(o){return e("ao06 "+o)},this.scrollTopPage=function(){$("html body").scrollTop(0),$(".topoPINV").show(),$(".esconderPINV").hide(),$(".content.bg-color-2.left-sidebar").addClass("bg_ContentInvestidor"),$(".bgPINV").attr("style","background: #0a3640;")},this.scrollTopPageAt=function(o){$("html body").animate({scrollTop:o},500)},this.mantemModal=function(o,e){e?angular.element(o).modal("show"):angular.element(o).modal("hide")},this.initTooltip=function(){$timeout(function(){$('[data-toggle="tooltip"]').tooltip()},300)},this.getFloatMoney=function(o){var e=0,a=""+o;if(""!=a&&null!=a){var t=a.split(","),n=t[0].split("."),i="";$.each(n,function(o,e){i+=e}),e=i+"."+t[1]}else e=0;return parseFloat(e).toFixed(2)},this.formatKuanza=function(o){var e=o+"";if(1<=parseInt(e.indexOf("."))){var a=e.split("."),t=a[0],n=a[1].substr(0,2);parseInt(n)<10&&(a[1].length<2?n+="0":n=n),e="00"==n?t:t+"."+n}var i=e+"",r=!1;return i-Math.round(o)==0&&(i+="00"),i.indexOf(".")&&(i=i.replace(".","")),0==i.indexOf("-")&&(r=!0,i=i.replace("-","")),1==i.length&&(i="0"+i),6<(i=i.replace(/([0-9]{2})$/g,",$1")).length&&(i=i.replace(/([0-9]{3}),([0-9]{2}$)/g,".$1,$2")),9<i.length&&(i=i.replace(/([0-9]{3}).([0-9]{3}),([0-9]{2}$)/g,".$1.$2,$3")),12<i.length&&(i=i.replace(/([0-9]{3}).([0-9]{3}).([0-9]{3}),([0-9]{2}$)/g,".$1.$2.$3,$4")),15<i.length&&(i=i.replace(/([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}),([0-9]{2}$)/g,".$1.$2.$3.$4.$5,$6")),18<i.length&&(i=i.replace(/([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}).([0-9]{3}),([0-9]{2}$)/g,".$1.$2.$3.$4.$5.$6,$7")),0==i.indexOf(".")&&(i=i.replace(".","")),0==i.indexOf(",")&&(i=i.replace(",","0,")),r?"-"+i:i},this.occurrences=function(o,e,a){if(o+="",(e+="").length<=0)return o.length+1;for(var t=0,n=0,i=a?1:e.length;0<=(n=o.indexOf(e,n));)++t,n+=i;return t},this.formataData=function(o){return""!=o?o.split("/").reverse().join("-"):""},this.leapYear=function(o){return o%4==0&&o%100!=0||o%400==0},this.formataDataNormal=function(o){return""!=o?o.split("-").reverse().join("/"):""},this.validaPermissao=function(o,e){var a=!1;return e&&0<e.length&&-1!=e.indexOf(o)&&(a=!0),a},this.validaData=function(o){var e=jQuery("#"+o).val();if(""!=e)if(e.length<10)swal({title:"Data inválida",text:"Por favor preencha o campo!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok"},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},100)});else{var a=e.split("/");31<a[0]?swal({title:"Data inválida",text:"Por favor preencha o campo!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok"},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},100)}):2==a[1]&&28<a[0]?swal({title:"Data inválida",text:"Por favor preencha o campo!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok"},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},100)}):12<a[1]&&swal({title:"Data inválida",text:"Por favor preencha o campo!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok"},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},100)})}},this.validarPeriodo=function(o,e){var a=$("#"+o),t=$("#"+e),n=!0;if(""!=a.val()&&""!=t.val()){var i=new Date(this.formataData(a.val()));new Date(this.formataData(t.val()))<i&&(n=!1)}else""==a.val()&&""!=t.val()&&(n=!1);return n},this.validaDataReturnBoolean=function(o){var e=jQuery("#"+o).val(),a=!0;if(""!=e)if(e.length<10)a=!1;else{var t=e.split("/");31<t[0]?a=!1:2==t[1]&&28<t[0]?a=!1:12<t[1]&&(a=!1)}return a},this.validateEmail=function(o){var e=jQuery("#"+o).val();if(""!=e){if(/^[a-zA-Z0-9][a-zA-Z0-9\._-]+@([a-zA-Z0-9\._-]+\.)[a-zA-Z-0-9]{2}/.exec(e))return!1;swal({title:"Aviso",text:"E-mail inválido!",type:"warning",showCancelButton:!1,confirmButtonClass:"btn-danger",confirmButtonText:"Ok",closeOnConfirm:!0,allowOutsideClick:!1},function(){setTimeout(function(){jQuery("#"+o).val(""),jQuery("#"+o).focus()},300)})}},this.validEmailReg=function(o){var e=!1;return/^[a-zA-Z0-9][a-zA-Z0-9\._-]+@([a-zA-Z0-9\._-]+\.)[a-zA-Z-0-9]{2}/.exec(o)&&(e=!0),e}}]),app.service("Alertas",["$rootScope",function(o){this.wait=function(o){o=o||"A processar...",swal({html:'<div class="loading"> </div><br/><p>'+o+"</p>",showConfirmButton:!1,allowOutsideClick:!1}).done()},this.closeWait=function(){swal.close()},this.confirm=function(o,e,a,t){o=o||"Confirmar a acção ?",e=e||"Sim",a=a||"Cancelar",swal({text:o,cancelButtonText:a,confirmButtonText:e,type:"warning",showCancelButton:!0,confirmButtonColor:"#5cb85c",allowOutsideClick:!1}).then(function(){t(!0)},function(o){"cancel"===o&&t(!1)}).done()},this.networkError=function(){swal({title:o.const.TITLE_LAMENTAMOS,text:o.const.ERRO_COMPLETAR_OPERACAO,type:"warning",showConfirmButton:!1,showCloseButton:!0,showCancelButton:!0,cancelButtonText:"OK"}).then(function(){callback(!0)},function(o){if("cancel"===o)return!1}).done()},this.statusRetorno=function(o,e){e=e||!1,timer=!e&&2e3,swal({text:o,type:"success",showConfirmButton:!1,showCloseButton:!0,timer:timer,showCancelButton:e,cancelButtonText:"Fechar",allowOutsideClick:!1}).done()},this.statusRetornoErro=function(o){swal({text:o,type:"warning",showConfirmButton:!1,showCloseButton:!0,showCancelButton:!0,cancelButtonText:"OK",allowOutsideClick:!1}).then(function(){return!1},function(o){if("cancel"===o)return!1}).done()},this.statusRetornoErroCallback=function(o,e){swal({text:o,type:"warning",showConfirmButton:!1,showCloseButton:!0,cancelButtonText:"OK",showCancelButton:!0,allowOutsideClick:!1}).then(function(){e(!0)},function(o){"cancel"===o&&e(!1)}).done()},this.aviso=function(o,e,a,t){swal({title:e,text:a,type:o,showConfirmButton:!1,showCloseButton:!0,cancelButtonText:"OK",showCancelButton:!0,allowOutsideClick:!1}).then(function(){t(!0)},function(o){t(!0)}).done()},this.msgError=function(o,e){swal({title:o,text:e,type:"warning",showConfirmButton:!1,showCloseButton:!0,cancelButtonText:"OK",showCancelButton:!0}).done()}}]),app.config(["cfpLoadingBarProvider","$httpProvider",function(o,e){o.includeSpinner=!1}]).service("$ws",["$rootScope","$http","$timeout","$q","RouteServce","AlertaService","StorageService","UtilizadorService","Utils","$translate",function(s,c,u,d,g,m,a,p,f,v){var t=g.portalConfig,h=function(){var o=a.get("utilizadorLogado"),e={"Content-Type":"application/json",PORTAL:t.portalAPI};return o&&(e.Authorization=o.token),e},P=function(o){p.updateToken(o)};s.$on("$routeChangeStart",function(o,e,a){c.pendingRequests.forEach(function(o){o.cancel&&o.cancel.resolve()})});return{request:function(o,e,a,t,n){var i=g.portalPath+e,r=d.defer(),l={method:o,data:a,url:i,timeout:r.promise,cancel:r,cache:!1,withCredentials:!0,headers:h()};t&&m.showProgressAlert("A Carregar..."),c(l).then(function(o){923==o.data.retorno.codigo?(angular.element(".modal.fade.in")&&f.mantemModal(".modal",!1),m.showMensagemRetorno(s.const.TITLE_AVISO,s.const.SESSAO_EXPIRADO_FACA_LOGIN_NOVAMENTE,function(){u(function(){p.logout()})})):(n&&n(o.data),angular.isDefined(o.data.token)&&o.data.token&&P(o.data.token))},function(o){n&&n()}).finally(function(){})},comum:function(o,e,a,t,n){var i=g.comumPath+e,r=d.defer(),l={method:o,data:a,url:i,timeout:r.promise,cancel:r,cache:!1,withCredentials:!0,headers:h()};t&&m.showProgressAlert(v.instant("A_CARREGAR")),c(l).then(function(o){923==o.data.retorno.codigo?(angular.element(".modal.fade.in")&&f.mantemModal(".modal",!1),m.showMensagemRetorno(o.data.retorno.codigo,v.instant("ACEDA_O_SISTEMA_PARA_CONTINUAR"),function(){u(function(){p.logout()})})):(n&&n(o.data),angular.isDefined(o.data.token)&&o.data.token&&P(o.data.token))},function(o){n&&n()}).finally(function(){})},local:function(o,e,a,t,n){c.get("app/services/offline/"+e).then(function(o){n(o.data)})}}}]),angular.module("link.service",[]).factory("LinkService",function(){return{target:function(o){var e=RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi);return o.match(e)}}}),angular.module("menu.service",[]).factory("MenuService",["$rootScope","$state",function(o,e){var t=[],n=function(o,a){var t=[];return o&&0==t.length&&angular.forEach(o,function(o,e){if(o.state!=a)return n(o.subPaginas,a);t=o.subPaginas}),t};return{menu:function(a){return t=[],angular.forEach(o.menu,function(o,e){o.state==a?t=o.subPaginas:0==t.length&&(t=n(o.subPaginas,a))}),t},tituloMenu:function(o){try{return e.get(o).ncyBreadcrumb.label}catch(o){return null}},obterSubLink:function(o){for(var e=null,a=0;a<o.subPaginas.length;a++)if("S"==o.subPaginas[a].flAtivo){e=o.subPaginas[a].state;break}return e}}}]),app.service("GraficosService",["$ws","$q","$window","AlertaService",function(s,c,u,d){return{buscarGraficosPath:function(e){s.request("GET","/bi/path-bi",null,null,function(o){e(o)})},getGrafico:function(o,n,e,a){var i={type:a,data:{labels:[],datasets:[]},options:{responsive:!0,title:{display:!0,text:e},tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},scales:{xAxes:[{display:!0,scaleLabel:{display:!1,labelString:"Month"}}],yAxes:[{display:!0,scaleLabel:{display:!1,labelString:"Value"}}]}}},r={config:null,fonte:null},l=["#F0B008","#18ADFF","#FF9600","#99E6E6","#FF6500","#E6B333","#3366E6","#999966","#99FF99","#B34D4D","#80B300","#809900","#E6B3B3","#6680B3","#66991A","#FF99E6","#CCFF1A","#FF1A66","#E6331A","#33FFCC","#66994D","#B366CC","#4D8000","#B33300","#CC80CC","#66664D","#991AFF","#E666FF","#4DB3FF","#1AB399","#E666B3","#33991A","#CC9999","#B3B31A","#00E680","#4D8066","#809980","#E6FF80","#1AFF33","#999933","#FF3380","#CCCC00","#66E64D","#4D80CC","#9900B3","#E64D66","#4DB380","#FF4D4D","#99E6E6","#6666FF"],t={path:o};s.request("POST","/bi/buscar-path",t,null,function(o){if(o){if(200==o.retorno.codigo){var a=o.data.results;if(a.length){var t=c.defer();angular.forEach(a,function(o,e){r.fonte=o.fonte,0<o.labels.length&&angular.forEach(o.labels,function(o,e){i.data.labels.push(o)}),0<o.datasets.length&&angular.forEach(o.datasets,function(o,e){var a={label:o.label,backgroundColor:l[e],borderColor:l[e],data:o.data,fill:!1};i.data.datasets.push(a)}),r.config=i,a.length-1==e&&t.resolve(o)}),t.promise.then(function(o){try{u.myLine||(u.myLine=[]),u.myLine[n]&&u.myLine[n].clear().destroy();var e=document.getElementById("canvas"+n).getContext("2d");u.myLine[n]=new Chart(e,r.config),angular.element("#fonteGrafico"+n).html(r.fonte)}catch(o){}})}}}else d.erroRede()})}}}]),app.service("ComumService",["RequestService","AlertaService",function(t,n){return{uploadFicheiroContent:function(o,a){var e=[{ivNoFicheiro:o.nome,ivTokenId:null,ivUrl:null,path:"ficheiros",extensao:o.extensao,mimeType:o.mimeType,base64:o.base64}];t.comum("POST","/privado/content/add",e,!0,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e),n.closeProgressAlert()}else a&&a();else n.erroRede()})}}}]),app.service("ContribuinteService",["$timeout","$ws","AlertaService",function(o,e,t){return{recuperarContribuinte:function(o,a){e.comum("POST","/publico/sigfe/comum/contribuinte",o,!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:null;a&&a(e)}else t.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else t.erroRede()})}}}]),app.service("ComumServices",["$timeout","$ws","AlertaService",function(o,t,n){return{getListaPaises:function(a){t.comum("POST","/publico/sigfe/comum/paises",{},!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},getListaProvincias:function(a){t.comum("POST","/publico/sigfe/comum/provincias",{cdProvincia:null,noProvincia:null,sigla:null,cdEstatistica:null,dniCodprov:null,ivFlAtivo:"S"},!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},getListaMunicipios:function(o,a){if(o){var e={inCdMunicipio:null,ivNoMunicipio:null,inCdProvincia:o,inCdEstatistica:null,inCdZona:null,inDniCodmunic:null,ivFlAtivo:"S"};t.comum("POST","/publico/sigfe/comum/municipios",e,!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})}},getListaComunas:function(o,a){if(o){var e={inCdComuna:null,ivNoComuna:null,ivSgSigla:null,inCdMunicipio:o,inCdEstatistica:null,ivFlAtivo:"S"};t.comum("POST","/publico/sigfe/comum/comunas",e,!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})}},getListaBairros:function(o,a){if(o){var e={inCdBairro:null,ivNoBairro:null,inCdEstatistica:null,inCdComuna:o,ivFlOutros:null};t.comum("POST","/publico/sigfe/comum/bairros",e,!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})}},getListaTipoDocumento:function(a){t.comum("POST","/publico/sigfe/comum/dominios",{ivRvDomain:"TP_DOC_IDENTIFICACAO",ivRvLowValue:null,ivRvHighValue:null,ivRvAbbreviation:null,ivRvMeaning:null},!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},getDominios:function(o,a){var e={ivRvDomain:o,ivRvLowValue:null,ivRvHighValue:null,ivRvAbbreviation:null,ivRvMeaning:null};t.comum("POST","/publico/sigfe/comum/dominios",e,!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},getListaMoedas:function(a,o){null==o&&(o=!1),t.comum("POST","/publico/sigfe/comum/moedas",{ivSigla:null,ivDsMoeda:null,ivDsMoedaPl:null},o,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];e=(e=e.filter(function(o){return"UCF"!==o.ivSigla})).filter(function(o){return"KZ"!==o.ivSigla}),a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},getListaTipoPessoa:function(a){t.comum("POST","/publico/sigfe/comum/dominios",{ivRvDomain:"TP_PESSOA_ESTRANGEIRA",ivRvLowValue:null,ivRvHighValue:null,ivRvAbbreviation:null,ivRvMeaning:null},!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},getListaTiposAnexos:function(o,a){null==o&&(o=!1),t.comum("POST","/publico/sigfe/comum/tipo-anexo",{inCdTpAnexoSigfeTitulo:null,ivSgTpAnexoSigfe:"CAND_AGT",ivFlAtivo:null,ivFlPortal:null,ivOrder:"1"},o,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},getListaZonas:function(a,o){null==o&&(o=!1),t.comum("POST","/publico/sigfe/comum/zonas",{inCdZona:null,ivNoZona:null,ivObsZona:null},o,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},getTipoRegime:function(a,o){null==o&&(o=!1),t.comum("POST","/publico/sigfe/comum/dominios",{ivRvDomain:"TP_AIPEX_REGIME",ivRvLowValue:null,ivRvHighValue:null,ivRvAbbreviation:null,ivRvMeaning:null},o,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},uploadFicheiroContent:function(o,a){var e=[{ivNoFicheiro:o.nome,ivTokenId:null,ivUrl:null,path:"ficheiros",extensao:o.extensao,mimeType:o.mimeType,base64:o.base64}];t.comum("POST","/privado/content/add",e,!0,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},removerFicheiroContent:function(o,e){var a=[o];t.comum("POST","/privado/content/remove",a,!0,function(o){o?200==o.retorno.codigo?e&&e(!0):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},getListaGruposItens:function(a){t.comum("POST","/publico/sigfe/comum/dominios",{ivRvDomain:"TP_AIPEX_LEI_INCENTIVO",ivRvLowValue:null,ivRvHighValue:null,ivRvAbbreviation:null,ivRvMeaning:null},!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},insereContribuinteEstrangeiro:function(o,e){t.comum("POST","/sisp/rgc/criar-estrangeiro",o,!1,function(o){o?200==o.retorno.codigo?e&&e():n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},listaContribuinte:function(o,e){t.comum("POST","/sisp/rgc/listar",o,!1,function(o){o?200==o.retorno.codigo?e&&e(o.data):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},getListaClassificacaoVisto:function(a){t.comum("POST","/publico/sigfe/comum/dominios",{ivRvDomain:"TP_VISTO_CLASSIFICACAO",ivRvLowValue:null,ivRvHighValue:null,ivRvAbbreviation:null,ivRvMeaning:null},!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},getListaTipoAnexoVisto:function(e){t.comum("POST","/publico/sigfe/comum/tipo-anexo",{inCdTpAnexoSigfeTitulo:null,ivSgTpAnexoSigfe:"AIPEX_PED",ivFlAtivo:null,ivFlPortal:null,ivOrder:"1"},!1,function(o){o?200==o.retorno.codigo?e&&e(o.data):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},getListaTipoAnexoProrrogacaoVisto:function(e){t.comum("POST","/publico/sigfe/comum/tipo-anexo",{inCdTpAnexoSigfeTitulo:null,ivSgTpAnexoSigfe:"AIPEX_PRO",ivFlAtivo:null,ivFlPortal:null,ivOrder:"1"},!1,function(o){o?200==o.retorno.codigo?e&&e(o.data):n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})},getListaMunicipiosFilter:function(o,a){o&&t.comum("POST","/publico/sigfe/comum/municipios",o,!1,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},uploadFicheiroContentAnexo:function(o,a){t.comum("POST","/candidatura/enviar-anexo",o,!0,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:null;a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})},downloadAnexo:function(o,a){t.comum("GET","/candidatura/download-anexo?inCdCandidaturaAnexo="+o,null,!0,function(o){if(o)if(200==o.retorno.codigo){var e=o.data?o.data:[];a&&a(e)}else n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem);else n.erroRede()})}}}]),app.service("EnderecoService",["$timeout","RequestService","AlertaService",function(o,t,n){return{recuperarEnderecoPorCdRgc:function(o,e){var a={ivTpAipexEndereco:null,inCdRgc:o,inCdInvestidorPrivado:null,inCdAipexProposta:null};t.requestPortalMinfin("POST","/endereco/listar",a,!1,function(o){o?200==o.retorno.codigo?e&&e():n.showMensagemRetorno(o.retorno.codigo,o.retorno.mensagem):n.erroRede()})}}}]),app.service("RouteServce",["$translateLocalStorage",function(o){var e,a,t="/PortalMinfin",n=o.get("NG_TRANSLATE_LANG_KEY"),i="PT"!=n&&n&&""!=n?"-"+n:"";return 0<=window.location.hostname.indexOf("localhost")||window.location.hostname.match("^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$")?(e="dev.minfin.gov.ao",a="https://"):(e=window.location.hostname,a=window.location.protocol+"//"),{portalPath:a+e+t,comumPath:a+e+"/servico-comum/api",componentesPath:a+e+"/Componentes/api",portalConfig:{portalAPI:"MINFIN"+i,protocol:a,location:e,port:window.location.port,context:t,portalDefault:"MINFIN"}}}]),angular.module("upload.service",[]).factory("UploadService",["$timeout","AlertaService","RequestService",function(t,l,n){return{preUpload:function(o){var e=new FileReader;return o.target.files&&e.readAsDataURL(o.target.files[0]),e},validarFicheiro:function(){},adicionarAnexos:function(o){o.push({ivNoFicheiro:null,ivNoUsuario:null,ivTokenId:null,ivUrl:null,inCdTpAnexoSigfe:null,excluir:!1})},removerAnexos:function(e,a){e[a].ivUrl||e[a].base64?l.confirmar("Deseja excluir anexo?",function(o){o&&(e[a].excluir=!0,e[a].base64&&t(function(){e.splice(a,1)},100))}):t(function(){e.splice(a,1)},100)},preUploadMenu:function(e,a,t,o,n){if(angular.isDefined(o)&&o.target.files.length){var i=o.target.files[0];if(i.extensao=i.name.split("."),0<i.size){var r=new FileReader;r.readAsDataURL(i),r.onload=function(){var o={permitir:!0,tamanho:!0};a.indexOf(i.extensao[i.extensao.length-1].toLowerCase())<0&&(r.onloadend=!1,o.permitir=!1,l.showMensagemRetorno(400,"Tipo do ficheiro inválido")),i.size>1048576*t&&(r.onloadend=!1,o.tamanho=!1,l.showMensagemRetorno(400,"Tamanho do ficheiro invalido.")),o.permitir&&o.tamanho&&(e.nome=i.name,e.base64Anexo=r.result.substr(r.result.indexOf(",")+1).replace(/ /g,""),e.extensao=i.extensao.slice(-1)[0],e.mimeType=i.type)},r.onloadstart=function(){l.showProgressAlert()},r.onloadend=function(){l.closeProgressAlert(),n&&n()},r.onabort=function(){l.closeProgressAlert(),n&&n()}}}},extensoesPermitidasMap:function(o){return o.map(function(o){return"."+o}).join(",")},upload:function(o,e,a){n.servicoComum("POST","/privado/content/add",o,e,function(o){if(o){var e=o.data.map(function(o){return{ivNoFicheiro:null,ivNoUsuario:"null",ivTokenId:o,ivUrl:null,inCdTpAnexoSigfe:null}});o.parse=e,a(o)}})},getListaAnexos:function(o,e){var a=[];o.map(function(o){a.push(o.ivTokenId)}),n.servicoComum("POST","/privado/content/dados",a,!1,function(o){200==o.retorno.codigo&&(o.data.map(function(o){o.excluir=!1}),e(o.data))})}}}]),app.directive("popover",["$compile","$window",function(t,o){return{restrict:"A",link:function(e,a){$(a).popover({html:!0,content:function(){var o=$(a).attr("data-popover-content");return t($(o).children(".popover-body").html())(e)},title:function(){var o=$(a).attr("data-popover-content");return $(o).children(".popover-heading").html()}})}}}]),app.directive("zoomIn",["$compile","$window",function(o,e){return{restrict:"A",link:function(o,e){e.on("mouseenter",function(){e.removeClass("zoomOut").addClass("zoomIn")}),e.on("mouseleave",function(){e.removeClass("zoomIn").addClass("zoomOut")})}}}]),app.directive("validFile",function(){return{require:"ngModel",link:function(o,e,a,t){t.$render=function(){t.$setViewValue(e.val())},e.bind("change",function(){o.$apply(function(){t.$render()})})}}}),app.directive("datePicker",function(){return{restrict:"A",scope:{ngModel:"="},link:function(o,e,a){var t={format:a.dateFormat,language:"pt",autoclose:!0,todayHighlight:!0,clearBtn:!0};e.datepicker(t)}}}),app.directive("dateTimePicker",["$parse","$timeout",function(i,r){return{restrict:"A",require:"ngModel",link:function(e,a,t){var n={locale:"pt",format:t.dateFormat};a.datetimepicker(n),a.next().find("button").bind("click",function(){a.focus()}),a.on("blur",function(o){e.$apply(function(){i(t.ngModel).assign(e,a[0].value)})}),a.on("hide",function(o){}),a.on("click",function(o){a.datetimepicker(n),r(function(){if(t.datamax){var o=moment(moment(t.datamax,"YYYY-MM-DD"));$("#"+t.id).data("DateTimePicker").maxDate(o)}if(t.datamin){var e=moment(moment(t.datamin,"YYYY-MM-DD"));$("#"+t.id).data("DateTimePicker").minDate(e)}},100)}),a.on("dp.change",function(o){if(t.datamin){var e=moment(moment(t.datamin,"YYYY-MM-DD"));$("#"+t.id).data("DateTimePicker").minDate(e)}if(t.datamax){var a=moment(moment(t.datamax,"YYYY-MM-DD"));$("#"+t.id).data("DateTimePicker").maxDate(a)}if(moment(o.date).isValid())try{r(function(){t.minDate&&angular.element(t.minDate).data("DateTimePicker").minDate(o.date),t.maxDate&&angular.element(t.maxDate).data("DateTimePicker").maxDate(o.date)},100)}catch(o){}})}}}]),app.directive("backImg",function(){return function(o,e,a){var t=a.backImg;e.css({"background-image":"url("+t+")"})}}),app.directive("ngUploadChange",function(){return{scope:{ngUploadChange:"&"},link:function(e,o,a){o.on("change",function(o){e.ngUploadChange({$event:o})})}}}),app.directive("iconFile",["$compile","$window",function(o,e){return{restrict:"A",link:function(o,e,a){var t,n=a.ngHref.split(".");switch(n[n.length-1].toLowerCase()){case"doc":case"docx":t="fa-file-word-o";break;case"xls":case"xlsx":t="fa-file-excel-o";break;case"pdf":t="fa-file-pdf-o";break;case"txt":t="fa-file-text-o";break;case"html":t="fa-globe";break;case"jpg":case"jpeg":case"gif":case"png":case"bmp":t="fa-image";break;default:t="fa-download"}e.prepend('<i class="fa '+t+'" aria-hidden="true"></i>&nbsp;')}}}]),app.directive("inputFileMask",["$compile","$window",function(o,e){return{restrict:"A",link:function(o,e,a){e.prepend('<i class="fa fa-download" aria-hidden="true"></i>&nbsp;')}}}]),app.directive("calendario",function(){return{restrict:"EA",replace:!1,templateUrl:"app/partials/calendario.html",scope:{eventos:"=",eventosDoDia:"=",dtInicial:"=",carregarEventos:"=",mesSelecionado:"="},link:function(t,o,e,a){t.mesSelecionado=null,t.onTimeSelected=function(o,e){t.mesSelecionado=null,t.eventosDoDia=[],t.eventos=[],t.dataSelecionada=o,angular.isDefined(e)&&(t.eventosDoDia=e)},t.rangeChanged=function(o,e){t.eventosDoDia=[],t.eventos=[];var a=moment().range(o,e);t.mesSelecionado=moment(o).add(parseInt(a.diff("d")/2),"days"),t.carregarEventos(o,e,function(o){t.parseEventos=[],t.eventos=o,angular.forEach(o,function(o,e){var a={title:o.imposto,startTime:new Date(moment(o.dtFim,"DD-MM-YYYY").format("YYYY-MM-DD")),endTime:new Date(moment(o.dtFim,"DD-MM-YYYY").format("YYYY-MM-DD")),source:o,allDay:!1};t.parseEventos.push(a)})})}}}}),app.directive("cropImg",function(){return{templateUrl:"app/partials/crop-img.html",restrict:"E",scope:{obj:"=",anexoIndice:"<",extensoesPermitidas:"<",tamanhoFicheiro:"<",obrigatorio:"="},controller:["$rootScope","$scope","$timeout","AlertaService","RequestService","Cropper",function(o,s,t,c,e,n){this.$onInit=function(){s.uniqueId=(new Date).getTime()},o.$on("broadcastHomeReceiver",function(o,e){s.editarImagemDestaque=!1}),s.exibirCropper=!1,s.dataUrl=null,s.file=null,s.data=null,s.onFile=function(o){if(angular.isUndefined(o.isTrigger)){var e=o.target.files[0];if(angular.isDefined(e)){e.extensao=e.name.split(".");var a=new FileReader;a.readAsDataURL(e),a.onload=function(){var o={permitir:!0,tamanho:!0};s.extensoesPermitidas.indexOf(e.extensao[e.extensao.length-1].toLowerCase())<0&&(a.onloadend=!1,o.permitir=!1,c.showMensagemRetorno(400,"Tipo do ficheiro inválido")),e.size>1048576*s.tamanhoFicheiro&&(a.onloadend=!1,o.tamanho=!1,c.showMensagemRetorno(400,"Ultrapassou o limite do tamanho do ficheiro")),o.permitir&&o.tamanho&&s.atualizarFicheiro(e,!0)},a.onloadstart=function(){c.showProgressAlert()},a.onloadend=function(){c.closeProgressAlert()},a.onabort=function(){c.closeProgressAlert()}}}},s.atualizarFicheiro=function(o,e){s.ficheiroSelecionado=o,s.editarImagemDestaque=!0,s.ficheiroLocalorigem=e;var a=new FileReader;a.readAsDataURL(o),a.onload=function(){n.encode(s.file=o).then(function(o){if(s.dataUrl=o,s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].base64Anexo=o.substr(o.indexOf(",")+1).replace(/ /g,""),s.ficheiroLocalorigem)s.ficheiroSelecionado.extensao=s.ficheiroSelecionado.name.split("."),s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].nome="_CAPA_"+s.ficheiroSelecionado.name,s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].extensao=s.ficheiroSelecionado.extensao[s.ficheiroSelecionado.extensao.length-1],s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].mimeType=s.ficheiroSelecionado.type,s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].url=null,s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].ficheiroUrl=null,s.ficheiroSelecionado=null;else{var e=s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].nome.split(".");s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].extensao=e[e.length-1],s.excluirAnexo()}t(function(){s.toogleCropper()},300)})}},s.excluirAnexo=function(){s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].contentUrlARemover=s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].url,s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].url=null},s.atualizarImagemDestaque=function(){var o={portal:e.portalConfig.portalAPI,data:{anexos:[{url:s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].url}]}};e.request("POST","/anexo/bytes",o,!0,function(o){if(o)if(200==o.retorno.codigo){c.closeProgressAlert();var e,a=s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].url.split("/"),t=atob(o.data[0].bytesFicheiro),n=t.length,i=new ArrayBuffer(n),r=new Uint8Array(i);for(e=0;e<n;e++)r[e]=t.charCodeAt(e);var l=new File([r],a[a.length-1],{type:"image/jpg"});s.atualizarFicheiro(l)}else 923!=o.retorno.codigo&&c.showMensagemRetorno(400,"Erro ao aceder ficheiro");else c.erroRede()})},s.cropper={},s.cropperProxy="cropper.first",s.preview=function(){s.file&&s.data&&n.crop(s.file,s.data).then(n.encode).then(function(o){s.dataUrl=o,s.obj.data.anexoPortalList[0].anexoPortalItemList[s.anexoIndice].base64Anexo=o.substr(o.indexOf(",")+1).replace(/ /g,"")}).then(function(){s.toogleCropper()})},s.clear=function(o){s.cropper.first&&s.cropper.first("clear")},s.scale=function(e){n.crop(s.file,s.data).then(function(o){return n.scale(o,{width:e})}).then(n.encode).then(function(o){(s.preview||(s.preview={})).dataUrl=o})},s.options={maximize:!0,aspectRatio:1,crop:function(o){s.data=o}},s.showEvent="show",s.hideEvent="hide",s.toggleCropperstatus=!1,s.toogleCropper=function(){s.toggleCropperstatus?s.$broadcast(s.hideEvent):s.$broadcast(s.showEvent),s.toggleCropperstatus=!s.toggleCropperstatus}}]}}),app.directive("form",["$timeout",function(t){return{restrict:"E",link:function(o,e){e.on("submit",function(){var a=e[0].querySelector(".ng-invalid");a&&(angular.element(e).find(".panel-collapse").length?angular.element(e).find(".panel-collapse").each(function(o,e){angular.element(e).find(".ng-invalid").length&&(angular.element(e).collapse("show"),t(function(){a.focus()},200))}):a.focus())})}}}]),app.directive("checkHref",["LinkService","$location",function(n,i){return function(o,e,a){if(a.checkHref){var t=a.checkHref;n.target(t)?e.attr("href",t).attr("target","_blank"):t?(i.$$html5||-1==t.indexOf("#!")&&(t="#!"+t),e.attr("href",t)):e.removeAttr("href")}}}]),app.directive("numeros",function(){return{require:"ngModel",link:function(o,e,a,t){t.$parsers.push(function(o){if(o){var e=o.replace(/[^0-9]/g,"");return e!==o&&(t.$setViewValue(e),t.$render()),e}})}}}),app.directive("removeCaracteres",function(){return{require:"ngModel",restrict:"A",link:function(o,e,a,t){t.$parsers.push(function(o){if(null==o)return"";var e=o.replace(/[^\w\s\/\d]/gi,"");return e!=o&&(t.$setViewValue(e),t.$render()),e})}}}),app.directive("mask",function(){return{restrict:"A",link:function(o,e,a){e.mask(a.mask,{reverse:!0})}}}),app.directive("validaemail",["Utils","Alertas","$timeout","$rootScope","$translate","AlertaService",function(t,o,n,e,i,r){return{restrict:"A",link:function(o,e,a){$(e).blur(function(){var o=$(this);""!=o.val()&&(t.validEmailReg(o.val())||r.showMensagemRetorno(201,i.instant("MSG_EMAIL_INVALIDO"),function(){n(function(){o.val(""),o.focus()},200)}))})}}}]),app.directive("compareemail",["Utils","Alertas","$timeout","$rootScope","$translate","AlertaService",function(t,o,n,e,i,r){return{restrict:"A",link:function(o,e,a){$(e).blur(function(){var o=$(this),e=$(a.compareemail);""!=o.val()&&""!=e.val()&&(t.validEmailReg(o.val())?o.val()!=e.val()&&r.showMensagemRetorno(201,i.instant("MSG_CAMPO_DIFERENTES"),function(){n(function(){o.val(""),o.focus()},200)}):r.showMensagemRetorno(201,i.instant("MSG_EMAIL_INVALIDO"),function(){n(function(){o.val(""),o.focus()},200)}))})}}}]),app.filter("to_trusted",["$sce",function(e){return function(o){return e.trustAsHtml(o)}}]).filter("startFrom",function(){return function(o,e){try{return e=+e,o.slice(e)}catch(o){return}}}).filter("texto",function(){return function(o){var e="--";return o&&(e=o),e}}).filter("htmlToPlaintext",function(){return function(o){return o?String(o).replace(/<[^>]+>/gm,""):""}}).filter("capitalize",function(){return function(o){return o?o.charAt(0).toUpperCase()+o.substr(1).toLowerCase():""}}).filter("valor",["Utils",function(a){return function(o){var e="0,00";return o&&(e=a.formatKuanza(o)),e}}]).filter("valorCambio",["Utils",function(o){return function(o){var e="0,000";if(o){var a=String(o).split(".");e=a[0]+","+a[1].substr(0,3)}return e}}]).filter("stringToFloat",function(){return function(o){if(o)return parseFloat(o.replace(/[.]/g,"").replace(/[,]/g,"."))}}),angular.module("dynamic-states",[]).provider("dynamicStates",["$stateProvider","$urlRouterProvider",function(a,o){o.deferIntercept();var n=function(o,e){try{a.state(o,e)}catch(o){}},s=function(o,e){var a=!!o.subPaginas,t={abstract:a,url:!!o.url&&o.url,cdMenu:o.cdMenu,dsMenu:o.dsMenu,flAtivo:o.flAtivo,displayName:o.displayName,contentId:o.contentID,flBotaoServico:o.flBotaoServico,siglaServico:o.siglaServico,state:o.state,cache:!1,urlLogoContentID:o.urlLogoContentID,ncyBreadcrumb:{label:o.displayName},subPaginas:o.subPaginas};a||(t.views={"@":{templateUrl:"app/pages/default-interna.html",controller:"defaultInternaController"}}),n(o.state,t),e&&e()};this.addRoute=n,this.addRoutes=s,this.$get=["$q","$state","$http","$urlRouter","$rootScope",function(o,n,e,a,i){var r=o.defer(),l=function(t){return angular.forEach(t,function(o,e){var a=n.get(o.state);a?(a.ncyBreadcrumb={label:o.displayName},a.cdMenu=o.cdMenu,a.dsMenu=o.dsMenu,a.displayName=o.displayName,a.contentID=o.contentID,a.nuOrdem=o.nuOrdem,a.flAtivo=o.flAtivo,a.subPaginas=o.subPaginas,a.flBotaoServico=o.flBotaoServico,a.siglaServico=o.siglaServico,a.urlLogoContentID=o.urlLogoContentID,a.state=o.state,o.subPaginas&&l(o.subPaginas)):s(o,function(){o.subPaginas&&l(o.subPaginas),e==t.length-1&&r.resolve()})}),r.promise.then(function(){i.$evalAsync(function(){a.sync(),a.listen()})}),t};return{fetchRoutes:l}}]}]);